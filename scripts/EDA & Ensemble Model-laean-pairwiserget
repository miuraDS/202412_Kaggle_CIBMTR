{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a2571e93",
   "metadata": {
    "papermill": {
     "duration": 0.013972,
     "end_time": "2025-02-25T13:33:29.408804",
     "exception": false,
     "start_time": "2025-02-25T13:33:29.394832",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Introduction</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d1b2459",
   "metadata": {
    "papermill": {
     "duration": 0.010428,
     "end_time": "2025-02-25T13:33:29.430437",
     "exception": false,
     "start_time": "2025-02-25T13:33:29.420009",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<div style=\"background-color: rgb(247, 230, 202); border: 4px solid rgb(162, 87, 79); border-radius: 40px; padding: 20px; font-family: 'Roboto'; color: rgb(162, 87, 79); text-align: left; font-size: 120%;\">\n",
    "    <ul style=\"list-style-type: square; padding-left: 20px;\">\n",
    "        <li>Missing values are replaced with:\n",
    "            <ul style=\"list-style-type: circle; margin-top: 10px; margin-bottom: 10px;\">\n",
    "                <li>-1 for numeric columns</li>\n",
    "                <li>Unknown for categorical columns</li>\n",
    "            </ul>\n",
    "        </li>\n",
    "        <li style=\"margin-top: 10px;\">\n",
    "            LightGBM and CatBoost are trained on 3 different targets, estimated from the survival models:\n",
    "            <ul style=\"list-style-type: circle; margin-top: 10px; margin-bottom: 10px;\">\n",
    "                <li>Cox</li>\n",
    "                <li>Kaplan-Meier</li>\n",
    "                <li>Nelson-Aalen</li>\n",
    "            </ul>\n",
    "        </li>\n",
    "        <li style=\"margin-top: 10px;\">Two additional CatBoost model are trained, with Cox loss function.</li>\n",
    "        <li style=\"margin-top: 10px;\">As per <a href=\"https://www.kaggle.com/competitions/equity-post-HCT-survival-predictions/discussion/553061\" style=\"color: #A2574F; text-decoration: underline;\">this</a> discussion post, the target is consisted of the Out-of-Fold predictions of the survival models on the validation folds to prevent target leakage.</li>\n",
    "        <li style=\"margin-top: 10px;\">\n",
    "            The ensemble prediction for each sample is computed as:\n",
    "            <ul style=\"list-style-type: circle; margin-top: 10px; margin-bottom: 10px;\">\n",
    "                <p style=\"margin-top: 10px; font-size: 110%; color: #A2574F; font-family: 'Roboto'; text-align: left;\">\n",
    "                    $ \\text{preds}_{\\text{ensemble}} = \\sum_{i=1}^{n} w_i \\cdot \\text{rankdata}(\\text{preds}_i) $\n",
    "                </p>\n",
    "                where $n$ is the number of models, $w_i$ is the weight assigned to the $i$-th model, and $\\text{rankdata}(\\text{preds}_i)$ is the rank of predictions from the $i$-th model.\n",
    "            </ul>\n",
    "        </li>\n",
    "        <li style=\"margin-top: 10px;\">Last but not least, since the competition metrics evaluates only the order of predictions and not their magnitude, the model weights are not required to add up to 1, nor should the predictions fall within a predefined range.</li>\n",
    "    </ul>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "80da9c87",
   "metadata": {
    "papermill": {
     "duration": 0.010329,
     "end_time": "2025-02-25T13:33:29.451548",
     "exception": false,
     "start_time": "2025-02-25T13:33:29.441219",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Install Libraries</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "fb7575d7",
   "metadata": {
    "_kg_hide-output": true,
    "execution": {
     "iopub.execute_input": "2025-02-25T13:33:29.474810Z",
     "iopub.status.busy": "2025-02-25T13:33:29.474402Z",
     "iopub.status.idle": "2025-02-25T13:37:06.524441Z",
     "shell.execute_reply": "2025-02-25T13:37:06.522872Z"
    },
    "papermill": {
     "duration": 217.065573,
     "end_time": "2025-02-25T13:37:06.527901",
     "exception": false,
     "start_time": "2025-02-25T13:33:29.462328",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Processing /kaggle/input/pip-install-lifelines/autograd-1.7.0-py3-none-any.whl\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from autograd==1.7.0) (1.26.4)\r\n",
      "Installing collected packages: autograd\r\n",
      "Successfully installed autograd-1.7.0\r\n",
      "Processing /kaggle/input/pip-install-lifelines/autograd-gamma-0.5.0.tar.gz\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l-\b \bdone\r\n",
      "\u001b[?25hRequirement already satisfied: autograd>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from autograd-gamma==0.5.0) (1.7.0)\r\n",
      "Requirement already satisfied: scipy>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from autograd-gamma==0.5.0) (1.14.1)\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from autograd>=1.2.0->autograd-gamma==0.5.0) (1.26.4)\r\n",
      "Building wheels for collected packages: autograd-gamma\r\n",
      "  Building wheel for autograd-gamma (setup.py) ... \u001b[?25l-\b \b\\\b \bdone\r\n",
      "\u001b[?25h  Created wheel for autograd-gamma: filename=autograd_gamma-0.5.0-py3-none-any.whl size=4030 sha256=a85feac1f2430422ef24f6b7afc8352fa1e3742327ba37e9012b2a46aef27de2\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/6b/b5/e0/4c79e15c0b5f2c15ecf613c720bb20daab20a666eb67135155\r\n",
      "Successfully built autograd-gamma\r\n",
      "Installing collected packages: autograd-gamma\r\n",
      "Successfully installed autograd-gamma-0.5.0\r\n",
      "Processing /kaggle/input/pip-install-lifelines/interface_meta-1.3.0-py3-none-any.whl\r\n",
      "Installing collected packages: interface-meta\r\n",
      "Successfully installed interface-meta-1.3.0\r\n",
      "Processing /kaggle/input/pip-install-lifelines/formulaic-1.0.2-py3-none-any.whl\r\n",
      "Requirement already satisfied: interface-meta>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.3.0)\r\n",
      "Requirement already satisfied: numpy>=1.16.5 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.26.4)\r\n",
      "Requirement already satisfied: pandas>=1.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (2.2.3)\r\n",
      "Requirement already satisfied: scipy>=1.6 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.14.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (4.12.2)\r\n",
      "Requirement already satisfied: wrapt>=1.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.16.0)\r\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /opt/conda/lib/python3.10/site-packages (from pandas>=1.0->formulaic==1.0.2) (2.9.0.post0)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas>=1.0->formulaic==1.0.2) (2024.1)\r\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas>=1.0->formulaic==1.0.2) (2024.1)\r\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas>=1.0->formulaic==1.0.2) (1.16.0)\r\n",
      "Installing collected packages: formulaic\r\n",
      "Successfully installed formulaic-1.0.2\r\n",
      "Processing /kaggle/input/pip-install-lifelines/lifelines-0.30.0-py3-none-any.whl\r\n",
      "Requirement already satisfied: numpy>=1.14.0 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.26.4)\r\n",
      "Requirement already satisfied: scipy>=1.7.0 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.14.1)\r\n",
      "Requirement already satisfied: pandas>=2.1 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (2.2.3)\r\n",
      "Requirement already satisfied: matplotlib>=3.0 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (3.7.5)\r\n",
      "Requirement already satisfied: autograd>=1.5 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.7.0)\r\n",
      "Requirement already satisfied: autograd-gamma>=0.3 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (0.5.0)\r\n",
      "Requirement already satisfied: formulaic>=0.2.2 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.0.2)\r\n",
      "Requirement already satisfied: interface-meta>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic>=0.2.2->lifelines==0.30.0) (1.3.0)\r\n",
      "Requirement already satisfied: typing-extensions>=4.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic>=0.2.2->lifelines==0.30.0) (4.12.2)\r\n",
      "Requirement already satisfied: wrapt>=1.0 in /opt/conda/lib/python3.10/site-packages (from formulaic>=0.2.2->lifelines==0.30.0) (1.16.0)\r\n",
      "Requirement already satisfied: contourpy>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (1.2.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (0.12.1)\r\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (4.53.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (1.4.5)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (21.3)\r\n",
      "Requirement already satisfied: pillow>=6.2.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (10.3.0)\r\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (3.1.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (2.9.0.post0)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.1->lifelines==0.30.0) (2024.1)\r\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.1->lifelines==0.30.0) (2024.1)\r\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib>=3.0->lifelines==0.30.0) (1.16.0)\r\n",
      "Installing collected packages: lifelines\r\n",
      "Successfully installed lifelines-0.30.0\r\n"
     ]
    }
   ],
   "source": [
    "!pip install /kaggle/input/pip-install-lifelines/autograd-1.7.0-py3-none-any.whl\n",
    "!pip install /kaggle/input/pip-install-lifelines/autograd-gamma-0.5.0.tar.gz\n",
    "!pip install /kaggle/input/pip-install-lifelines/interface_meta-1.3.0-py3-none-any.whl\n",
    "!pip install /kaggle/input/pip-install-lifelines/formulaic-1.0.2-py3-none-any.whl\n",
    "!pip install /kaggle/input/pip-install-lifelines/lifelines-0.30.0-py3-none-any.whl"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8c53f60e",
   "metadata": {
    "papermill": {
     "duration": 0.011979,
     "end_time": "2025-02-25T13:37:06.553141",
     "exception": false,
     "start_time": "2025-02-25T13:37:06.541162",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Imports</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ced0fa49",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:06.581100Z",
     "iopub.status.busy": "2025-02-25T13:37:06.580706Z",
     "iopub.status.idle": "2025-02-25T13:37:06.586523Z",
     "shell.execute_reply": "2025-02-25T13:37:06.585041Z"
    },
    "papermill": {
     "duration": 0.023209,
     "end_time": "2025-02-25T13:37:06.589500",
     "exception": false,
     "start_time": "2025-02-25T13:37:06.566291",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import warnings\n",
    "from pathlib import Path\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "07abb748",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:06.618399Z",
     "iopub.status.busy": "2025-02-25T13:37:06.618039Z",
     "iopub.status.idle": "2025-02-25T13:37:08.736299Z",
     "shell.execute_reply": "2025-02-25T13:37:08.735189Z"
    },
    "papermill": {
     "duration": 2.135626,
     "end_time": "2025-02-25T13:37:08.738790",
     "exception": false,
     "start_time": "2025-02-25T13:37:06.603164",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import polars as pl\n",
    "import pandas as pd\n",
    "import plotly.colors as pc\n",
    "import plotly.express as px\n",
    "import plotly.graph_objects as go"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "717b0ff3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:08.768601Z",
     "iopub.status.busy": "2025-02-25T13:37:08.767784Z",
     "iopub.status.idle": "2025-02-25T13:37:08.947331Z",
     "shell.execute_reply": "2025-02-25T13:37:08.945746Z"
    },
    "papermill": {
     "duration": 0.199095,
     "end_time": "2025-02-25T13:37:08.950909",
     "exception": false,
     "start_time": "2025-02-25T13:37:08.751814",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import plotly.io as pio\n",
    "pio.renderers.default = 'iframe'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "3ed847b7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:08.986903Z",
     "iopub.status.busy": "2025-02-25T13:37:08.986351Z",
     "iopub.status.idle": "2025-02-25T13:37:08.992652Z",
     "shell.execute_reply": "2025-02-25T13:37:08.991424Z"
    },
    "papermill": {
     "duration": 0.023479,
     "end_time": "2025-02-25T13:37:08.995174",
     "exception": false,
     "start_time": "2025-02-25T13:37:08.971695",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "pd.options.display.max_columns = None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "fc4442f2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:09.022542Z",
     "iopub.status.busy": "2025-02-25T13:37:09.022019Z",
     "iopub.status.idle": "2025-02-25T13:37:12.492750Z",
     "shell.execute_reply": "2025-02-25T13:37:12.491716Z"
    },
    "papermill": {
     "duration": 3.487586,
     "end_time": "2025-02-25T13:37:12.495137",
     "exception": false,
     "start_time": "2025-02-25T13:37:09.007551",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import lightgbm as lgb\n",
    "from metric import score\n",
    "from scipy.stats import rankdata \n",
    "from catboost import CatBoostRegressor\n",
    "from sklearn.model_selection import KFold\n",
    "from lifelines import CoxPHFitter, KaplanMeierFitter, NelsonAalenFitter"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ae6f165",
   "metadata": {
    "papermill": {
     "duration": 0.012098,
     "end_time": "2025-02-25T13:37:12.520043",
     "exception": false,
     "start_time": "2025-02-25T13:37:12.507945",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Configuration</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2891b42c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:12.547039Z",
     "iopub.status.busy": "2025-02-25T13:37:12.546389Z",
     "iopub.status.idle": "2025-02-25T13:37:12.556274Z",
     "shell.execute_reply": "2025-02-25T13:37:12.554901Z"
    },
    "papermill": {
     "duration": 0.026245,
     "end_time": "2025-02-25T13:37:12.558439",
     "exception": false,
     "start_time": "2025-02-25T13:37:12.532194",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class CFG:\n",
    "\n",
    "    train_path = Path('/kaggle/input/equity-post-HCT-survival-predictions/train.csv')\n",
    "    test_path = Path('/kaggle/input/equity-post-HCT-survival-predictions/test.csv')\n",
    "    subm_path = Path('/kaggle/input/equity-post-HCT-survival-predictions/sample_submission.csv')\n",
    "\n",
    "    color = '#A2574F'\n",
    "\n",
    "    batch_size = 32768\n",
    "    early_stop = 300\n",
    "    penalizer = 0.01\n",
    "    n_splits = 5\n",
    "\n",
    "    weights = [1.0, 1.0, 8.0, 4.0, 8.0, 4.0, 6.0, 6.0]\n",
    "\n",
    "    ctb_params = {\n",
    "        'loss_function': 'RMSE',\n",
    "        'learning_rate': 0.03,\n",
    "        'random_state': 42,\n",
    "        'task_type': 'CPU',\n",
    "        'num_trees': 6000,\n",
    "        'subsample': 0.85,\n",
    "        'reg_lambda': 8.0,\n",
    "        'depth': 8\n",
    "    }\n",
    "\n",
    "    lgb_params = {\n",
    "        'objective': 'regression',\n",
    "        'min_child_samples': 32,\n",
    "        'num_iterations': 6000,\n",
    "        'learning_rate': 0.03,\n",
    "        'extra_trees': True,\n",
    "        'reg_lambda': 8.0,\n",
    "        'reg_alpha': 0.1,\n",
    "        'num_leaves': 64,\n",
    "        'metric': 'rmse',\n",
    "        'max_depth': 8,\n",
    "        'device': 'cpu',\n",
    "        'max_bin': 128,\n",
    "        'verbose': -1,\n",
    "        'seed': 42\n",
    "    }\n",
    "\n",
    "    # Parameters of the first CatBoost model with Cox loss function\n",
    "    cox1_params = {\n",
    "        'grow_policy': 'Depthwise',\n",
    "        'min_child_samples': 8,\n",
    "        'loss_function': 'Cox',\n",
    "        'learning_rate': 0.03,\n",
    "        'random_state': 42,\n",
    "        'task_type': 'CPU',\n",
    "        'num_trees': 6000,\n",
    "        'subsample': 0.85,\n",
    "        'reg_lambda': 8.0,\n",
    "        'depth': 8\n",
    "    }\n",
    "\n",
    "    # Parameters of the second CatBoost model with Cox loss function\n",
    "    cox2_params = {\n",
    "        'grow_policy': 'Lossguide',\n",
    "        'loss_function': 'Cox',\n",
    "        'learning_rate': 0.03,\n",
    "        'random_state': 42,\n",
    "        'task_type': 'CPU',\n",
    "        'num_trees': 6000,\n",
    "        'subsample': 0.85,\n",
    "        'reg_lambda': 8.0,\n",
    "        'num_leaves': 32,\n",
    "        'depth': 8\n",
    "    }"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86bf1e6c",
   "metadata": {
    "papermill": {
     "duration": 0.012982,
     "end_time": "2025-02-25T13:37:12.584872",
     "exception": false,
     "start_time": "2025-02-25T13:37:12.571890",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Feature Engineering</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "fd3b46da",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:12.611982Z",
     "iopub.status.busy": "2025-02-25T13:37:12.611532Z",
     "iopub.status.idle": "2025-02-25T13:37:12.622371Z",
     "shell.execute_reply": "2025-02-25T13:37:12.621118Z"
    },
    "papermill": {
     "duration": 0.027461,
     "end_time": "2025-02-25T13:37:12.624795",
     "exception": false,
     "start_time": "2025-02-25T13:37:12.597334",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class FE:\n",
    "\n",
    "    def __init__(self, batch_size):\n",
    "        self.batch_size = batch_size\n",
    "\n",
    "    def load_data(self, path):\n",
    "\n",
    "        return pl.read_csv(path, batch_size=self.batch_size)\n",
    "\n",
    "    def cast_datatypes(self, df):\n",
    "\n",
    "        num_cols = [\n",
    "            'hla_high_res_8',\n",
    "            'hla_low_res_8',\n",
    "            'hla_high_res_6',\n",
    "            'hla_low_res_6',\n",
    "            'hla_high_res_10',\n",
    "            'hla_low_res_10',\n",
    "            'hla_match_dqb1_high',\n",
    "            'hla_match_dqb1_low',\n",
    "            'hla_match_drb1_high',\n",
    "            'hla_match_drb1_low',\n",
    "            'hla_nmdp_6',\n",
    "            'year_hct',\n",
    "            'hla_match_a_high',\n",
    "            'hla_match_a_low',\n",
    "            'hla_match_b_high',\n",
    "            'hla_match_b_low',\n",
    "            'hla_match_c_high',\n",
    "            'hla_match_c_low',\n",
    "            'donor_age',\n",
    "            'age_at_hct',\n",
    "            'comorbidity_score',\n",
    "            'karnofsky_score',\n",
    "            'efs',\n",
    "            'efs_time'\n",
    "        ]\n",
    "\n",
    "        for col in df.columns:\n",
    "\n",
    "            if col in num_cols:\n",
    "                df = df.with_columns(pl.col(col).fill_null(-1).cast(pl.Float32))  \n",
    "\n",
    "            else:\n",
    "                df = df.with_columns(pl.col(col).fill_null('Unknown').cast(pl.String))  \n",
    "\n",
    "        return df.with_columns(pl.col('ID').cast(pl.Int32))\n",
    "\n",
    "    def info(self, df):\n",
    "        \n",
    "        print(f'\\nShape of dataframe: {df.shape}') \n",
    "        \n",
    "        mem = df.memory_usage().sum() / 1024**2\n",
    "        print('Memory usage: {:.2f} MB\\n'.format(mem))\n",
    "\n",
    "        display(df.head())\n",
    "\n",
    "    def apply_fe(self, path):\n",
    "\n",
    "        df = self.load_data(path)\n",
    "        df = self.cast_datatypes(df)\n",
    "        df = df.to_pandas()\n",
    "\n",
    "        self.info(df)\n",
    "        \n",
    "        cat_cols = [col for col in df.columns if df[col].dtype == pl.String]\n",
    "\n",
    "        return df, cat_cols"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b0de8b0d",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:12.651385Z",
     "iopub.status.busy": "2025-02-25T13:37:12.650984Z",
     "iopub.status.idle": "2025-02-25T13:37:12.655917Z",
     "shell.execute_reply": "2025-02-25T13:37:12.654859Z"
    },
    "papermill": {
     "duration": 0.020865,
     "end_time": "2025-02-25T13:37:12.657999",
     "exception": false,
     "start_time": "2025-02-25T13:37:12.637134",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "fe = FE(CFG.batch_size)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "1ba5d59e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:12.684352Z",
     "iopub.status.busy": "2025-02-25T13:37:12.683986Z",
     "iopub.status.idle": "2025-02-25T13:37:13.377391Z",
     "shell.execute_reply": "2025-02-25T13:37:13.376299Z"
    },
    "papermill": {
     "duration": 0.709045,
     "end_time": "2025-02-25T13:37:13.379512",
     "exception": false,
     "start_time": "2025-02-25T13:37:12.670467",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Shape of dataframe: (28800, 60)\n",
      "Memory usage: 10.44 MB\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>dri_score</th>\n",
       "      <th>psych_disturb</th>\n",
       "      <th>cyto_score</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>hla_match_c_high</th>\n",
       "      <th>hla_high_res_8</th>\n",
       "      <th>tbi_status</th>\n",
       "      <th>arrhythmia</th>\n",
       "      <th>hla_low_res_6</th>\n",
       "      <th>graft_type</th>\n",
       "      <th>vent_hist</th>\n",
       "      <th>renal_issue</th>\n",
       "      <th>pulm_severe</th>\n",
       "      <th>prim_disease_hct</th>\n",
       "      <th>hla_high_res_6</th>\n",
       "      <th>cmv_status</th>\n",
       "      <th>hla_high_res_10</th>\n",
       "      <th>hla_match_dqb1_high</th>\n",
       "      <th>tce_imm_match</th>\n",
       "      <th>hla_nmdp_6</th>\n",
       "      <th>hla_match_c_low</th>\n",
       "      <th>rituximab</th>\n",
       "      <th>hla_match_drb1_low</th>\n",
       "      <th>hla_match_dqb1_low</th>\n",
       "      <th>prod_type</th>\n",
       "      <th>cyto_score_detail</th>\n",
       "      <th>conditioning_intensity</th>\n",
       "      <th>ethnicity</th>\n",
       "      <th>year_hct</th>\n",
       "      <th>obesity</th>\n",
       "      <th>mrd_hct</th>\n",
       "      <th>in_vivo_tcd</th>\n",
       "      <th>tce_match</th>\n",
       "      <th>hla_match_a_high</th>\n",
       "      <th>hepatic_severe</th>\n",
       "      <th>donor_age</th>\n",
       "      <th>prior_tumor</th>\n",
       "      <th>hla_match_b_low</th>\n",
       "      <th>peptic_ulcer</th>\n",
       "      <th>age_at_hct</th>\n",
       "      <th>hla_match_a_low</th>\n",
       "      <th>gvhd_proph</th>\n",
       "      <th>rheum_issue</th>\n",
       "      <th>sex_match</th>\n",
       "      <th>hla_match_b_high</th>\n",
       "      <th>race_group</th>\n",
       "      <th>comorbidity_score</th>\n",
       "      <th>karnofsky_score</th>\n",
       "      <th>hepatic_mild</th>\n",
       "      <th>tce_div_match</th>\n",
       "      <th>donor_related</th>\n",
       "      <th>melphalan_dose</th>\n",
       "      <th>hla_low_res_8</th>\n",
       "      <th>cardiac</th>\n",
       "      <th>hla_match_drb1_high</th>\n",
       "      <th>pulm_moderate</th>\n",
       "      <th>hla_low_res_10</th>\n",
       "      <th>efs</th>\n",
       "      <th>efs_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>IEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2016.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>9.942000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FKalone</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>42.355999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>TBI +- Other, &gt;cGy</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>AML</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2008.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>72.290001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.705002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Other GVHD Prophylaxis</td>\n",
       "      <td>No</td>\n",
       "      <td>F-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Asian</td>\n",
       "      <td>3.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.672000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>HIS</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2019.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>33.997002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Cyclophosphamide alone</td>\n",
       "      <td>No</td>\n",
       "      <td>F-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19.792999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>ALL</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2009.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.230000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.244999</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FK+ MMF +- others</td>\n",
       "      <td>No</td>\n",
       "      <td>M-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>White</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>102.348999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>MPN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Hispanic or Latino</td>\n",
       "      <td>2018.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>56.810001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.740000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>TDEPLETION +- other</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>American Indian or Alaska Native</td>\n",
       "      <td>1.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>MEL</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.223000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   ID                       dri_score psych_disturb    cyto_score diabetes  \\\n",
       "0   0  N/A - non-malignant indication            No       Unknown       No   \n",
       "1   1                    Intermediate            No  Intermediate       No   \n",
       "2   2  N/A - non-malignant indication            No       Unknown       No   \n",
       "3   3                            High            No  Intermediate       No   \n",
       "4   4                            High            No       Unknown       No   \n",
       "\n",
       "   hla_match_c_high  hla_high_res_8          tbi_status arrhythmia  \\\n",
       "0              -1.0            -1.0              No TBI         No   \n",
       "1               2.0             8.0  TBI +- Other, >cGy         No   \n",
       "2               2.0             8.0              No TBI         No   \n",
       "3               2.0             8.0              No TBI         No   \n",
       "4               2.0             8.0              No TBI         No   \n",
       "\n",
       "   hla_low_res_6        graft_type vent_hist renal_issue pulm_severe  \\\n",
       "0            6.0       Bone marrow        No          No          No   \n",
       "1            6.0  Peripheral blood        No          No          No   \n",
       "2            6.0       Bone marrow        No          No          No   \n",
       "3            6.0       Bone marrow        No          No          No   \n",
       "4            6.0  Peripheral blood        No          No          No   \n",
       "\n",
       "  prim_disease_hct  hla_high_res_6 cmv_status  hla_high_res_10  \\\n",
       "0              IEA             6.0        +/+             -1.0   \n",
       "1              AML             6.0        +/+             10.0   \n",
       "2              HIS             6.0        +/+             10.0   \n",
       "3              ALL             6.0        +/+             10.0   \n",
       "4              MPN             6.0        +/+             10.0   \n",
       "\n",
       "   hla_match_dqb1_high tce_imm_match  hla_nmdp_6  hla_match_c_low rituximab  \\\n",
       "0                  2.0       Unknown         6.0              2.0        No   \n",
       "1                  2.0           P/P         6.0              2.0        No   \n",
       "2                  2.0           P/P         6.0              2.0        No   \n",
       "3                  2.0           P/P         6.0              2.0        No   \n",
       "4                  2.0       Unknown         5.0              2.0        No   \n",
       "\n",
       "   hla_match_drb1_low  hla_match_dqb1_low prod_type cyto_score_detail  \\\n",
       "0                 2.0                 2.0        BM           Unknown   \n",
       "1                 2.0                 2.0        PB      Intermediate   \n",
       "2                 2.0                 2.0        BM           Unknown   \n",
       "3                 2.0                 2.0        BM      Intermediate   \n",
       "4                 2.0                 2.0        PB           Unknown   \n",
       "\n",
       "  conditioning_intensity               ethnicity  year_hct obesity   mrd_hct  \\\n",
       "0                Unknown  Not Hispanic or Latino    2016.0      No   Unknown   \n",
       "1                    MAC  Not Hispanic or Latino    2008.0      No  Positive   \n",
       "2                Unknown  Not Hispanic or Latino    2019.0      No   Unknown   \n",
       "3                    MAC  Not Hispanic or Latino    2009.0      No  Positive   \n",
       "4                    MAC      Hispanic or Latino    2018.0      No   Unknown   \n",
       "\n",
       "  in_vivo_tcd   tce_match  hla_match_a_high hepatic_severe  donor_age  \\\n",
       "0         Yes     Unknown               2.0             No  -1.000000   \n",
       "1          No  Permissive               2.0             No  72.290001   \n",
       "2         Yes     Unknown               2.0             No  -1.000000   \n",
       "3          No  Permissive               2.0             No  29.230000   \n",
       "4         Yes     Unknown               2.0             No  56.810001   \n",
       "\n",
       "  prior_tumor  hla_match_b_low peptic_ulcer  age_at_hct  hla_match_a_low  \\\n",
       "0          No              2.0           No    9.942000              2.0   \n",
       "1          No              2.0           No   43.705002              2.0   \n",
       "2          No              2.0           No   33.997002              2.0   \n",
       "3          No              2.0           No   43.244999              2.0   \n",
       "4          No              2.0           No   29.740000              2.0   \n",
       "\n",
       "               gvhd_proph rheum_issue sex_match  hla_match_b_high  \\\n",
       "0                 FKalone          No       M-F               2.0   \n",
       "1  Other GVHD Prophylaxis          No       F-F               2.0   \n",
       "2  Cyclophosphamide alone          No       F-M               2.0   \n",
       "3       FK+ MMF +- others          No       M-M               2.0   \n",
       "4     TDEPLETION +- other          No       M-F               2.0   \n",
       "\n",
       "                         race_group  comorbidity_score  karnofsky_score  \\\n",
       "0                More than one race                0.0             90.0   \n",
       "1                             Asian                3.0             90.0   \n",
       "2                More than one race                0.0             90.0   \n",
       "3                             White                0.0             90.0   \n",
       "4  American Indian or Alaska Native                1.0             90.0   \n",
       "\n",
       "  hepatic_mild          tce_div_match donor_related      melphalan_dose  \\\n",
       "0           No                Unknown     Unrelated  N/A, Mel not given   \n",
       "1           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "2           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "3          Yes  Permissive mismatched     Unrelated  N/A, Mel not given   \n",
       "4           No  Permissive mismatched       Related                 MEL   \n",
       "\n",
       "   hla_low_res_8 cardiac  hla_match_drb1_high pulm_moderate  hla_low_res_10  \\\n",
       "0            8.0      No                  2.0            No            10.0   \n",
       "1            8.0      No                  2.0           Yes            10.0   \n",
       "2            8.0      No                  2.0            No            10.0   \n",
       "3            8.0      No                  2.0            No            10.0   \n",
       "4            8.0      No                  2.0            No            10.0   \n",
       "\n",
       "   efs    efs_time  \n",
       "0  0.0   42.355999  \n",
       "1  1.0    4.672000  \n",
       "2  0.0   19.792999  \n",
       "3  0.0  102.348999  \n",
       "4  0.0   16.223000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train_data, cat_cols = fe.apply_fe(CFG.train_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d3bef8dc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:13.407270Z",
     "iopub.status.busy": "2025-02-25T13:37:13.406903Z",
     "iopub.status.idle": "2025-02-25T13:37:13.472061Z",
     "shell.execute_reply": "2025-02-25T13:37:13.471027Z"
    },
    "papermill": {
     "duration": 0.081607,
     "end_time": "2025-02-25T13:37:13.474186",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.392579",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Shape of dataframe: (3, 58)\n",
      "Memory usage: 0.00 MB\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>dri_score</th>\n",
       "      <th>psych_disturb</th>\n",
       "      <th>cyto_score</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>hla_match_c_high</th>\n",
       "      <th>hla_high_res_8</th>\n",
       "      <th>tbi_status</th>\n",
       "      <th>arrhythmia</th>\n",
       "      <th>hla_low_res_6</th>\n",
       "      <th>graft_type</th>\n",
       "      <th>vent_hist</th>\n",
       "      <th>renal_issue</th>\n",
       "      <th>pulm_severe</th>\n",
       "      <th>prim_disease_hct</th>\n",
       "      <th>hla_high_res_6</th>\n",
       "      <th>cmv_status</th>\n",
       "      <th>hla_high_res_10</th>\n",
       "      <th>hla_match_dqb1_high</th>\n",
       "      <th>tce_imm_match</th>\n",
       "      <th>hla_nmdp_6</th>\n",
       "      <th>hla_match_c_low</th>\n",
       "      <th>rituximab</th>\n",
       "      <th>hla_match_drb1_low</th>\n",
       "      <th>hla_match_dqb1_low</th>\n",
       "      <th>prod_type</th>\n",
       "      <th>cyto_score_detail</th>\n",
       "      <th>conditioning_intensity</th>\n",
       "      <th>ethnicity</th>\n",
       "      <th>year_hct</th>\n",
       "      <th>obesity</th>\n",
       "      <th>mrd_hct</th>\n",
       "      <th>in_vivo_tcd</th>\n",
       "      <th>tce_match</th>\n",
       "      <th>hla_match_a_high</th>\n",
       "      <th>hepatic_severe</th>\n",
       "      <th>donor_age</th>\n",
       "      <th>prior_tumor</th>\n",
       "      <th>hla_match_b_low</th>\n",
       "      <th>peptic_ulcer</th>\n",
       "      <th>age_at_hct</th>\n",
       "      <th>hla_match_a_low</th>\n",
       "      <th>gvhd_proph</th>\n",
       "      <th>rheum_issue</th>\n",
       "      <th>sex_match</th>\n",
       "      <th>hla_match_b_high</th>\n",
       "      <th>race_group</th>\n",
       "      <th>comorbidity_score</th>\n",
       "      <th>karnofsky_score</th>\n",
       "      <th>hepatic_mild</th>\n",
       "      <th>tce_div_match</th>\n",
       "      <th>donor_related</th>\n",
       "      <th>melphalan_dose</th>\n",
       "      <th>hla_low_res_8</th>\n",
       "      <th>cardiac</th>\n",
       "      <th>hla_match_drb1_high</th>\n",
       "      <th>pulm_moderate</th>\n",
       "      <th>hla_low_res_10</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>28800</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>IEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2016.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>9.942000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FKalone</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>28801</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>TBI +- Other, &gt;cGy</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>AML</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2008.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>72.290001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.705002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Other GVHD Prophylaxis</td>\n",
       "      <td>No</td>\n",
       "      <td>F-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Asian</td>\n",
       "      <td>3.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28802</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>HIS</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2019.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>33.997002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Cyclophosphamide alone</td>\n",
       "      <td>No</td>\n",
       "      <td>F-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      ID                       dri_score psych_disturb    cyto_score diabetes  \\\n",
       "0  28800  N/A - non-malignant indication            No       Unknown       No   \n",
       "1  28801                    Intermediate            No  Intermediate       No   \n",
       "2  28802  N/A - non-malignant indication            No       Unknown       No   \n",
       "\n",
       "   hla_match_c_high  hla_high_res_8          tbi_status arrhythmia  \\\n",
       "0              -1.0            -1.0              No TBI         No   \n",
       "1               2.0             8.0  TBI +- Other, >cGy         No   \n",
       "2               2.0             8.0              No TBI         No   \n",
       "\n",
       "   hla_low_res_6        graft_type vent_hist renal_issue pulm_severe  \\\n",
       "0            6.0       Bone marrow        No          No          No   \n",
       "1            6.0  Peripheral blood        No          No          No   \n",
       "2            6.0       Bone marrow        No          No          No   \n",
       "\n",
       "  prim_disease_hct  hla_high_res_6 cmv_status  hla_high_res_10  \\\n",
       "0              IEA             6.0        +/+             -1.0   \n",
       "1              AML             6.0        +/+             10.0   \n",
       "2              HIS             6.0        +/+             10.0   \n",
       "\n",
       "   hla_match_dqb1_high tce_imm_match  hla_nmdp_6  hla_match_c_low rituximab  \\\n",
       "0                  2.0       Unknown         6.0              2.0        No   \n",
       "1                  2.0           P/P         6.0              2.0        No   \n",
       "2                  2.0           P/P         6.0              2.0        No   \n",
       "\n",
       "   hla_match_drb1_low  hla_match_dqb1_low prod_type cyto_score_detail  \\\n",
       "0                 2.0                 2.0        BM           Unknown   \n",
       "1                 2.0                 2.0        PB      Intermediate   \n",
       "2                 2.0                 2.0        BM           Unknown   \n",
       "\n",
       "  conditioning_intensity               ethnicity  year_hct obesity   mrd_hct  \\\n",
       "0                Unknown  Not Hispanic or Latino    2016.0      No   Unknown   \n",
       "1                    MAC  Not Hispanic or Latino    2008.0      No  Positive   \n",
       "2                Unknown  Not Hispanic or Latino    2019.0      No   Unknown   \n",
       "\n",
       "  in_vivo_tcd   tce_match  hla_match_a_high hepatic_severe  donor_age  \\\n",
       "0         Yes     Unknown               2.0             No  -1.000000   \n",
       "1          No  Permissive               2.0             No  72.290001   \n",
       "2         Yes     Unknown               2.0             No  -1.000000   \n",
       "\n",
       "  prior_tumor  hla_match_b_low peptic_ulcer  age_at_hct  hla_match_a_low  \\\n",
       "0          No              2.0           No    9.942000              2.0   \n",
       "1          No              2.0           No   43.705002              2.0   \n",
       "2          No              2.0           No   33.997002              2.0   \n",
       "\n",
       "               gvhd_proph rheum_issue sex_match  hla_match_b_high  \\\n",
       "0                 FKalone          No       M-F               2.0   \n",
       "1  Other GVHD Prophylaxis          No       F-F               2.0   \n",
       "2  Cyclophosphamide alone          No       F-M               2.0   \n",
       "\n",
       "           race_group  comorbidity_score  karnofsky_score hepatic_mild  \\\n",
       "0  More than one race                0.0             90.0           No   \n",
       "1               Asian                3.0             90.0           No   \n",
       "2  More than one race                0.0             90.0           No   \n",
       "\n",
       "           tce_div_match donor_related      melphalan_dose  hla_low_res_8  \\\n",
       "0                Unknown     Unrelated  N/A, Mel not given            8.0   \n",
       "1  Permissive mismatched       Related  N/A, Mel not given            8.0   \n",
       "2  Permissive mismatched       Related  N/A, Mel not given            8.0   \n",
       "\n",
       "  cardiac  hla_match_drb1_high pulm_moderate  hla_low_res_10  \n",
       "0      No                  2.0            No            10.0  \n",
       "1      No                  2.0           Yes            10.0  \n",
       "2      No                  2.0            No            10.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "test_data, _ = fe.apply_fe(CFG.test_path)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "57207e9b",
   "metadata": {
    "papermill": {
     "duration": 0.013179,
     "end_time": "2025-02-25T13:37:13.500940",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.487761",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Model Development</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8d9ffba4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:13.529757Z",
     "iopub.status.busy": "2025-02-25T13:37:13.529358Z",
     "iopub.status.idle": "2025-02-25T13:37:13.542995Z",
     "shell.execute_reply": "2025-02-25T13:37:13.541838Z"
    },
    "papermill": {
     "duration": 0.030841,
     "end_time": "2025-02-25T13:37:13.545240",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.514399",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class EDA:\n",
    "    \n",
    "    def __init__(self, color, data):\n",
    "        self._color = color  \n",
    "        self.data = data\n",
    "\n",
    "    def _template(self, fig, title):\n",
    "        \n",
    "        fig.update_layout(\n",
    "            title=title,\n",
    "            title_x=0.5, \n",
    "            plot_bgcolor='rgba(247, 230, 202, 1)',  \n",
    "            paper_bgcolor='rgba(247, 230, 202, 1)', \n",
    "            font=dict(color=self._color),\n",
    "            margin=dict(l=72, r=72, t=72, b=72), \n",
    "            height=720\n",
    "        )\n",
    "        \n",
    "        return fig\n",
    "\n",
    "    def distribution_plot(self, col, title):\n",
    "        \n",
    "        fig = px.histogram(\n",
    "            self.data,\n",
    "            x=col,\n",
    "            nbins=100,\n",
    "            color_discrete_sequence=[self._color]\n",
    "        )\n",
    "        \n",
    "        fig.update_layout(\n",
    "            xaxis_title='Values',\n",
    "            yaxis_title='Count',\n",
    "            bargap=0.1,\n",
    "            xaxis=dict(gridcolor='grey'),\n",
    "            yaxis=dict(gridcolor='grey', zerolinecolor='grey')\n",
    "        )\n",
    "        \n",
    "        fig.update_traces(hovertemplate='Value: %{x:.2f}<br>Count: %{y:,}')\n",
    "        \n",
    "        fig = self._template(fig, f'{title}')\n",
    "        fig.show()\n",
    "        \n",
    "    def _plot_cv(self, scores, title, metric='C-Index'):\n",
    "        \n",
    "        fold_scores = [round(score, 3) for score in scores]\n",
    "        mean_score = round(np.mean(scores), 3)\n",
    "\n",
    "        fig = go.Figure()\n",
    "\n",
    "        fig.add_trace(go.Scatter(\n",
    "            x = list(range(1, len(fold_scores) + 1)),\n",
    "            y = fold_scores,\n",
    "            mode = 'markers', \n",
    "            name = 'Fold Scores',\n",
    "            marker = dict(size = 27, color=self._color, symbol='diamond'),\n",
    "            text = [f'{score:.3f}' for score in fold_scores],\n",
    "            hovertemplate = 'Fold %{x}: %{text}<extra></extra>',\n",
    "            hoverlabel = dict(font=dict(size=18))  \n",
    "        ))\n",
    "\n",
    "        fig.add_trace(go.Scatter(\n",
    "            x = [1, len(fold_scores)],\n",
    "            y = [mean_score, mean_score],\n",
    "            mode = 'lines',\n",
    "            name = f'Mean: {mean_score:.3f}',\n",
    "            line = dict(dash = 'dash', color = '#B22222'),\n",
    "            hoverinfo = 'none'\n",
    "        ))\n",
    "        \n",
    "        fig.update_layout(\n",
    "            title = f'{title} | Cross-validation Mean {metric} Score: {mean_score}',\n",
    "            xaxis_title = 'Fold',\n",
    "            yaxis_title = f'{metric} Score',\n",
    "            plot_bgcolor = 'rgba(247, 230, 202, 1)',  \n",
    "            paper_bgcolor = 'rgba(247, 230, 202, 1)',\n",
    "            font = dict(color=self._color), \n",
    "            xaxis = dict(\n",
    "                gridcolor = 'grey',\n",
    "                tickmode = 'linear',\n",
    "                tick0 = 1,\n",
    "                dtick = 1,\n",
    "                range = [0.5, len(fold_scores) + 0.5],\n",
    "                zerolinecolor = 'grey'\n",
    "            ),\n",
    "            yaxis = dict(\n",
    "                gridcolor = 'grey',\n",
    "                zerolinecolor = 'grey'\n",
    "            )\n",
    "        )\n",
    "        \n",
    "        fig.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "6500c244",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:13.575425Z",
     "iopub.status.busy": "2025-02-25T13:37:13.575032Z",
     "iopub.status.idle": "2025-02-25T13:37:13.595214Z",
     "shell.execute_reply": "2025-02-25T13:37:13.594224Z"
    },
    "papermill": {
     "duration": 0.038645,
     "end_time": "2025-02-25T13:37:13.597508",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.558863",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Targets:\n",
    "\n",
    "    def __init__(self, data, cat_cols, penalizer, n_splits):\n",
    "        \n",
    "        self.data = data\n",
    "        self.cat_cols = cat_cols\n",
    "        \n",
    "        self._length = len(self.data)\n",
    "        self._penalizer = penalizer\n",
    "        self._n_splits = n_splits\n",
    "\n",
    "    def _prepare_cv(self):\n",
    "        \n",
    "        oof_preds = np.zeros(self._length)\n",
    "            \n",
    "        # cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=42)\n",
    "        cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=2025)\n",
    "\n",
    "        return cv, oof_preds\n",
    "\n",
    "    def validate_model(self, preds, title):\n",
    "\n",
    "        y_true = self.data[['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "        y_pred = self.data[['ID']].copy()\n",
    "\n",
    "        y_pred['prediction'] = preds\n",
    "\n",
    "        c_index_score = score(y_true.copy(), y_pred.copy(), 'ID')\n",
    "        print(f'Overall Stratified C-Index Score for {title}: {c_index_score:.4f}')\n",
    "\n",
    "        return c_index_score\n",
    "\n",
    "    def create_target1(self):  \n",
    "\n",
    "        '''\n",
    "        Inside the CV loop, constant columns are dropped if they exist in a fold. Otherwise, the code produces error:\n",
    "\n",
    "        delta contains nan value(s). Convergence halted. Please see the following tips in the lifelines documentation: \n",
    "        https://lifelines.readthedocs.io/en/latest/Examples.html#problems-with-convergence-in-the-cox-proportional-hazard-model\n",
    "        '''\n",
    "\n",
    "        cv, oof_preds = self._prepare_cv()\n",
    "\n",
    "        # Apply one hot encoding to categorical columns\n",
    "        data = pd.get_dummies(self.data, columns=self.cat_cols, drop_first=True).drop('ID', axis=1) \n",
    "\n",
    "        for train_index, valid_index in cv.split(data):\n",
    "\n",
    "            train_data = data.iloc[train_index]\n",
    "            valid_data = data.iloc[valid_index]\n",
    "\n",
    "            # Drop constant columns if they exist\n",
    "            train_data = train_data.loc[:, train_data.nunique() > 1]\n",
    "            valid_data = valid_data[train_data.columns]\n",
    "\n",
    "            cph = CoxPHFitter(penalizer=self._penalizer)\n",
    "            cph.fit(train_data, duration_col='efs_time', event_col='efs')\n",
    "            \n",
    "            oof_preds[valid_index] = cph.predict_partial_hazard(valid_data)              \n",
    "\n",
    "        self.data['target1'] = oof_preds  \n",
    "        self.validate_model(oof_preds, 'Cox')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target2(self):        \n",
    "\n",
    "        cv, oof_preds = self._prepare_cv()\n",
    "\n",
    "        for train_index, valid_index in cv.split(self.data):\n",
    "\n",
    "            train_data = self.data.iloc[train_index]\n",
    "            valid_data = self.data.iloc[valid_index]\n",
    "\n",
    "            kmf = KaplanMeierFitter()\n",
    "            kmf.fit(durations=train_data['efs_time'], event_observed=train_data['efs'])\n",
    "            \n",
    "            oof_preds[valid_index] = kmf.survival_function_at_times(valid_data['efs_time']).values\n",
    "\n",
    "        self.data['target2'] = oof_preds\n",
    "        self.validate_model(oof_preds, 'Kaplan-Meier')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target3(self):        \n",
    "\n",
    "        cv, oof_preds = self._prepare_cv()\n",
    "\n",
    "        for train_index, valid_index in cv.split(self.data):\n",
    "\n",
    "            train_data = self.data.iloc[train_index]\n",
    "            valid_data = self.data.iloc[valid_index]\n",
    "            \n",
    "            naf = NelsonAalenFitter()\n",
    "            naf.fit(durations=train_data['efs_time'], event_observed=train_data['efs'])\n",
    "            \n",
    "            oof_preds[valid_index] = -naf.cumulative_hazard_at_times(valid_data['efs_time']).values\n",
    "\n",
    "        self.data['target3'] = oof_preds\n",
    "        self.validate_model(oof_preds, 'Nelson-Aalen')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target4(self):\n",
    "\n",
    "        self.data['target4'] = self.data.efs_time.copy()\n",
    "        self.data.loc[self.data.efs == 0, 'target4'] *= -1\n",
    "\n",
    "        self.validate_model(self.data['target4'], 'Nelson-Aalen')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target5(self):\n",
    "\n",
    "        self.data['target5'] = -self.data.efs_time.copy()\n",
    "\n",
    "        self.validate_model(self.data['target5'], 'efs_time')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target6(self):\n",
    "\n",
    "        # id\n",
    "        win_counts = {idx: 0 for idx in self.data.index}\n",
    "        \n",
    "        # \n",
    "        for i in range(len(self.data)):\n",
    "            for j in range(i + 1, len(self.data)):  # j > i \n",
    "                efs_i, efs_j = self.data.loc[i, \"efs\"], self.data.loc[j, \"efs\"]\n",
    "                time_i, time_j = self.data.loc[i, \"efs_time\"], self.data.loc[j, \"efs_time\"]\n",
    "        \n",
    "                if efs_i == 1 and efs_j == 1:  # (1,1) \n",
    "                    if time_i > time_j:\n",
    "                        win_counts[i] += 1\n",
    "                    else:\n",
    "                        win_counts[j] += 1\n",
    "        \n",
    "                elif efs_i == 1 and efs_j == 0:  # (1,0) efs=0  j \n",
    "                    if time_j > time_i:\n",
    "                        win_counts[j] += 1\n",
    "        \n",
    "                elif efs_i == 0 and efs_j == 1:  # (0,1) efs=0  i \n",
    "                    if time_i > time_j:\n",
    "                        win_counts[i] += 1\n",
    "        \n",
    "        # \n",
    "        self.data[\"target6\"] = -self.data.index.map(win_counts)\n",
    "        self.validate_model(self.data[\"target6\"], 'pair_wise')\n",
    "\n",
    "        return self.data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "25f1b589",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:13.628076Z",
     "iopub.status.busy": "2025-02-25T13:37:13.627433Z",
     "iopub.status.idle": "2025-02-25T13:37:13.644467Z",
     "shell.execute_reply": "2025-02-25T13:37:13.643198Z"
    },
    "papermill": {
     "duration": 0.035628,
     "end_time": "2025-02-25T13:37:13.647009",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.611381",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class MD:\n",
    "    \n",
    "    def __init__(self, color, data, cat_cols, penalizer, n_splits, early_stop):\n",
    "        \n",
    "        self.eda = EDA(color, data)\n",
    "        self.targets = Targets(data, cat_cols, penalizer, n_splits)\n",
    "        \n",
    "        self.data = data\n",
    "        self.cat_cols = cat_cols\n",
    "        self._n_splits = n_splits\n",
    "        self._early_stop = early_stop\n",
    "\n",
    "    def create_targets(self):\n",
    "\n",
    "        self.data = self.targets.create_target1()\n",
    "        self.data = self.targets.create_target2()\n",
    "        self.data = self.targets.create_target3()\n",
    "        self.data = self.targets.create_target4()\n",
    "        self.data = self.targets.create_target5()\n",
    "        self.data = self.targets.create_target6()\n",
    "\n",
    "        return self.data\n",
    "        \n",
    "    def train_model(self, params, target, title):\n",
    "        \n",
    "        for col in self.cat_cols:\n",
    "            self.data[col] = self.data[col].astype('category')\n",
    "            \n",
    "        X = self.data.drop(['ID', 'efs', 'efs_time', 'target1', 'target2', 'target3', 'target4', 'target5', 'target6'], axis=1)\n",
    "        y = self.data[target]\n",
    "        \n",
    "        models, fold_scores = [], []\n",
    "            \n",
    "        cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=42)\n",
    "        # cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=2025)\n",
    "                \n",
    "        oof_preds = np.zeros(len(X))\n",
    "    \n",
    "        for fold, (train_index, valid_index) in enumerate(cv.split(X, y)):\n",
    "                \n",
    "            X_train = X.iloc[train_index]\n",
    "            X_valid = X.iloc[valid_index]\n",
    "                \n",
    "            y_train = y.iloc[train_index]\n",
    "            y_valid = y.iloc[valid_index]\n",
    "    \n",
    "            if title.startswith('LightGBM'):\n",
    "                        \n",
    "                model = lgb.LGBMRegressor(**params)\n",
    "                        \n",
    "                model.fit(\n",
    "                    X_train, \n",
    "                    y_train,  \n",
    "                    eval_set=[(X_valid, y_valid)],\n",
    "                    eval_metric='rmse',\n",
    "                    callbacks=[lgb.early_stopping(self._early_stop, verbose=0), lgb.log_evaluation(0)]\n",
    "                )\n",
    "                        \n",
    "            elif title.startswith('CatBoost'):\n",
    "                        \n",
    "                model = CatBoostRegressor(**params, verbose=0, cat_features=self.cat_cols)\n",
    "                        \n",
    "                model.fit(\n",
    "                    X_train,\n",
    "                    y_train,\n",
    "                    eval_set=(X_valid, y_valid),\n",
    "                    early_stopping_rounds=self._early_stop, \n",
    "                    verbose=0\n",
    "                )               \n",
    "                    \n",
    "            models.append(model)\n",
    "                \n",
    "            oof_preds[valid_index] = model.predict(X_valid)\n",
    "\n",
    "            y_true_fold = self.data.iloc[valid_index][['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "            y_pred_fold = self.data.iloc[valid_index][['ID']].copy()\n",
    "            \n",
    "            y_pred_fold['prediction'] = oof_preds[valid_index]\n",
    "    \n",
    "            fold_score = score(y_true_fold, y_pred_fold, 'ID')\n",
    "            fold_scores.append(fold_score)\n",
    "    \n",
    "        self.eda._plot_cv(fold_scores, title)\n",
    "            \n",
    "        y_true = self.data[['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "        y_pred = self.data[['ID']].copy()\n",
    "        \n",
    "        y_pred['prediction'] = oof_preds\n",
    "            \n",
    "        c_index_score = score(y_true.copy(), y_pred.copy(), 'ID')\n",
    "        print(f'\\nOverall C-Index for {title}: {c_index_score:.3f}\\n')\n",
    "        \n",
    "        return models, oof_preds\n",
    "\n",
    "    def infer_model(self, data, models):\n",
    "        \n",
    "        data = data.drop(['ID'], axis=1)\n",
    "\n",
    "        for col in self.cat_cols:\n",
    "            data[col] = data[col].astype('category')\n",
    "\n",
    "        return np.mean([model.predict(data) for model in models], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3934c2c2",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:13.675605Z",
     "iopub.status.busy": "2025-02-25T13:37:13.675244Z",
     "iopub.status.idle": "2025-02-25T13:37:13.680320Z",
     "shell.execute_reply": "2025-02-25T13:37:13.679315Z"
    },
    "papermill": {
     "duration": 0.021662,
     "end_time": "2025-02-25T13:37:13.682338",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.660676",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "md = MD(CFG.color, train_data, cat_cols, CFG.penalizer, CFG.n_splits, CFG.early_stop)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "2d18f8f3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T13:37:13.711057Z",
     "iopub.status.busy": "2025-02-25T13:37:13.710694Z",
     "iopub.status.idle": "2025-02-25T18:31:54.586525Z",
     "shell.execute_reply": "2025-02-25T18:31:54.585429Z"
    },
    "papermill": {
     "duration": 17680.907626,
     "end_time": "2025-02-25T18:31:54.603407",
     "exception": false,
     "start_time": "2025-02-25T13:37:13.695781",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Cox: 0.6563\n",
      "Overall Stratified C-Index Score for Kaplan-Meier: 0.9987\n",
      "Overall Stratified C-Index Score for Nelson-Aalen: 0.9987\n",
      "Overall Stratified C-Index Score for Nelson-Aalen: 0.5819\n",
      "Overall Stratified C-Index Score for efs_time: 1.0000\n",
      "Overall Stratified C-Index Score for pair_wise: 1.0000\n"
     ]
    }
   ],
   "source": [
    "train_data = md.create_targets()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f960d2f1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:54.632652Z",
     "iopub.status.busy": "2025-02-25T18:31:54.632280Z",
     "iopub.status.idle": "2025-02-25T18:31:56.771940Z",
     "shell.execute_reply": "2025-02-25T18:31:56.770821Z"
    },
    "papermill": {
     "duration": 2.157024,
     "end_time": "2025-02-25T18:31:56.774137",
     "exception": false,
     "start_time": "2025-02-25T18:31:54.617113",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_17.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target1', 'Cox Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "8c40c491",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:56.803189Z",
     "iopub.status.busy": "2025-02-25T18:31:56.802769Z",
     "iopub.status.idle": "2025-02-25T18:31:56.880207Z",
     "shell.execute_reply": "2025-02-25T18:31:56.879213Z"
    },
    "papermill": {
     "duration": 0.094451,
     "end_time": "2025-02-25T18:31:56.882378",
     "exception": false,
     "start_time": "2025-02-25T18:31:56.787927",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_18.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target2', 'Kaplan-Meier Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "aa0f6ca4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:56.912848Z",
     "iopub.status.busy": "2025-02-25T18:31:56.912453Z",
     "iopub.status.idle": "2025-02-25T18:31:56.991510Z",
     "shell.execute_reply": "2025-02-25T18:31:56.990546Z"
    },
    "papermill": {
     "duration": 0.097008,
     "end_time": "2025-02-25T18:31:56.993710",
     "exception": false,
     "start_time": "2025-02-25T18:31:56.896702",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_19.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target3', 'Nelson-Aalen Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "4ca78f6e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:57.023591Z",
     "iopub.status.busy": "2025-02-25T18:31:57.023201Z",
     "iopub.status.idle": "2025-02-25T18:31:57.099388Z",
     "shell.execute_reply": "2025-02-25T18:31:57.098344Z"
    },
    "papermill": {
     "duration": 0.094146,
     "end_time": "2025-02-25T18:31:57.101921",
     "exception": false,
     "start_time": "2025-02-25T18:31:57.007775",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_20.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target4', 'Target for Cox-Loss Models')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "1c1c0a98",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:57.131916Z",
     "iopub.status.busy": "2025-02-25T18:31:57.131511Z",
     "iopub.status.idle": "2025-02-25T18:31:57.209026Z",
     "shell.execute_reply": "2025-02-25T18:31:57.207701Z"
    },
    "papermill": {
     "duration": 0.095427,
     "end_time": "2025-02-25T18:31:57.211652",
     "exception": false,
     "start_time": "2025-02-25T18:31:57.116225",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_21.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target5', 'efs_time')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "d0fac71e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:57.243278Z",
     "iopub.status.busy": "2025-02-25T18:31:57.242911Z",
     "iopub.status.idle": "2025-02-25T18:31:57.318648Z",
     "shell.execute_reply": "2025-02-25T18:31:57.317459Z"
    },
    "papermill": {
     "duration": 0.094251,
     "end_time": "2025-02-25T18:31:57.320982",
     "exception": false,
     "start_time": "2025-02-25T18:31:57.226731",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_22.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target6', 'Pairwise Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "dfd852e2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:57.351224Z",
     "iopub.status.busy": "2025-02-25T18:31:57.350828Z",
     "iopub.status.idle": "2025-02-25T18:31:57.403660Z",
     "shell.execute_reply": "2025-02-25T18:31:57.402552Z"
    },
    "papermill": {
     "duration": 0.070646,
     "end_time": "2025-02-25T18:31:57.406044",
     "exception": false,
     "start_time": "2025-02-25T18:31:57.335398",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Shape of dataframe: (28800, 66)\n",
      "Memory usage: 11.54 MB\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>dri_score</th>\n",
       "      <th>psych_disturb</th>\n",
       "      <th>cyto_score</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>hla_match_c_high</th>\n",
       "      <th>hla_high_res_8</th>\n",
       "      <th>tbi_status</th>\n",
       "      <th>arrhythmia</th>\n",
       "      <th>hla_low_res_6</th>\n",
       "      <th>graft_type</th>\n",
       "      <th>vent_hist</th>\n",
       "      <th>renal_issue</th>\n",
       "      <th>pulm_severe</th>\n",
       "      <th>prim_disease_hct</th>\n",
       "      <th>hla_high_res_6</th>\n",
       "      <th>cmv_status</th>\n",
       "      <th>hla_high_res_10</th>\n",
       "      <th>hla_match_dqb1_high</th>\n",
       "      <th>tce_imm_match</th>\n",
       "      <th>hla_nmdp_6</th>\n",
       "      <th>hla_match_c_low</th>\n",
       "      <th>rituximab</th>\n",
       "      <th>hla_match_drb1_low</th>\n",
       "      <th>hla_match_dqb1_low</th>\n",
       "      <th>prod_type</th>\n",
       "      <th>cyto_score_detail</th>\n",
       "      <th>conditioning_intensity</th>\n",
       "      <th>ethnicity</th>\n",
       "      <th>year_hct</th>\n",
       "      <th>obesity</th>\n",
       "      <th>mrd_hct</th>\n",
       "      <th>in_vivo_tcd</th>\n",
       "      <th>tce_match</th>\n",
       "      <th>hla_match_a_high</th>\n",
       "      <th>hepatic_severe</th>\n",
       "      <th>donor_age</th>\n",
       "      <th>prior_tumor</th>\n",
       "      <th>hla_match_b_low</th>\n",
       "      <th>peptic_ulcer</th>\n",
       "      <th>age_at_hct</th>\n",
       "      <th>hla_match_a_low</th>\n",
       "      <th>gvhd_proph</th>\n",
       "      <th>rheum_issue</th>\n",
       "      <th>sex_match</th>\n",
       "      <th>hla_match_b_high</th>\n",
       "      <th>race_group</th>\n",
       "      <th>comorbidity_score</th>\n",
       "      <th>karnofsky_score</th>\n",
       "      <th>hepatic_mild</th>\n",
       "      <th>tce_div_match</th>\n",
       "      <th>donor_related</th>\n",
       "      <th>melphalan_dose</th>\n",
       "      <th>hla_low_res_8</th>\n",
       "      <th>cardiac</th>\n",
       "      <th>hla_match_drb1_high</th>\n",
       "      <th>pulm_moderate</th>\n",
       "      <th>hla_low_res_10</th>\n",
       "      <th>efs</th>\n",
       "      <th>efs_time</th>\n",
       "      <th>target1</th>\n",
       "      <th>target2</th>\n",
       "      <th>target3</th>\n",
       "      <th>target4</th>\n",
       "      <th>target5</th>\n",
       "      <th>target6</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>IEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2016.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>9.942000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FKalone</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>42.355999</td>\n",
       "      <td>0.259437</td>\n",
       "      <td>0.458538</td>\n",
       "      <td>-0.779686</td>\n",
       "      <td>-42.355999</td>\n",
       "      <td>-42.355999</td>\n",
       "      <td>-15521</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>TBI +- Other, &gt;cGy</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>AML</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2008.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>72.290001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.705002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Other GVHD Prophylaxis</td>\n",
       "      <td>No</td>\n",
       "      <td>F-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Asian</td>\n",
       "      <td>3.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.672000</td>\n",
       "      <td>1.119238</td>\n",
       "      <td>0.847373</td>\n",
       "      <td>-0.165610</td>\n",
       "      <td>4.672000</td>\n",
       "      <td>-4.672000</td>\n",
       "      <td>-4381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>HIS</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2019.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>33.997002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Cyclophosphamide alone</td>\n",
       "      <td>No</td>\n",
       "      <td>F-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19.792999</td>\n",
       "      <td>0.138415</td>\n",
       "      <td>0.461865</td>\n",
       "      <td>-0.772458</td>\n",
       "      <td>-19.792999</td>\n",
       "      <td>-19.792999</td>\n",
       "      <td>-15443</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>ALL</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2009.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.230000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.244999</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FK+ MMF +- others</td>\n",
       "      <td>No</td>\n",
       "      <td>M-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>White</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>102.348999</td>\n",
       "      <td>1.250770</td>\n",
       "      <td>0.455493</td>\n",
       "      <td>-0.786347</td>\n",
       "      <td>-102.348999</td>\n",
       "      <td>-102.348999</td>\n",
       "      <td>-15530</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>MPN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Hispanic or Latino</td>\n",
       "      <td>2018.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>56.810001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.740000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>TDEPLETION +- other</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>American Indian or Alaska Native</td>\n",
       "      <td>1.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>MEL</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.223000</td>\n",
       "      <td>1.005994</td>\n",
       "      <td>0.464399</td>\n",
       "      <td>-0.766987</td>\n",
       "      <td>-16.223000</td>\n",
       "      <td>-16.223000</td>\n",
       "      <td>-15383</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   ID                       dri_score psych_disturb    cyto_score diabetes  \\\n",
       "0   0  N/A - non-malignant indication            No       Unknown       No   \n",
       "1   1                    Intermediate            No  Intermediate       No   \n",
       "2   2  N/A - non-malignant indication            No       Unknown       No   \n",
       "3   3                            High            No  Intermediate       No   \n",
       "4   4                            High            No       Unknown       No   \n",
       "\n",
       "   hla_match_c_high  hla_high_res_8          tbi_status arrhythmia  \\\n",
       "0              -1.0            -1.0              No TBI         No   \n",
       "1               2.0             8.0  TBI +- Other, >cGy         No   \n",
       "2               2.0             8.0              No TBI         No   \n",
       "3               2.0             8.0              No TBI         No   \n",
       "4               2.0             8.0              No TBI         No   \n",
       "\n",
       "   hla_low_res_6        graft_type vent_hist renal_issue pulm_severe  \\\n",
       "0            6.0       Bone marrow        No          No          No   \n",
       "1            6.0  Peripheral blood        No          No          No   \n",
       "2            6.0       Bone marrow        No          No          No   \n",
       "3            6.0       Bone marrow        No          No          No   \n",
       "4            6.0  Peripheral blood        No          No          No   \n",
       "\n",
       "  prim_disease_hct  hla_high_res_6 cmv_status  hla_high_res_10  \\\n",
       "0              IEA             6.0        +/+             -1.0   \n",
       "1              AML             6.0        +/+             10.0   \n",
       "2              HIS             6.0        +/+             10.0   \n",
       "3              ALL             6.0        +/+             10.0   \n",
       "4              MPN             6.0        +/+             10.0   \n",
       "\n",
       "   hla_match_dqb1_high tce_imm_match  hla_nmdp_6  hla_match_c_low rituximab  \\\n",
       "0                  2.0       Unknown         6.0              2.0        No   \n",
       "1                  2.0           P/P         6.0              2.0        No   \n",
       "2                  2.0           P/P         6.0              2.0        No   \n",
       "3                  2.0           P/P         6.0              2.0        No   \n",
       "4                  2.0       Unknown         5.0              2.0        No   \n",
       "\n",
       "   hla_match_drb1_low  hla_match_dqb1_low prod_type cyto_score_detail  \\\n",
       "0                 2.0                 2.0        BM           Unknown   \n",
       "1                 2.0                 2.0        PB      Intermediate   \n",
       "2                 2.0                 2.0        BM           Unknown   \n",
       "3                 2.0                 2.0        BM      Intermediate   \n",
       "4                 2.0                 2.0        PB           Unknown   \n",
       "\n",
       "  conditioning_intensity               ethnicity  year_hct obesity   mrd_hct  \\\n",
       "0                Unknown  Not Hispanic or Latino    2016.0      No   Unknown   \n",
       "1                    MAC  Not Hispanic or Latino    2008.0      No  Positive   \n",
       "2                Unknown  Not Hispanic or Latino    2019.0      No   Unknown   \n",
       "3                    MAC  Not Hispanic or Latino    2009.0      No  Positive   \n",
       "4                    MAC      Hispanic or Latino    2018.0      No   Unknown   \n",
       "\n",
       "  in_vivo_tcd   tce_match  hla_match_a_high hepatic_severe  donor_age  \\\n",
       "0         Yes     Unknown               2.0             No  -1.000000   \n",
       "1          No  Permissive               2.0             No  72.290001   \n",
       "2         Yes     Unknown               2.0             No  -1.000000   \n",
       "3          No  Permissive               2.0             No  29.230000   \n",
       "4         Yes     Unknown               2.0             No  56.810001   \n",
       "\n",
       "  prior_tumor  hla_match_b_low peptic_ulcer  age_at_hct  hla_match_a_low  \\\n",
       "0          No              2.0           No    9.942000              2.0   \n",
       "1          No              2.0           No   43.705002              2.0   \n",
       "2          No              2.0           No   33.997002              2.0   \n",
       "3          No              2.0           No   43.244999              2.0   \n",
       "4          No              2.0           No   29.740000              2.0   \n",
       "\n",
       "               gvhd_proph rheum_issue sex_match  hla_match_b_high  \\\n",
       "0                 FKalone          No       M-F               2.0   \n",
       "1  Other GVHD Prophylaxis          No       F-F               2.0   \n",
       "2  Cyclophosphamide alone          No       F-M               2.0   \n",
       "3       FK+ MMF +- others          No       M-M               2.0   \n",
       "4     TDEPLETION +- other          No       M-F               2.0   \n",
       "\n",
       "                         race_group  comorbidity_score  karnofsky_score  \\\n",
       "0                More than one race                0.0             90.0   \n",
       "1                             Asian                3.0             90.0   \n",
       "2                More than one race                0.0             90.0   \n",
       "3                             White                0.0             90.0   \n",
       "4  American Indian or Alaska Native                1.0             90.0   \n",
       "\n",
       "  hepatic_mild          tce_div_match donor_related      melphalan_dose  \\\n",
       "0           No                Unknown     Unrelated  N/A, Mel not given   \n",
       "1           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "2           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "3          Yes  Permissive mismatched     Unrelated  N/A, Mel not given   \n",
       "4           No  Permissive mismatched       Related                 MEL   \n",
       "\n",
       "   hla_low_res_8 cardiac  hla_match_drb1_high pulm_moderate  hla_low_res_10  \\\n",
       "0            8.0      No                  2.0            No            10.0   \n",
       "1            8.0      No                  2.0           Yes            10.0   \n",
       "2            8.0      No                  2.0            No            10.0   \n",
       "3            8.0      No                  2.0            No            10.0   \n",
       "4            8.0      No                  2.0            No            10.0   \n",
       "\n",
       "   efs    efs_time   target1   target2   target3     target4     target5  \\\n",
       "0  0.0   42.355999  0.259437  0.458538 -0.779686  -42.355999  -42.355999   \n",
       "1  1.0    4.672000  1.119238  0.847373 -0.165610    4.672000   -4.672000   \n",
       "2  0.0   19.792999  0.138415  0.461865 -0.772458  -19.792999  -19.792999   \n",
       "3  0.0  102.348999  1.250770  0.455493 -0.786347 -102.348999 -102.348999   \n",
       "4  0.0   16.223000  1.005994  0.464399 -0.766987  -16.223000  -16.223000   \n",
       "\n",
       "   target6  \n",
       "0   -15521  \n",
       "1    -4381  \n",
       "2   -15443  \n",
       "3   -15530  \n",
       "4   -15383  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fe.info(train_data)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2961248f",
   "metadata": {
    "papermill": {
     "duration": 0.014829,
     "end_time": "2025-02-25T18:31:57.436404",
     "exception": false,
     "start_time": "2025-02-25T18:31:57.421575",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Models with Cox Target</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "aac1ad37",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T18:31:57.467868Z",
     "iopub.status.busy": "2025-02-25T18:31:57.467479Z",
     "iopub.status.idle": "2025-02-25T19:48:05.504215Z",
     "shell.execute_reply": "2025-02-25T19:48:05.503186Z"
    },
    "papermill": {
     "duration": 4568.055056,
     "end_time": "2025-02-25T19:48:05.506349",
     "exception": false,
     "start_time": "2025-02-25T18:31:57.451293",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_24.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.660\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb1_models, ctb1_oof_preds = md.train_model(CFG.ctb_params, target='target1', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "3109eb10",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T19:48:05.539034Z",
     "iopub.status.busy": "2025-02-25T19:48:05.538099Z",
     "iopub.status.idle": "2025-02-25T19:52:51.349840Z",
     "shell.execute_reply": "2025-02-25T19:52:51.348749Z"
    },
    "papermill": {
     "duration": 285.830703,
     "end_time": "2025-02-25T19:52:51.352055",
     "exception": false,
     "start_time": "2025-02-25T19:48:05.521352",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_25.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.658\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb1_models, lgb1_oof_preds = md.train_model(CFG.lgb_params, target='target1', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "63a42e08",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T19:52:51.383735Z",
     "iopub.status.busy": "2025-02-25T19:52:51.383309Z",
     "iopub.status.idle": "2025-02-25T19:52:51.440489Z",
     "shell.execute_reply": "2025-02-25T19:52:51.439320Z"
    },
    "papermill": {
     "duration": 0.075875,
     "end_time": "2025-02-25T19:52:51.442924",
     "exception": false,
     "start_time": "2025-02-25T19:52:51.367049",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb1_preds = md.infer_model(test_data, ctb1_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "bca771af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T19:52:51.475155Z",
     "iopub.status.busy": "2025-02-25T19:52:51.474765Z",
     "iopub.status.idle": "2025-02-25T19:52:51.667484Z",
     "shell.execute_reply": "2025-02-25T19:52:51.666122Z"
    },
    "papermill": {
     "duration": 0.212091,
     "end_time": "2025-02-25T19:52:51.670401",
     "exception": false,
     "start_time": "2025-02-25T19:52:51.458310",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb1_preds = md.infer_model(test_data, lgb1_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ac6ad7b6",
   "metadata": {
    "papermill": {
     "duration": 0.014935,
     "end_time": "2025-02-25T19:52:51.703899",
     "exception": false,
     "start_time": "2025-02-25T19:52:51.688964",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Models with Kaplan-Meier Target</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "88e81de4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T19:52:51.735875Z",
     "iopub.status.busy": "2025-02-25T19:52:51.735466Z",
     "iopub.status.idle": "2025-02-25T20:37:41.156096Z",
     "shell.execute_reply": "2025-02-25T20:37:41.154969Z"
    },
    "papermill": {
     "duration": 2689.439051,
     "end_time": "2025-02-25T20:37:41.158185",
     "exception": false,
     "start_time": "2025-02-25T19:52:51.719134",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_28.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.675\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb2_models, ctb2_oof_preds = md.train_model(CFG.ctb_params, target='target2', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "03f0840b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T20:37:41.190864Z",
     "iopub.status.busy": "2025-02-25T20:37:41.190455Z",
     "iopub.status.idle": "2025-02-25T20:38:21.487327Z",
     "shell.execute_reply": "2025-02-25T20:38:21.486134Z"
    },
    "papermill": {
     "duration": 40.31579,
     "end_time": "2025-02-25T20:38:21.489490",
     "exception": false,
     "start_time": "2025-02-25T20:37:41.173700",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_29.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.667\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb2_models, lgb2_oof_preds = md.train_model(CFG.lgb_params, target='target2', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "8c7c775f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T20:38:21.522251Z",
     "iopub.status.busy": "2025-02-25T20:38:21.521893Z",
     "iopub.status.idle": "2025-02-25T20:38:21.570763Z",
     "shell.execute_reply": "2025-02-25T20:38:21.569604Z"
    },
    "papermill": {
     "duration": 0.067965,
     "end_time": "2025-02-25T20:38:21.573083",
     "exception": false,
     "start_time": "2025-02-25T20:38:21.505118",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb2_preds = md.infer_model(test_data, ctb2_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "43a4b242",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T20:38:21.606357Z",
     "iopub.status.busy": "2025-02-25T20:38:21.605996Z",
     "iopub.status.idle": "2025-02-25T20:38:21.759382Z",
     "shell.execute_reply": "2025-02-25T20:38:21.758353Z"
    },
    "papermill": {
     "duration": 0.173143,
     "end_time": "2025-02-25T20:38:21.762023",
     "exception": false,
     "start_time": "2025-02-25T20:38:21.588880",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb2_preds = md.infer_model(test_data, lgb2_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "879c4577",
   "metadata": {
    "papermill": {
     "duration": 0.018458,
     "end_time": "2025-02-25T20:38:21.796394",
     "exception": false,
     "start_time": "2025-02-25T20:38:21.777936",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Models with Nelson-Aalen Target</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "508bc3dc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T20:38:21.844151Z",
     "iopub.status.busy": "2025-02-25T20:38:21.843589Z",
     "iopub.status.idle": "2025-02-25T21:23:10.792102Z",
     "shell.execute_reply": "2025-02-25T21:23:10.791100Z"
    },
    "papermill": {
     "duration": 2688.976428,
     "end_time": "2025-02-25T21:23:10.794238",
     "exception": false,
     "start_time": "2025-02-25T20:38:21.817810",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_32.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.678\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb3_models, ctb3_oof_preds = md.train_model(CFG.ctb_params, target='target3', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "f9372b57",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:23:10.827807Z",
     "iopub.status.busy": "2025-02-25T21:23:10.827400Z",
     "iopub.status.idle": "2025-02-25T21:23:47.275247Z",
     "shell.execute_reply": "2025-02-25T21:23:47.274189Z"
    },
    "papermill": {
     "duration": 36.467194,
     "end_time": "2025-02-25T21:23:47.277422",
     "exception": false,
     "start_time": "2025-02-25T21:23:10.810228",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_33.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.670\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb3_models, lgb3_oof_preds = md.train_model(CFG.lgb_params, target='target3', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "62ceba47",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:23:47.311780Z",
     "iopub.status.busy": "2025-02-25T21:23:47.311399Z",
     "iopub.status.idle": "2025-02-25T21:23:47.364785Z",
     "shell.execute_reply": "2025-02-25T21:23:47.363682Z"
    },
    "papermill": {
     "duration": 0.07313,
     "end_time": "2025-02-25T21:23:47.367283",
     "exception": false,
     "start_time": "2025-02-25T21:23:47.294153",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb3_preds = md.infer_model(test_data, ctb3_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "02830dcb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:23:47.402308Z",
     "iopub.status.busy": "2025-02-25T21:23:47.401701Z",
     "iopub.status.idle": "2025-02-25T21:23:47.554488Z",
     "shell.execute_reply": "2025-02-25T21:23:47.553220Z"
    },
    "papermill": {
     "duration": 0.172965,
     "end_time": "2025-02-25T21:23:47.557125",
     "exception": false,
     "start_time": "2025-02-25T21:23:47.384160",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb3_preds = md.infer_model(test_data, lgb3_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "221efcd5",
   "metadata": {
    "papermill": {
     "duration": 0.015995,
     "end_time": "2025-02-25T21:23:47.589444",
     "exception": false,
     "start_time": "2025-02-25T21:23:47.573449",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Cox-Loss Models</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "86f30113",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:23:47.623921Z",
     "iopub.status.busy": "2025-02-25T21:23:47.623500Z",
     "iopub.status.idle": "2025-02-25T21:30:20.522683Z",
     "shell.execute_reply": "2025-02-25T21:30:20.521483Z"
    },
    "papermill": {
     "duration": 392.919028,
     "end_time": "2025-02-25T21:30:20.524743",
     "exception": false,
     "start_time": "2025-02-25T21:23:47.605715",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_36.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.672\n",
      "\n"
     ]
    }
   ],
   "source": [
    "cox1_models, cox1_oof_preds = md.train_model(CFG.cox1_params, target='target4', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "45005cad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:30:20.561806Z",
     "iopub.status.busy": "2025-02-25T21:30:20.561013Z",
     "iopub.status.idle": "2025-02-25T21:41:56.401322Z",
     "shell.execute_reply": "2025-02-25T21:41:56.400094Z"
    },
    "papermill": {
     "duration": 695.861982,
     "end_time": "2025-02-25T21:41:56.403624",
     "exception": false,
     "start_time": "2025-02-25T21:30:20.541642",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_37.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.672\n",
      "\n"
     ]
    }
   ],
   "source": [
    "cox2_models, cox2_oof_preds = md.train_model(CFG.cox2_params, target='target4', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "b6fb9d51",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.439061Z",
     "iopub.status.busy": "2025-02-25T21:41:56.438575Z",
     "iopub.status.idle": "2025-02-25T21:41:56.485627Z",
     "shell.execute_reply": "2025-02-25T21:41:56.484531Z"
    },
    "papermill": {
     "duration": 0.067682,
     "end_time": "2025-02-25T21:41:56.488004",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.420322",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "cox1_preds = md.infer_model(test_data, cox1_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "1bc53b9b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.523456Z",
     "iopub.status.busy": "2025-02-25T21:41:56.523082Z",
     "iopub.status.idle": "2025-02-25T21:41:56.568639Z",
     "shell.execute_reply": "2025-02-25T21:41:56.567575Z"
    },
    "papermill": {
     "duration": 0.066011,
     "end_time": "2025-02-25T21:41:56.570983",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.504972",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "cox2_preds = md.infer_model(test_data, cox2_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "abca7440",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.606805Z",
     "iopub.status.busy": "2025-02-25T21:41:56.605828Z",
     "iopub.status.idle": "2025-02-25T21:41:56.611648Z",
     "shell.execute_reply": "2025-02-25T21:41:56.610690Z"
    },
    "papermill": {
     "duration": 0.02629,
     "end_time": "2025-02-25T21:41:56.613876",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.587586",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# ctb5_models, ctb5_oof_preds = md.train_model(CFG.ctb_params, target='target5', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "42bc4710",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.649239Z",
     "iopub.status.busy": "2025-02-25T21:41:56.648874Z",
     "iopub.status.idle": "2025-02-25T21:41:56.654557Z",
     "shell.execute_reply": "2025-02-25T21:41:56.653713Z"
    },
    "papermill": {
     "duration": 0.025871,
     "end_time": "2025-02-25T21:41:56.656628",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.630757",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# lgb5_models, lgb5_oof_preds = md.train_model(CFG.lgb_params, target='target5', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "0c741942",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.692222Z",
     "iopub.status.busy": "2025-02-25T21:41:56.691847Z",
     "iopub.status.idle": "2025-02-25T21:41:56.696194Z",
     "shell.execute_reply": "2025-02-25T21:41:56.695145Z"
    },
    "papermill": {
     "duration": 0.024126,
     "end_time": "2025-02-25T21:41:56.698153",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.674027",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# ctb5_preds = md.infer_model(test_data, ctb5_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "d613ed46",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.733763Z",
     "iopub.status.busy": "2025-02-25T21:41:56.733367Z",
     "iopub.status.idle": "2025-02-25T21:41:56.737833Z",
     "shell.execute_reply": "2025-02-25T21:41:56.736856Z"
    },
    "papermill": {
     "duration": 0.024801,
     "end_time": "2025-02-25T21:41:56.739854",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.715053",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# lgb5_preds = md.infer_model(test_data, lgb5_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "6b3dfdf9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T21:41:56.775796Z",
     "iopub.status.busy": "2025-02-25T21:41:56.775041Z",
     "iopub.status.idle": "2025-02-25T22:36:24.217204Z",
     "shell.execute_reply": "2025-02-25T22:36:24.216051Z"
    },
    "papermill": {
     "duration": 3267.462912,
     "end_time": "2025-02-25T22:36:24.219804",
     "exception": false,
     "start_time": "2025-02-25T21:41:56.756892",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_44.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.675\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb6_models, ctb6_oof_preds = md.train_model(CFG.ctb_params, target='target6', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "fe038ab1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:36:24.255680Z",
     "iopub.status.busy": "2025-02-25T22:36:24.255294Z",
     "iopub.status.idle": "2025-02-25T22:37:01.719113Z",
     "shell.execute_reply": "2025-02-25T22:37:01.717933Z"
    },
    "papermill": {
     "duration": 37.484488,
     "end_time": "2025-02-25T22:37:01.721285",
     "exception": false,
     "start_time": "2025-02-25T22:36:24.236797",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_45.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.668\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb6_models, lgb6_oof_preds = md.train_model(CFG.lgb_params, target='target6', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "3a3b8e6d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:37:01.760332Z",
     "iopub.status.busy": "2025-02-25T22:37:01.759941Z",
     "iopub.status.idle": "2025-02-25T22:37:01.830551Z",
     "shell.execute_reply": "2025-02-25T22:37:01.828926Z"
    },
    "papermill": {
     "duration": 0.093879,
     "end_time": "2025-02-25T22:37:01.834013",
     "exception": false,
     "start_time": "2025-02-25T22:37:01.740134",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb6_preds = md.infer_model(test_data, ctb6_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "c46f73e1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:37:01.889005Z",
     "iopub.status.busy": "2025-02-25T22:37:01.888606Z",
     "iopub.status.idle": "2025-02-25T22:37:02.039585Z",
     "shell.execute_reply": "2025-02-25T22:37:02.038453Z"
    },
    "papermill": {
     "duration": 0.178877,
     "end_time": "2025-02-25T22:37:02.042477",
     "exception": false,
     "start_time": "2025-02-25T22:37:01.863600",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb6_preds = md.infer_model(test_data, lgb6_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b955141e",
   "metadata": {
    "papermill": {
     "duration": 0.017423,
     "end_time": "2025-02-25T22:37:02.141700",
     "exception": false,
     "start_time": "2025-02-25T22:37:02.124277",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Ensemble Model</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "929a0a90",
   "metadata": {
    "papermill": {
     "duration": 0.017142,
     "end_time": "2025-02-25T22:37:02.176255",
     "exception": false,
     "start_time": "2025-02-25T22:37:02.159113",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<div style=\"background-color: rgb(247, 230, 202); border: 4px solid rgb(162, 87, 79); border-radius: 40px; padding: 20px; font-family: 'Roboto'; color: rgb(162, 87, 79); text-align: left; font-size: 140%;\">\n",
    "    <b>Calculate C-Index score for Ensemble model using Out-of-Fold (OOF) predictions.</b>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "b89c8be2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:37:02.217344Z",
     "iopub.status.busy": "2025-02-25T22:37:02.216839Z",
     "iopub.status.idle": "2025-02-25T22:37:02.225201Z",
     "shell.execute_reply": "2025-02-25T22:37:02.224007Z"
    },
    "papermill": {
     "duration": 0.033774,
     "end_time": "2025-02-25T22:37:02.227430",
     "exception": false,
     "start_time": "2025-02-25T22:37:02.193656",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "oof_preds = [\n",
    "    ctb1_oof_preds, \n",
    "    lgb1_oof_preds, \n",
    "    ctb2_oof_preds, \n",
    "    lgb2_oof_preds, \n",
    "    ctb3_oof_preds, \n",
    "    lgb3_oof_preds, \n",
    "    cox1_oof_preds,\n",
    "    cox2_oof_preds,\n",
    "    # ctb5_oof_preds, \n",
    "    # lgb5_oof_preds,\n",
    "    ctb6_oof_preds, \n",
    "    lgb6_oof_preds,\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "3f268800",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:37:02.264703Z",
     "iopub.status.busy": "2025-02-25T22:37:02.264213Z",
     "iopub.status.idle": "2025-02-25T22:37:02.316248Z",
     "shell.execute_reply": "2025-02-25T22:37:02.315157Z"
    },
    "papermill": {
     "duration": 0.073849,
     "end_time": "2025-02-25T22:37:02.318860",
     "exception": false,
     "start_time": "2025-02-25T22:37:02.245011",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ranked_oof_preds = np.array([rankdata(p) for p in oof_preds])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "eba7d788",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:37:02.355688Z",
     "iopub.status.busy": "2025-02-25T22:37:02.355206Z",
     "iopub.status.idle": "2025-02-25T22:38:38.812829Z",
     "shell.execute_reply": "2025-02-25T22:38:38.811667Z"
    },
    "papermill": {
     "duration": 96.478693,
     "end_time": "2025-02-25T22:38:38.814936",
     "exception": false,
     "start_time": "2025-02-25T22:37:02.336243",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:02,531] A new study created in memory with name: no-name-17017825-23da-41ae-ad6e-b3de711745de\n",
      "[I 2025-02-25 22:37:02,962] Trial 0 finished with value: 0.6805984641686902 and parameters: {'weight_0': 0.7583944080668411, 'weight_1': 0.9927783131990799, 'weight_2': 0.8858033103455913, 'weight_3': 0.8864138038392477, 'weight_4': 0.175722949322057, 'weight_5': 0.6745623507085136, 'weight_6': 0.809346080771021, 'weight_7': 0.23283694236627667, 'weight_8': 0.6663306711816257, 'weight_9': 0.3378678532555496}. Best is trial 0 with value: 0.6805984641686902.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6806\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:03,396] Trial 1 finished with value: 0.6810415486728298 and parameters: {'weight_0': 0.554508592965745, 'weight_1': 0.5583520064762775, 'weight_2': 0.743316687441086, 'weight_3': 0.42844892900383313, 'weight_4': 0.12346382449284798, 'weight_5': 0.6889953226589061, 'weight_6': 0.8962377079887858, 'weight_7': 0.6975440970666481, 'weight_8': 0.9767238176009132, 'weight_9': 0.6608389155359718}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6810\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:03,827] Trial 2 finished with value: 0.6800471922801761 and parameters: {'weight_0': 0.681163499236032, 'weight_1': 0.5973826547747487, 'weight_2': 0.7889639908378293, 'weight_3': 0.8914922870078497, 'weight_4': 0.6319359667832675, 'weight_5': 0.778218385140619, 'weight_6': 0.2671844692188175, 'weight_7': 0.1921919242063702, 'weight_8': 0.09219614526994616, 'weight_9': 0.541017560976602}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6800\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:04,257] Trial 3 finished with value: 0.6804993601395898 and parameters: {'weight_0': 0.32127820508001437, 'weight_1': 0.07291168588942004, 'weight_2': 0.6251695419814429, 'weight_3': 0.8878451684374494, 'weight_4': 0.7512990102333803, 'weight_5': 0.05714141405567459, 'weight_6': 0.29470992251304295, 'weight_7': 0.7729313637243396, 'weight_8': 0.13405273451178013, 'weight_9': 0.7302230233865437}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6805\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:04,688] Trial 4 finished with value: 0.6806663114533726 and parameters: {'weight_0': 0.687655312095248, 'weight_1': 0.49147257460179694, 'weight_2': 0.08242626635580064, 'weight_3': 0.406790340732089, 'weight_4': 0.6467765150971705, 'weight_5': 0.454112055673559, 'weight_6': 0.49732507737445203, 'weight_7': 0.41731844483214336, 'weight_8': 0.5611670632907801, 'weight_9': 0.8576152095158739}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6807\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:05,120] Trial 5 finished with value: 0.680007757090738 and parameters: {'weight_0': 0.9113788371857711, 'weight_1': 0.6553165110640796, 'weight_2': 0.11003354259376458, 'weight_3': 0.5938784053899044, 'weight_4': 0.33801881293653474, 'weight_5': 0.3043571113684821, 'weight_6': 0.312297107224174, 'weight_7': 0.252587261969101, 'weight_8': 0.4763996451823708, 'weight_9': 0.607451758472503}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6800\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:05,552] Trial 6 finished with value: 0.6794558488305428 and parameters: {'weight_0': 0.45615693205416746, 'weight_1': 0.95296298542797, 'weight_2': 0.2390424736283288, 'weight_3': 0.841914431413011, 'weight_4': 0.34363632615477624, 'weight_5': 0.8572248562717346, 'weight_6': 0.379041237372164, 'weight_7': 0.16370774777864786, 'weight_8': 0.25279795954448125, 'weight_9': 0.5868151020116803}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6795\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:05,988] Trial 7 finished with value: 0.6796833701946068 and parameters: {'weight_0': 0.24940795651947278, 'weight_1': 0.6604439765396657, 'weight_2': 0.500488675189087, 'weight_3': 0.7927723082012785, 'weight_4': 0.8536130888282587, 'weight_5': 0.932466149081267, 'weight_6': 0.1639975506159667, 'weight_7': 0.2803101104714479, 'weight_8': 0.39325300530600305, 'weight_9': 0.5747891646718728}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6797\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:06,417] Trial 8 finished with value: 0.6806667664374497 and parameters: {'weight_0': 0.537185323156392, 'weight_1': 0.28749144873756416, 'weight_2': 0.8779136789738003, 'weight_3': 0.6856791359946389, 'weight_4': 0.7005983323995144, 'weight_5': 0.4716433223281316, 'weight_6': 0.19260475768371554, 'weight_7': 0.2015785208679668, 'weight_8': 0.7307313933886369, 'weight_9': 0.09648367880611795}. Best is trial 1 with value: 0.6810415486728298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6807\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:06,848] Trial 9 finished with value: 0.6812118239099159 and parameters: {'weight_0': 0.30276553342552276, 'weight_1': 0.32359310834289357, 'weight_2': 0.5294385366421219, 'weight_3': 0.33202314446528197, 'weight_4': 0.5700181942512026, 'weight_5': 0.07186895106104194, 'weight_6': 0.8408650717162829, 'weight_7': 0.9128785526422797, 'weight_8': 0.4539078319303538, 'weight_9': 0.5117553324506354}. Best is trial 9 with value: 0.6812118239099159.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6812\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:07,316] Trial 10 finished with value: 0.6814963956903672 and parameters: {'weight_0': 0.13699635662492815, 'weight_1': 0.30247958952376025, 'weight_2': 0.4082972860748736, 'weight_3': 0.14008077615427886, 'weight_4': 0.9826309395508073, 'weight_5': 0.06824901758443756, 'weight_6': 0.7110395011833509, 'weight_7': 0.9957470325612139, 'weight_8': 0.8578788642130113, 'weight_9': 0.26831495380105946}. Best is trial 10 with value: 0.6814963956903672.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:07,785] Trial 11 finished with value: 0.6814941287090108 and parameters: {'weight_0': 0.05146165742594748, 'weight_1': 0.2826282231454693, 'weight_2': 0.4289152193487974, 'weight_3': 0.10228953168914928, 'weight_4': 0.9938843172283405, 'weight_5': 0.07089052501724735, 'weight_6': 0.6705350538124782, 'weight_7': 0.966897351328397, 'weight_8': 0.9742232329443868, 'weight_9': 0.3297643013183711}. Best is trial 10 with value: 0.6814963956903672.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:08,254] Trial 12 finished with value: 0.681433338684411 and parameters: {'weight_0': 0.06481514148622608, 'weight_1': 0.17542397226655054, 'weight_2': 0.37752683165335, 'weight_3': 0.0507890054790404, 'weight_4': 0.9989078969822208, 'weight_5': 0.2353600595233618, 'weight_6': 0.6714965810638588, 'weight_7': 0.9901480028014044, 'weight_8': 0.9932222618600048, 'weight_9': 0.29439645371000284}. Best is trial 10 with value: 0.6814963956903672.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:08,724] Trial 13 finished with value: 0.6815259005986667 and parameters: {'weight_0': 0.09371863891383836, 'weight_1': 0.3637089373662903, 'weight_2': 0.33960093644805456, 'weight_3': 0.05020373030160197, 'weight_4': 0.9964972123637515, 'weight_5': 0.2152253136186632, 'weight_6': 0.6409463036430492, 'weight_7': 0.8052112823119264, 'weight_8': 0.8348870337003762, 'weight_9': 0.27073939511991574}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:09,199] Trial 14 finished with value: 0.6814458620190299 and parameters: {'weight_0': 0.16110293868017617, 'weight_1': 0.43256805728207937, 'weight_2': 0.2621793961147801, 'weight_3': 0.18503633458149424, 'weight_4': 0.8559528084833464, 'weight_5': 0.22302905473803486, 'weight_6': 0.6899716854068089, 'weight_7': 0.7336440678690607, 'weight_8': 0.8044362813638748, 'weight_9': 0.09906416671875481}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:09,669] Trial 15 finished with value: 0.6814478273682509 and parameters: {'weight_0': 0.20114028991120647, 'weight_1': 0.40241441158668156, 'weight_2': 0.2974947349674452, 'weight_3': 0.21476004576143956, 'weight_4': 0.8527726661961677, 'weight_5': 0.3529519495955781, 'weight_6': 0.9856703176746013, 'weight_7': 0.5319629852082185, 'weight_8': 0.8487481031349156, 'weight_9': 0.16655270529695862}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:10,140] Trial 16 finished with value: 0.6814564360176255 and parameters: {'weight_0': 0.4074633945708073, 'weight_1': 0.1552175011436191, 'weight_2': 0.5695610637312348, 'weight_3': 0.23993544908974573, 'weight_4': 0.4377011083372945, 'weight_5': 0.18530873334130227, 'weight_6': 0.5447990697539573, 'weight_7': 0.8571576132370414, 'weight_8': 0.6265996416325944, 'weight_9': 0.43974426385577225}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:10,610] Trial 17 finished with value: 0.6814083099501898 and parameters: {'weight_0': 0.14465556528297732, 'weight_1': 0.7513914048478948, 'weight_2': 0.3919954292832727, 'weight_3': 0.11591232298728855, 'weight_4': 0.9007679957649725, 'weight_5': 0.3690192757243323, 'weight_6': 0.5175683008079586, 'weight_7': 0.5752589779297881, 'weight_8': 0.8463793001679321, 'weight_9': 0.22304393572214726}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:11,085] Trial 18 finished with value: 0.6812333303228905 and parameters: {'weight_0': 0.36342354802084637, 'weight_1': 0.1921905782227161, 'weight_2': 0.17852318022679017, 'weight_3': 0.32082305939781275, 'weight_4': 0.7723373040596875, 'weight_5': 0.5796910324321143, 'weight_6': 0.5782951435090934, 'weight_7': 0.8355967032077773, 'weight_8': 0.7389082242820344, 'weight_9': 0.4019825555215422}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6812\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:11,557] Trial 19 finished with value: 0.680171643238756 and parameters: {'weight_0': 0.169785473851016, 'weight_1': 0.36813555673577203, 'weight_2': 0.671236994075713, 'weight_3': 0.5240233787797408, 'weight_4': 0.9595469873004064, 'weight_5': 0.16844422336315534, 'weight_6': 0.06769248247498083, 'weight_7': 0.6079329839631235, 'weight_8': 0.8915610841813216, 'weight_9': 0.9697548593976497}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6802\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:12,049] Trial 20 finished with value: 0.6806105280001187 and parameters: {'weight_0': 0.9279837668076476, 'weight_1': 0.46707248391574047, 'weight_2': 0.34048911915542907, 'weight_3': 0.29226051965741917, 'weight_4': 0.4990026435307247, 'weight_5': 0.1344513892012752, 'weight_6': 0.4315585763879448, 'weight_7': 0.40633116340949677, 'weight_8': 0.5871324880357154, 'weight_9': 0.2209744116782991}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6806\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:12,520] Trial 21 finished with value: 0.6815103278059654 and parameters: {'weight_0': 0.06832013053962085, 'weight_1': 0.341113648696779, 'weight_2': 0.4269342147051644, 'weight_3': 0.05160900457727116, 'weight_4': 0.9986885771955786, 'weight_5': 0.070571959717403, 'weight_6': 0.6921926033724848, 'weight_7': 0.9610463713597555, 'weight_8': 0.9184701177840114, 'weight_9': 0.31069669096228575}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:12,993] Trial 22 finished with value: 0.6814340318140156 and parameters: {'weight_0': 0.08843198200189241, 'weight_1': 0.23749495059257963, 'weight_2': 0.456589672604077, 'weight_3': 0.05892868043937169, 'weight_4': 0.9120250213763855, 'weight_5': 0.27409915845890864, 'weight_6': 0.7285048832255352, 'weight_7': 0.8959511790234926, 'weight_8': 0.7453359284290789, 'weight_9': 0.42100715371641195}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:13,465] Trial 23 finished with value: 0.6800155453257 and parameters: {'weight_0': 0.249141500065779, 'weight_1': 0.07171428880260111, 'weight_2': 0.1837571847770455, 'weight_3': 0.9973857405189299, 'weight_4': 0.7836630742775261, 'weight_5': 0.14069773435634975, 'weight_6': 0.6049749830246827, 'weight_7': 0.054004663696497424, 'weight_8': 0.9118717186229635, 'weight_9': 0.26322157844536176}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6800\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:13,935] Trial 24 finished with value: 0.6814276996166423 and parameters: {'weight_0': 0.1193585507164669, 'weight_1': 0.3582647999265609, 'weight_2': 0.4594328720562337, 'weight_3': 0.1457681582336803, 'weight_4': 0.9320191431521985, 'weight_5': 0.12478840037947798, 'weight_6': 0.7716892418312952, 'weight_7': 0.9937090039547551, 'weight_8': 0.800383175643109, 'weight_9': 0.16673150729677286}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:14,409] Trial 25 finished with value: 0.6814589504918636 and parameters: {'weight_0': 0.2435742495281761, 'weight_1': 0.24967901844502866, 'weight_2': 0.3148279944240731, 'weight_3': 0.17176535838113965, 'weight_4': 0.8211470563166436, 'weight_5': 0.35765740038648586, 'weight_6': 0.6354442378684177, 'weight_7': 0.7964453093596868, 'weight_8': 0.6709393417284278, 'weight_9': 0.059807618293665266}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:14,883] Trial 26 finished with value: 0.681462545365551 and parameters: {'weight_0': 0.12937715803150618, 'weight_1': 0.41989835236618334, 'weight_2': 0.5818381730672577, 'weight_3': 0.24983680410256648, 'weight_4': 0.9334194866670337, 'weight_5': 0.25426120515182965, 'weight_6': 0.8876305311945534, 'weight_7': 0.6684607149763384, 'weight_8': 0.9062246946835744, 'weight_9': 0.36159786998204985}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:15,356] Trial 27 finished with value: 0.6812755808608488 and parameters: {'weight_0': 0.05237399381465812, 'weight_1': 0.5145750640245607, 'weight_2': 0.19532908935760587, 'weight_3': 0.05537368928064326, 'weight_4': 0.7096340379011894, 'weight_5': 0.059091024183768485, 'weight_6': 0.7369932547371769, 'weight_7': 0.9022642289756089, 'weight_8': 0.786680362080564, 'weight_9': 0.4573710881837395}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:15,828] Trial 28 finished with value: 0.6813621779045296 and parameters: {'weight_0': 0.4651451246185322, 'weight_1': 0.1333527916028347, 'weight_2': 0.3688792006672194, 'weight_3': 0.40641799775145654, 'weight_4': 0.9884988030809007, 'weight_5': 0.43881895070025945, 'weight_6': 0.4434024018500222, 'weight_7': 0.9430639525795707, 'weight_8': 0.3490133254456785, 'weight_9': 0.16446711859597107}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:16,301] Trial 29 finished with value: 0.6813495048773328 and parameters: {'weight_0': 0.2108161190739241, 'weight_1': 0.31015411955726346, 'weight_2': 0.4932759481681999, 'weight_3': 0.1385842793959809, 'weight_4': 0.8953026183977733, 'weight_5': 0.6086759325482887, 'weight_6': 0.8438074022577331, 'weight_7': 0.8478611655408562, 'weight_8': 0.6477825677210524, 'weight_9': 0.3398379031886465}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:16,771] Trial 30 finished with value: 0.6814398881377988 and parameters: {'weight_0': 0.3040325191840064, 'weight_1': 0.22436580590897848, 'weight_2': 0.9917568735279099, 'weight_3': 0.5048195691734538, 'weight_4': 0.2424646288347363, 'weight_5': 0.1930805924463228, 'weight_6': 0.7917213947459267, 'weight_7': 0.7754709600206504, 'weight_8': 0.9369086102490376, 'weight_9': 0.25121593435971995}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:17,243] Trial 31 finished with value: 0.6815145696867664 and parameters: {'weight_0': 0.08052831135311003, 'weight_1': 0.2906962410801096, 'weight_2': 0.424173133982191, 'weight_3': 0.09710674547694492, 'weight_4': 0.9857471558873178, 'weight_5': 0.09524093472498356, 'weight_6': 0.6543831439619339, 'weight_7': 0.9944784514817439, 'weight_8': 0.9689292592643718, 'weight_9': 0.332709713716245}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:17,715] Trial 32 finished with value: 0.6815213285140991 and parameters: {'weight_0': 0.1021709650121727, 'weight_1': 0.3663297057842979, 'weight_2': 0.4122043936590004, 'weight_3': 0.10451252133220704, 'weight_4': 0.9447819432934188, 'weight_5': 0.11911158790852294, 'weight_6': 0.5895296271873829, 'weight_7': 0.9953595194105619, 'weight_8': 0.8571624921944858, 'weight_9': 0.36861541921125784}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:18,186] Trial 33 finished with value: 0.6814998097319559 and parameters: {'weight_0': 0.10848044759406927, 'weight_1': 0.5571657587377933, 'weight_2': 0.31556550649315585, 'weight_3': 0.0980624404704381, 'weight_4': 0.8973475216904718, 'weight_5': 0.1244848124996363, 'weight_6': 0.6060499571628539, 'weight_7': 0.9190962875914426, 'weight_8': 0.9592912302077181, 'weight_9': 0.37025341121124744}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:18,659] Trial 34 finished with value: 0.6811809010944023 and parameters: {'weight_0': 0.19802233335146574, 'weight_1': 0.36092140462146194, 'weight_2': 0.6760886607548136, 'weight_3': 0.27010902897587963, 'weight_4': 0.05943745919374971, 'weight_5': 0.30629923847642165, 'weight_6': 0.4646685432826841, 'weight_7': 0.6718185829055483, 'weight_8': 0.7068649305638388, 'weight_9': 0.49528110812214515}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6812\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:19,131] Trial 35 finished with value: 0.6813399963985693 and parameters: {'weight_0': 0.6507851612431029, 'weight_1': 0.43187205456642164, 'weight_2': 0.5475528178412606, 'weight_3': 0.18701524208046744, 'weight_4': 0.8138059950216595, 'weight_5': 0.7005571360148427, 'weight_6': 0.5536343406946329, 'weight_7': 0.8638566360135629, 'weight_8': 0.8760972757913303, 'weight_9': 0.31607058167973523}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:19,605] Trial 36 finished with value: 0.6812431746419532 and parameters: {'weight_0': 0.6230419654121788, 'weight_1': 0.46868727328674764, 'weight_2': 0.2533190231554016, 'weight_3': 0.09945356144614197, 'weight_4': 0.6968152363365652, 'weight_5': 0.10745253075889803, 'weight_6': 0.637537867572953, 'weight_7': 0.7958923903497905, 'weight_8': 0.8021593162058755, 'weight_9': 0.7578771986209536}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6812\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:20,078] Trial 37 finished with value: 0.6812734067534959 and parameters: {'weight_0': 0.7757802952166795, 'weight_1': 0.6164817984437092, 'weight_2': 0.44228340151141987, 'weight_3': 0.05253985246126761, 'weight_4': 0.9325459169785945, 'weight_5': 0.21808518299460972, 'weight_6': 0.39160353441568607, 'weight_7': 0.7275602132742472, 'weight_8': 0.9420042411647707, 'weight_9': 0.3830332985067495}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:20,546] Trial 38 finished with value: 0.6813795800251627 and parameters: {'weight_0': 0.35373142245108663, 'weight_1': 0.8337030518162962, 'weight_2': 0.6120265085947392, 'weight_3': 0.3691760030630621, 'weight_4': 0.8589012189054103, 'weight_5': 0.16593759321319285, 'weight_6': 0.5046852166546981, 'weight_7': 0.958243554179543, 'weight_8': 0.9985128059516635, 'weight_9': 0.6643692990484802}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:21,018] Trial 39 finished with value: 0.6809856913620973 and parameters: {'weight_0': 0.26807552255799316, 'weight_1': 0.12578620952067945, 'weight_2': 0.12109914556153512, 'weight_3': 0.45821280657050945, 'weight_4': 0.9532273103644071, 'weight_5': 0.3143855012657567, 'weight_6': 0.954282437142668, 'weight_7': 0.826516105948569, 'weight_8': 0.2122880788491321, 'weight_9': 0.48027119931777357}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6810\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:21,487] Trial 40 finished with value: 0.680891598579035 and parameters: {'weight_0': 0.7583162506821226, 'weight_1': 0.5468913355204338, 'weight_2': 0.5032761926661923, 'weight_3': 0.5840568977456466, 'weight_4': 0.7422741989519295, 'weight_5': 0.9957712858137879, 'weight_6': 0.7646837602908966, 'weight_7': 0.921451494766138, 'weight_8': 0.5076943082924552, 'weight_9': 0.18283087040522608}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6809\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:21,981] Trial 41 finished with value: 0.681480920029888 and parameters: {'weight_0': 0.10099940041453968, 'weight_1': 0.597657925601011, 'weight_2': 0.3188140744226067, 'weight_3': 0.10053213697855172, 'weight_4': 0.8783129931966995, 'weight_5': 0.1065947319819484, 'weight_6': 0.5731276190651957, 'weight_7': 0.9361833837824856, 'weight_8': 0.9457562202328578, 'weight_9': 0.38410383979559803}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:22,455] Trial 42 finished with value: 0.6814906250752129 and parameters: {'weight_0': 0.09284876100763137, 'weight_1': 0.5139843183830497, 'weight_2': 0.35070429031328554, 'weight_3': 0.21716609771633866, 'weight_4': 0.6341162757122876, 'weight_5': 0.1068587290490375, 'weight_6': 0.615093952200299, 'weight_7': 0.8863930287302256, 'weight_8': 0.9474318679201399, 'weight_9': 0.2927401720912486}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:22,931] Trial 43 finished with value: 0.6814673804399234 and parameters: {'weight_0': 0.19182901253652557, 'weight_1': 0.37887082476936146, 'weight_2': 0.28851969592290816, 'weight_3': 0.16693579589351398, 'weight_4': 0.9445823647915007, 'weight_5': 0.16234110906980181, 'weight_6': 0.6727184070015895, 'weight_7': 0.9979976955699383, 'weight_8': 0.8323000119385445, 'weight_9': 0.5501116565139592}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:23,403] Trial 44 finished with value: 0.6813590856789661 and parameters: {'weight_0': 0.11393858086014248, 'weight_1': 0.6964240728402042, 'weight_2': 0.2245155990049923, 'weight_3': 0.1115645489768803, 'weight_4': 0.9964347878791585, 'weight_5': 0.05309551422510449, 'weight_6': 0.6013072298443141, 'weight_7': 0.943968373240887, 'weight_8': 0.8923443969829337, 'weight_9': 0.3494681446511919}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:23,878] Trial 45 finished with value: 0.6813076209425499 and parameters: {'weight_0': 0.061019930757560764, 'weight_1': 0.33562636232345916, 'weight_2': 0.4098911806450981, 'weight_3': 0.7223267641498883, 'weight_4': 0.894483175145283, 'weight_5': 0.10790983237177013, 'weight_6': 0.6444165797856698, 'weight_7': 0.9044348938880221, 'weight_8': 0.9970016292143655, 'weight_9': 0.2250481235609614}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:24,351] Trial 46 finished with value: 0.68149581362084 and parameters: {'weight_0': 0.15737472594372023, 'weight_1': 0.2759101221564432, 'weight_2': 0.3730021471942062, 'weight_3': 0.08773864555378995, 'weight_4': 0.8347923749029373, 'weight_5': 0.20721598539021863, 'weight_6': 0.7075616676049179, 'weight_7': 0.7352124414591884, 'weight_8': 0.771729143691532, 'weight_9': 0.42343261922240805}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:24,824] Trial 47 finished with value: 0.6814516784646557 and parameters: {'weight_0': 0.2234504481164367, 'weight_1': 0.47210887165649545, 'weight_2': 0.4899846345788093, 'weight_3': 0.21890843775329055, 'weight_4': 0.9585906986339214, 'weight_5': 0.2763308207363482, 'weight_6': 0.8234163690643348, 'weight_7': 0.3425682436190429, 'weight_8': 0.8376865799394725, 'weight_9': 0.30265366747004163}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:25,300] Trial 48 finished with value: 0.6813795984356189 and parameters: {'weight_0': 0.2881179338152564, 'weight_1': 0.4113520523609599, 'weight_2': 0.05028555755306907, 'weight_3': 0.14070563729051333, 'weight_4': 0.8895608900448131, 'weight_5': 0.41216939385715134, 'weight_6': 0.4808330935992412, 'weight_7': 0.8250560223634626, 'weight_8': 0.9607517325438117, 'weight_9': 0.5180308040540854}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:25,777] Trial 49 finished with value: 0.6808753902321559 and parameters: {'weight_0': 0.990946520581282, 'weight_1': 0.5530451990603592, 'weight_2': 0.4357795875669124, 'weight_3': 0.31532064947184174, 'weight_4': 0.5685744057886725, 'weight_5': 0.5053486929095962, 'weight_6': 0.5423612964090561, 'weight_7': 0.9586394463425486, 'weight_8': 0.917859680392355, 'weight_9': 0.1155898885797475}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6809\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:26,256] Trial 50 finished with value: 0.6808884343455488 and parameters: {'weight_0': 0.15111900723455257, 'weight_1': 0.9854674246041337, 'weight_2': 0.2820727359678179, 'weight_3': 0.08735909751220153, 'weight_4': 0.8083622447592536, 'weight_5': 0.08444961513702512, 'weight_6': 0.7549638085115646, 'weight_7': 0.8768095662081894, 'weight_8': 0.8657448416162639, 'weight_9': 0.27755475035326366}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6809\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:26,730] Trial 51 finished with value: 0.681498288049083 and parameters: {'weight_0': 0.08196418733954314, 'weight_1': 0.3161253450325861, 'weight_2': 0.403976252080995, 'weight_3': 0.1417683187546742, 'weight_4': 0.9901601637183802, 'weight_5': 0.05083070733089428, 'weight_6': 0.6994369636255903, 'weight_7': 0.9707259157384359, 'weight_8': 0.8715456498223974, 'weight_9': 0.24118025319050118}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:27,203] Trial 52 finished with value: 0.6809817749874059 and parameters: {'weight_0': 0.09307751749177023, 'weight_1': 0.21153184572193173, 'weight_2': 0.3540611110143479, 'weight_3': 0.1845687490886038, 'weight_4': 0.9995898767452128, 'weight_5': 0.05261201231103935, 'weight_6': 0.6830933448479847, 'weight_7': 0.9679023856290251, 'weight_8': 0.06802247152692098, 'weight_9': 0.20988398041450657}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6810\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:27,680] Trial 53 finished with value: 0.6814861324864929 and parameters: {'weight_0': 0.07141676494994159, 'weight_1': 0.32159724659433847, 'weight_2': 0.40781875536036183, 'weight_3': 0.14534860244634457, 'weight_4': 0.9632865338508637, 'weight_5': 0.17378681748009364, 'weight_6': 0.6534153690471965, 'weight_7': 0.9241171763527817, 'weight_8': 0.8853948686472788, 'weight_9': 0.33599435081647666}. Best is trial 13 with value: 0.6815259005986667.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:28,153] Trial 54 finished with value: 0.6815501299739675 and parameters: {'weight_0': 0.171320830424238, 'weight_1': 0.2643689188360758, 'weight_2': 0.4810214893841994, 'weight_3': 0.08376856940331007, 'weight_4': 0.9253580335096763, 'weight_5': 0.1414653063906139, 'weight_6': 0.7037245612864349, 'weight_7': 0.9780891297380541, 'weight_8': 0.9711405261234827, 'weight_9': 0.3715974858349988}. Best is trial 54 with value: 0.6815501299739675.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:28,627] Trial 55 finished with value: 0.6815483943688192 and parameters: {'weight_0': 0.17377346647006903, 'weight_1': 0.2790739404184627, 'weight_2': 0.4887241609544482, 'weight_3': 0.07802062491241132, 'weight_4': 0.9245357052242033, 'weight_5': 0.13907826734520573, 'weight_6': 0.5862772238788098, 'weight_7': 0.9970552508271017, 'weight_8': 0.9635252317748143, 'weight_9': 0.4584696254791412}. Best is trial 54 with value: 0.6815501299739675.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:29,102] Trial 56 finished with value: 0.681517474630918 and parameters: {'weight_0': 0.19355952636660742, 'weight_1': 0.286415012156791, 'weight_2': 0.6580087095675409, 'weight_3': 0.06594141063040147, 'weight_4': 0.9224070731192904, 'weight_5': 0.2271898369915223, 'weight_6': 0.5720611394473508, 'weight_7': 0.9999422944405404, 'weight_8': 0.9762509014127249, 'weight_9': 0.4575507043373849}. Best is trial 54 with value: 0.6815501299739675.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:29,578] Trial 57 finished with value: 0.6811279416508529 and parameters: {'weight_0': 0.18031926600707313, 'weight_1': 0.26180916447949465, 'weight_2': 0.7663344609774599, 'weight_3': 0.08029303960537339, 'weight_4': 0.7833459120911833, 'weight_5': 0.23827491786261276, 'weight_6': 0.5619607764913774, 'weight_7': 0.47447979027324955, 'weight_8': 0.9749884622931468, 'weight_9': 0.6058007033129235}. Best is trial 54 with value: 0.6815501299739675.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6811\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:30,057] Trial 58 finished with value: 0.6814064659718891 and parameters: {'weight_0': 0.3405235040415894, 'weight_1': 0.19981063597441795, 'weight_2': 0.8376945817915411, 'weight_3': 0.2597587430724927, 'weight_4': 0.3823739713410484, 'weight_5': 0.26204458239743567, 'weight_6': 0.3322924490602149, 'weight_7': 0.9909433803792367, 'weight_8': 0.8350719526813575, 'weight_9': 0.4731535798406479}. Best is trial 54 with value: 0.6815501299739675.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:30,530] Trial 59 finished with value: 0.681338439892212 and parameters: {'weight_0': 0.22712513676319046, 'weight_1': 0.10859537970308378, 'weight_2': 0.6827129559245777, 'weight_3': 0.20748941523801895, 'weight_4': 0.8611881541122709, 'weight_5': 0.14682654572919376, 'weight_6': 0.5136332633523462, 'weight_7': 0.8866499732612683, 'weight_8': 0.9946519003851862, 'weight_9': 0.4443939747970514}. Best is trial 54 with value: 0.6815501299739675.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:31,003] Trial 60 finished with value: 0.6815923790454332 and parameters: {'weight_0': 0.39213546120000675, 'weight_1': 0.1793452153971064, 'weight_2': 0.6315852460635814, 'weight_3': 0.12250363215814647, 'weight_4': 0.9125510417056433, 'weight_5': 0.19396781365851498, 'weight_6': 0.5874318936809846, 'weight_7': 0.99853594631743, 'weight_8': 0.9236588509759996, 'weight_9': 0.41363569546043555}. Best is trial 60 with value: 0.6815923790454332.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:31,477] Trial 61 finished with value: 0.6816093218690071 and parameters: {'weight_0': 0.48153689668142213, 'weight_1': 0.168232757606109, 'weight_2': 0.5972962727765038, 'weight_3': 0.13030012149936726, 'weight_4': 0.9210786802226342, 'weight_5': 0.2066336961343653, 'weight_6': 0.5743259001423793, 'weight_7': 0.9991178015368394, 'weight_8': 0.9251053320229528, 'weight_9': 0.4152731378996106}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:31,975] Trial 62 finished with value: 0.6815774834872065 and parameters: {'weight_0': 0.4770693499424924, 'weight_1': 0.16551844803078664, 'weight_2': 0.7102550196314785, 'weight_3': 0.12655198306136972, 'weight_4': 0.9235724612606576, 'weight_5': 0.3315140358327482, 'weight_6': 0.5768534413608084, 'weight_7': 0.9996514023566709, 'weight_8': 0.913719951782062, 'weight_9': 0.40050607278872963}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:32,452] Trial 63 finished with value: 0.6815659646200456 and parameters: {'weight_0': 0.4926334889010402, 'weight_1': 0.1556667486861294, 'weight_2': 0.7317117557315859, 'weight_3': 0.1218902297511532, 'weight_4': 0.8395872112978497, 'weight_5': 0.20000741449540735, 'weight_6': 0.5249325900805201, 'weight_7': 0.9402108384924149, 'weight_8': 0.9178202013502745, 'weight_9': 0.542953553230316}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:32,942] Trial 64 finished with value: 0.6815022684641858 and parameters: {'weight_0': 0.5059555437491783, 'weight_1': 0.1692614578566387, 'weight_2': 0.7516629566046628, 'weight_3': 0.1693029864939719, 'weight_4': 0.8396243075063479, 'weight_5': 0.3348823517864672, 'weight_6': 0.531039018530796, 'weight_7': 0.9362550775872958, 'weight_8': 0.9095044098111078, 'weight_9': 0.5458094366924069}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:33,435] Trial 65 finished with value: 0.681447889708997 and parameters: {'weight_0': 0.4094963598559959, 'weight_1': 0.09454116769896231, 'weight_2': 0.7167003820224029, 'weight_3': 0.12865052136075847, 'weight_4': 0.8779601940320555, 'weight_5': 0.28440691177739946, 'weight_6': 0.40023193113030775, 'weight_7': 0.8517898361029956, 'weight_8': 0.9251526522073823, 'weight_9': 0.4050633014509673}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:33,913] Trial 66 finished with value: 0.6814010796646526 and parameters: {'weight_0': 0.5764358320767176, 'weight_1': 0.15782773741670378, 'weight_2': 0.6118870878788901, 'weight_3': 0.23390305009786802, 'weight_4': 0.7434401676990412, 'weight_5': 0.40059397718484235, 'weight_6': 0.48166831926408915, 'weight_7': 0.9511093101576864, 'weight_8': 0.7653484535604115, 'weight_9': 0.6517022504731496}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:34,390] Trial 67 finished with value: 0.6815256239975314 and parameters: {'weight_0': 0.496760006026412, 'weight_1': 0.050408043069505915, 'weight_2': 0.8025974539047364, 'weight_3': 0.19022229237224011, 'weight_4': 0.9225859682902378, 'weight_5': 0.18679019918732032, 'weight_6': 0.43889950895636287, 'weight_7': 0.8969360090563462, 'weight_8': 0.8224164013281583, 'weight_9': 0.4136619077528393}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:34,869] Trial 68 finished with value: 0.6814802390138579 and parameters: {'weight_0': 0.5712833243092292, 'weight_1': 0.23319618623310234, 'weight_2': 0.5784170504161951, 'weight_3': 0.16247482299678787, 'weight_4': 0.7991042812240647, 'weight_5': 0.2416833717992527, 'weight_6': 0.6205989695668503, 'weight_7': 0.9666543925191354, 'weight_8': 0.7012359309183368, 'weight_9': 0.5031940654710239}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:35,343] Trial 69 finished with value: 0.6811098747840149 and parameters: {'weight_0': 0.3816147532934274, 'weight_1': 0.13144746472979002, 'weight_2': 0.6488782289334317, 'weight_3': 0.28363771363231194, 'weight_4': 0.6635189267436614, 'weight_5': 0.20271587990258166, 'weight_6': 0.21079430071444932, 'weight_7': 0.6266767943257783, 'weight_8': 0.5937819157727445, 'weight_9': 0.5812176706248633}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6811\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:35,816] Trial 70 finished with value: 0.6811408777222422 and parameters: {'weight_0': 0.5291789587814785, 'weight_1': 0.18112857604242444, 'weight_2': 0.7006719974472841, 'weight_3': 0.13003317393734004, 'weight_4': 0.2603944564375935, 'weight_5': 0.8315252569685607, 'weight_6': 0.5283258769197234, 'weight_7': 0.8080854230333449, 'weight_8': 0.8871346753213215, 'weight_9': 0.53499224099424}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6811\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:36,291] Trial 71 finished with value: 0.6815102377378519 and parameters: {'weight_0': 0.4718206504612289, 'weight_1': 0.09842115909066634, 'weight_2': 0.8223228177444124, 'weight_3': 0.19743791661181315, 'weight_4': 0.9079887901099832, 'weight_5': 0.15757572976005202, 'weight_6': 0.35256267953566456, 'weight_7': 0.8906344005222517, 'weight_8': 0.8190339394825664, 'weight_9': 0.41887880510087483}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:36,763] Trial 72 finished with value: 0.6815630411746227 and parameters: {'weight_0': 0.4396428496505314, 'weight_1': 0.08602567777108722, 'weight_2': 0.7880411796095862, 'weight_3': 0.07932181487877342, 'weight_4': 0.9625082688809239, 'weight_5': 0.1883377264769039, 'weight_6': 0.44795583364086594, 'weight_7': 0.9132075556952163, 'weight_8': 0.37643162247771117, 'weight_9': 0.39650756135356596}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:37,236] Trial 73 finished with value: 0.6815200420567397 and parameters: {'weight_0': 0.4231311586885013, 'weight_1': 0.07085449633697029, 'weight_2': 0.7269556636636832, 'weight_3': 0.052020116842215136, 'weight_4': 0.9670709290874584, 'weight_5': 0.2960993661482988, 'weight_6': 0.41090909981516843, 'weight_7': 0.9710197990002909, 'weight_8': 0.3867693439708293, 'weight_9': 0.4471290139342999}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:37,709] Trial 74 finished with value: 0.6814979112279907 and parameters: {'weight_0': 0.3815550188538294, 'weight_1': 0.15724930327185266, 'weight_2': 0.9037995347357008, 'weight_3': 0.07812669692783121, 'weight_4': 0.8594585708053257, 'weight_5': 0.21191952568665776, 'weight_6': 0.46307219202909616, 'weight_7': 0.8643100225773579, 'weight_8': 0.20896002016812387, 'weight_9': 0.38988045940049065}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:38,183] Trial 75 finished with value: 0.6814880913454976 and parameters: {'weight_0': 0.43648032632580963, 'weight_1': 0.20241469343783242, 'weight_2': 0.5395249443958978, 'weight_3': 0.11522222873240279, 'weight_4': 0.9165449932570886, 'weight_5': 0.25184380877153434, 'weight_6': 0.489777907103292, 'weight_7': 0.9210279404049546, 'weight_8': 0.46701099297175774, 'weight_9': 0.4798520564562968}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:38,658] Trial 76 finished with value: 0.6814120064751236 and parameters: {'weight_0': 0.5518257236691838, 'weight_1': 0.25666073568556386, 'weight_2': 0.635093152916179, 'weight_3': 0.07299947740962295, 'weight_4': 0.9534712922885472, 'weight_5': 0.3267504151660784, 'weight_6': 0.5919031850192397, 'weight_7': 0.9361616266353239, 'weight_8': 0.43692025890336805, 'weight_9': 0.3549316209026776}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:39,137] Trial 77 finished with value: 0.6815069809186217 and parameters: {'weight_0': 0.4509937444707726, 'weight_1': 0.13374841324535927, 'weight_2': 0.8520319207395392, 'weight_3': 0.15949371561167672, 'weight_4': 0.9731919402041928, 'weight_5': 0.1419438527994931, 'weight_6': 0.2887457606352515, 'weight_7': 0.9739815637860417, 'weight_8': 0.3333413946902069, 'weight_9': 0.5645135613501906}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:39,610] Trial 78 finished with value: 0.6815680192094956 and parameters: {'weight_0': 0.5992135288153395, 'weight_1': 0.2348798259123909, 'weight_2': 0.7821668801607702, 'weight_3': 0.11789413802851967, 'weight_4': 0.8736912598367703, 'weight_5': 0.3760275041392547, 'weight_6': 0.726376394401612, 'weight_7': 0.9163307184856281, 'weight_8': 0.9337333973211605, 'weight_9': 0.4321994126369491}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:40,085] Trial 79 finished with value: 0.6812818034073339 and parameters: {'weight_0': 0.5010103042861752, 'weight_1': 0.2295391203155036, 'weight_2': 0.7821333022274428, 'weight_3': 0.12192898611690345, 'weight_4': 0.7679502921558901, 'weight_5': 0.37593376533315603, 'weight_6': 0.7920795455978882, 'weight_7': 0.9112249594000353, 'weight_8': 0.2747750279492988, 'weight_9': 0.43509417610099715}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:40,559] Trial 80 finished with value: 0.681490867258274 and parameters: {'weight_0': 0.6104327516617397, 'weight_1': 0.18226420443502264, 'weight_2': 0.8960993335878966, 'weight_3': 0.23429771981616807, 'weight_4': 0.8248042216028278, 'weight_5': 0.436174328096924, 'weight_6': 0.7289007200927674, 'weight_7': 0.8424373119407889, 'weight_8': 0.9203119683034089, 'weight_9': 0.5008076496343721}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:41,039] Trial 81 finished with value: 0.6815918483313728 and parameters: {'weight_0': 0.4699167524260941, 'weight_1': 0.2506720615785076, 'weight_2': 0.7392192453577873, 'weight_3': 0.11495085701265678, 'weight_4': 0.8737407019369421, 'weight_5': 0.18640548720540814, 'weight_6': 0.6310350931236378, 'weight_7': 0.7686066268009359, 'weight_8': 0.945181966606284, 'weight_9': 0.39798128496220775}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:41,516] Trial 82 finished with value: 0.6812529072788474 and parameters: {'weight_0': 0.6881205061314519, 'weight_1': 0.1417750985796985, 'weight_2': 0.7552249639294151, 'weight_3': 0.9159153663570512, 'weight_4': 0.8716308510549947, 'weight_5': 0.18020951674369654, 'weight_6': 0.5451720899335034, 'weight_7': 0.7591201960815613, 'weight_8': 0.9510117447586297, 'weight_9': 0.38658743874863316}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:42,016] Trial 83 finished with value: 0.681606555215858 and parameters: {'weight_0': 0.4786132787159504, 'weight_1': 0.10718995716422516, 'weight_2': 0.7269026240458215, 'weight_3': 0.11109456840744049, 'weight_4': 0.8394313320186335, 'weight_5': 0.14504993964711843, 'weight_6': 0.6294713631092842, 'weight_7': 0.9413231925475911, 'weight_8': 0.9346966576738276, 'weight_9': 0.4718660310754153}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:42,489] Trial 84 finished with value: 0.6814638193453361 and parameters: {'weight_0': 0.4845829367054711, 'weight_1': 0.11045130051947308, 'weight_2': 0.7295610256240334, 'weight_3': 0.11805603371306402, 'weight_4': 0.8839439345301007, 'weight_5': 0.5413047783738361, 'weight_6': 0.6232228891444032, 'weight_7': 0.8676377028043626, 'weight_8': 0.8985128744134425, 'weight_9': 0.3993028771372789}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:42,966] Trial 85 finished with value: 0.681572139440236 and parameters: {'weight_0': 0.5232449903060169, 'weight_1': 0.052490277388479264, 'weight_2': 0.802900762123127, 'weight_3': 0.15728562564416787, 'weight_4': 0.8456817361785749, 'weight_5': 0.19093645902139025, 'weight_6': 0.6621097916328548, 'weight_7': 0.9418539722062496, 'weight_8': 0.9440540857232542, 'weight_9': 0.47552792652705184}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:43,442] Trial 86 finished with value: 0.6814215768415608 and parameters: {'weight_0': 0.4458211985465353, 'weight_1': 0.06043973154976905, 'weight_2': 0.6897780654915321, 'weight_3': 0.15981318937429298, 'weight_4': 0.7226609840408635, 'weight_5': 0.48088714850483794, 'weight_6': 0.657038193917455, 'weight_7': 0.9447989392342774, 'weight_8': 0.8596415892031999, 'weight_9': 0.483257628345954}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:43,922] Trial 87 finished with value: 0.6809491150305195 and parameters: {'weight_0': 0.5221816959325283, 'weight_1': 0.08364634445865952, 'weight_2': 0.9310186303660539, 'weight_3': 0.1822675043361453, 'weight_4': 0.8373308133465324, 'weight_5': 0.26433809773474354, 'weight_6': 0.5107530933492687, 'weight_7': 0.08875945521052825, 'weight_8': 0.535469372178986, 'weight_9': 0.5226020094656385}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6809\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:44,398] Trial 88 finished with value: 0.6812204684474082 and parameters: {'weight_0': 0.39263199312672487, 'weight_1': 0.11115518931329083, 'weight_2': 0.7952414701067522, 'weight_3': 0.6294441554549082, 'weight_4': 0.7607807781305737, 'weight_5': 0.1921202235781693, 'weight_6': 0.7413953578782484, 'weight_7': 0.9247905262918532, 'weight_8': 0.9352573009013454, 'weight_9': 0.6385523010684606}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6812\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:44,872] Trial 89 finished with value: 0.6815926486184961 and parameters: {'weight_0': 0.5996155468192111, 'weight_1': 0.08453745217924735, 'weight_2': 0.8135951044332304, 'weight_3': 0.11135799083281388, 'weight_4': 0.843093921009418, 'weight_5': 0.3405600283760516, 'weight_6': 0.6739236343047394, 'weight_7': 0.7740349287586238, 'weight_8': 0.9024095070404228, 'weight_9': 0.3211573666149059}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:45,347] Trial 90 finished with value: 0.6815600330351471 and parameters: {'weight_0': 0.6289450877367629, 'weight_1': 0.15043449491586658, 'weight_2': 0.8580980553838025, 'weight_3': 0.20233978966780633, 'weight_4': 0.7910405835840164, 'weight_5': 0.35228501346202573, 'weight_6': 0.6737713156749282, 'weight_7': 0.7004749143559964, 'weight_8': 0.931298146415585, 'weight_9': 0.32277339149826156}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:45,824] Trial 91 finished with value: 0.6815264379365958 and parameters: {'weight_0': 0.5942599422988495, 'weight_1': 0.08811175013418612, 'weight_2': 0.8149776875513122, 'weight_3': 0.14680735915696186, 'weight_4': 0.8442257876565301, 'weight_5': 0.3797425073713653, 'weight_6': 0.6317026533053767, 'weight_7': 0.7772834512890915, 'weight_8': 0.9041609602139248, 'weight_9': 0.437486241207341}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:46,299] Trial 92 finished with value: 0.6815673536372464 and parameters: {'weight_0': 0.5562747774587337, 'weight_1': 0.06881035053090574, 'weight_2': 0.7747444597657523, 'weight_3': 0.10964061825964681, 'weight_4': 0.8720168837907147, 'weight_5': 0.29859377709167784, 'weight_6': 0.6088454694395895, 'weight_7': 0.825576231171436, 'weight_8': 0.8777385540782189, 'weight_9': 0.419778660841151}. Best is trial 61 with value: 0.6816093218690071.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:46,775] Trial 93 finished with value: 0.68162577648541 and parameters: {'weight_0': 0.6675987501643585, 'weight_1': 0.05470743000562314, 'weight_2': 0.70822962882246, 'weight_3': 0.10736957383778846, 'weight_4': 0.8040281366462512, 'weight_5': 0.3046423837378234, 'weight_6': 0.5620421597225664, 'weight_7': 0.8136093976986835, 'weight_8': 0.880412376931379, 'weight_9': 0.3533298141261442}. Best is trial 93 with value: 0.68162577648541.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:47,252] Trial 94 finished with value: 0.6816184643345633 and parameters: {'weight_0': 0.7122839190614169, 'weight_1': 0.05020262046259262, 'weight_2': 0.7065723272901475, 'weight_3': 0.1092143723189382, 'weight_4': 0.8135814877481341, 'weight_5': 0.3052057474775527, 'weight_6': 0.6019945220844418, 'weight_7': 0.7574858435089451, 'weight_8': 0.8770159522042984, 'weight_9': 0.36637989524816283}. Best is trial 93 with value: 0.68162577648541.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:47,730] Trial 95 finished with value: 0.6816206551991161 and parameters: {'weight_0': 0.7401676444761491, 'weight_1': 0.05421421662195082, 'weight_2': 0.7088160955229739, 'weight_3': 0.13947057646052202, 'weight_4': 0.8026432220987142, 'weight_5': 0.34184692426718793, 'weight_6': 0.5592188137651699, 'weight_7': 0.7484770008115561, 'weight_8': 0.9465924426209689, 'weight_9': 0.2878999294605219}. Best is trial 93 with value: 0.68162577648541.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:48,210] Trial 96 finished with value: 0.6816265231387841 and parameters: {'weight_0': 0.7297514128727353, 'weight_1': 0.051230501562514165, 'weight_2': 0.705351191529109, 'weight_3': 0.15230190268347027, 'weight_4': 0.8113706595023498, 'weight_5': 0.32295861709315166, 'weight_6': 0.5751037519466698, 'weight_7': 0.7583061708403996, 'weight_8': 0.8486770466881459, 'weight_9': 0.27585453314452}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:48,689] Trial 97 finished with value: 0.6815935191280796 and parameters: {'weight_0': 0.7578565595886202, 'weight_1': 0.11886819728264665, 'weight_2': 0.600151547842115, 'weight_3': 0.10190374124797091, 'weight_4': 0.8138054411622128, 'weight_5': 0.3255398154218483, 'weight_6': 0.5597106918120633, 'weight_7': 0.6922710362556549, 'weight_8': 0.8531368616737924, 'weight_9': 0.28674957778930976}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:49,172] Trial 98 finished with value: 0.6815161025751983 and parameters: {'weight_0': 0.7517025810798733, 'weight_1': 0.10549169502145629, 'weight_2': 0.5971917631403594, 'weight_3': 0.21990725004312955, 'weight_4': 0.689749930935111, 'weight_5': 0.40492534304489347, 'weight_6': 0.5556184982509086, 'weight_7': 0.6951027587363118, 'weight_8': 0.792487731946922, 'weight_9': 0.2811403527073276}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:49,649] Trial 99 finished with value: 0.6815961884193925 and parameters: {'weight_0': 0.7212031622958995, 'weight_1': 0.11860534504747772, 'weight_2': 0.6547203017910215, 'weight_3': 0.09728844853115293, 'weight_4': 0.8088815611408406, 'weight_5': 0.3413710163136705, 'weight_6': 0.6031531108709025, 'weight_7': 0.7499938409939632, 'weight_8': 0.8546399928351164, 'weight_9': 0.30108531226554036}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:50,127] Trial 100 finished with value: 0.6815935200700388 and parameters: {'weight_0': 0.7308978573308031, 'weight_1': 0.12032297436164, 'weight_2': 0.6607616845662346, 'weight_3': 0.09559725463676638, 'weight_4': 0.7331986646439747, 'weight_5': 0.3596131274034944, 'weight_6': 0.5967971374039064, 'weight_7': 0.7492301945992351, 'weight_8': 0.8493671431525727, 'weight_9': 0.25237134129258637}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:50,604] Trial 101 finished with value: 0.6816069139180057 and parameters: {'weight_0': 0.7273341257621497, 'weight_1': 0.07207539946288294, 'weight_2': 0.665079732814128, 'weight_3': 0.09599219311285417, 'weight_4': 0.8111385031295212, 'weight_5': 0.35822712696421904, 'weight_6': 0.5920845903195432, 'weight_7': 0.7454158469569582, 'weight_8': 0.8498040569901113, 'weight_9': 0.30361413159232675}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:51,079] Trial 102 finished with value: 0.6816117585270599 and parameters: {'weight_0': 0.7238901732957709, 'weight_1': 0.08048844132518367, 'weight_2': 0.6632472319616002, 'weight_3': 0.09695101920662237, 'weight_4': 0.7263061644295872, 'weight_5': 0.3524649516753026, 'weight_6': 0.5638986803616296, 'weight_7': 0.7247569978378882, 'weight_8': 0.84470062852134, 'weight_9': 0.2507656578843785}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:51,555] Trial 103 finished with value: 0.6815334305355985 and parameters: {'weight_0': 0.7907701515990341, 'weight_1': 0.11685585182048763, 'weight_2': 0.560407165526986, 'weight_3': 0.09639779204716527, 'weight_4': 0.8072753360764653, 'weight_5': 0.3180267004339751, 'weight_6': 0.5644530123785142, 'weight_7': 0.7450391671683156, 'weight_8': 0.767288245258636, 'weight_9': 0.24811108010217967}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:52,055] Trial 104 finished with value: 0.6815959140624821 and parameters: {'weight_0': 0.7253547082186614, 'weight_1': 0.07352017667587879, 'weight_2': 0.65376541721846, 'weight_3': 0.06664240841670702, 'weight_4': 0.7247734186208419, 'weight_5': 0.4337938884491345, 'weight_6': 0.6130865368245183, 'weight_7': 0.7137415461850974, 'weight_8': 0.851656179904906, 'weight_9': 0.20331328975735555}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:52,530] Trial 105 finished with value: 0.6815771998228574 and parameters: {'weight_0': 0.7243314300290384, 'weight_1': 0.06855113803143847, 'weight_2': 0.6642179447400232, 'weight_3': 0.0535457152422184, 'weight_4': 0.6042473824143413, 'weight_5': 0.43349772381457574, 'weight_6': 0.599411755606407, 'weight_7': 0.6439392280657994, 'weight_8': 0.8431012129144115, 'weight_9': 0.19348630477480364}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:53,006] Trial 106 finished with value: 0.6815706864465784 and parameters: {'weight_0': 0.8418304062068027, 'weight_1': 0.055587400779739754, 'weight_2': 0.6408216005535549, 'weight_3': 0.06864600742681745, 'weight_4': 0.7331205054024387, 'weight_5': 0.3563339560652511, 'weight_6': 0.535329959983844, 'weight_7': 0.7143371757649113, 'weight_8': 0.8076594058420177, 'weight_9': 0.26401559635662}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:53,484] Trial 107 finished with value: 0.6815733680095726 and parameters: {'weight_0': 0.7052746425587845, 'weight_1': 0.07608431274731527, 'weight_2': 0.6985690689763726, 'weight_3': 0.14322755655096434, 'weight_4': 0.6817851770415094, 'weight_5': 0.38785565176263115, 'weight_6': 0.501073184409423, 'weight_7': 0.6712134790871312, 'weight_8': 0.744135239172593, 'weight_9': 0.2258626904318465}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:53,961] Trial 108 finished with value: 0.6814579109360299 and parameters: {'weight_0': 0.8165087414692253, 'weight_1': 0.1330578583660698, 'weight_2': 0.6724358366369659, 'weight_3': 0.17646725967606988, 'weight_4': 0.718366669513628, 'weight_5': 0.4580053038051558, 'weight_6': 0.6118209509075374, 'weight_7': 0.792607589686271, 'weight_8': 0.7131061943050843, 'weight_9': 0.3051353381085987}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:54,441] Trial 109 finished with value: 0.6815614330146544 and parameters: {'weight_0': 0.6593069693979374, 'weight_1': 0.09987338405816143, 'weight_2': 0.6232372097773727, 'weight_3': 0.3608971937463199, 'weight_4': 0.7765563986158552, 'weight_5': 0.2859605882099208, 'weight_6': 0.6430138137479681, 'weight_7': 0.567979461357451, 'weight_8': 0.7823588127597945, 'weight_9': 0.15923092550053858}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:54,919] Trial 110 finished with value: 0.6809096615498699 and parameters: {'weight_0': 0.7306605924559411, 'weight_1': 0.8665656946416744, 'weight_2': 0.6603693856191957, 'weight_3': 0.06733989363868295, 'weight_4': 0.7422591949101013, 'weight_5': 0.41335288228858996, 'weight_6': 0.5820698323595908, 'weight_7': 0.7286626253828251, 'weight_8': 0.8185901804903022, 'weight_9': 0.19967558326698265}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6809\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:55,399] Trial 111 finished with value: 0.6815570413850714 and parameters: {'weight_0': 0.7950956297224485, 'weight_1': 0.12021926335349019, 'weight_2': 0.5930398987020887, 'weight_3': 0.0969609873829878, 'weight_4': 0.8180052971122896, 'weight_5': 0.31015022365923195, 'weight_6': 0.559277845001629, 'weight_7': 0.737420616145576, 'weight_8': 0.8541938138661589, 'weight_9': 0.14445437209472867}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:55,877] Trial 112 finished with value: 0.6816054570993996 and parameters: {'weight_0': 0.6705923958754502, 'weight_1': 0.05143619728084109, 'weight_2': 0.5203278340288162, 'weight_3': 0.08974991586647209, 'weight_4': 0.7581365961178902, 'weight_5': 0.3607362275815514, 'weight_6': 0.5466339084091484, 'weight_7': 0.6985948790256478, 'weight_8': 0.8782059598796402, 'weight_9': 0.2957585346814864}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:56,356] Trial 113 finished with value: 0.6816093280416188 and parameters: {'weight_0': 0.6754348426984462, 'weight_1': 0.050168346513977266, 'weight_2': 0.6838535542225738, 'weight_3': 0.14244907128164414, 'weight_4': 0.7630912873002622, 'weight_5': 0.3572274702673966, 'weight_6': 0.5982195806720664, 'weight_7': 0.6512446312794878, 'weight_8': 0.8737281269594017, 'weight_9': 0.2572313988490939}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:56,832] Trial 114 finished with value: 0.6815584932042145 and parameters: {'weight_0': 0.6583601822029996, 'weight_1': 0.05420021778059452, 'weight_2': 0.515431072930727, 'weight_3': 0.13604045852637942, 'weight_4': 0.7603330938942943, 'weight_5': 0.3890603686783334, 'weight_6': 0.5426599709010616, 'weight_7': 0.6392647957231534, 'weight_8': 0.8726854467041821, 'weight_9': 0.34291099495836364}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:57,309] Trial 115 finished with value: 0.6815821175637067 and parameters: {'weight_0': 0.6865635046586096, 'weight_1': 0.08108789904347447, 'weight_2': 0.7011940921180047, 'weight_3': 0.15364199966665532, 'weight_4': 0.7939354919315298, 'weight_5': 0.43073205813672794, 'weight_6': 0.51867691333855, 'weight_7': 0.7174953335222509, 'weight_8': 0.8822243715655043, 'weight_9': 0.22940892663912138}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:57,785] Trial 116 finished with value: 0.6815537867249163 and parameters: {'weight_0': 0.7105222542643138, 'weight_1': 0.09523869710435036, 'weight_2': 0.6805180319428994, 'weight_3': 0.08169673136828012, 'weight_4': 0.7796794758160818, 'weight_5': 0.4802107101344059, 'weight_6': 0.5752073700750989, 'weight_7': 0.6523285468643607, 'weight_8': 0.8324039751352332, 'weight_9': 0.2703015007102851}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:58,262] Trial 117 finished with value: 0.681587424762153 and parameters: {'weight_0': 0.8654052865120981, 'weight_1': 0.05158299094632072, 'weight_2': 0.7187861054739823, 'weight_3': 0.16837428708947227, 'weight_4': 0.7021077905376267, 'weight_5': 0.34829522495302834, 'weight_6': 0.6189737201501565, 'weight_7': 0.6030966822516207, 'weight_8': 0.8926032949233462, 'weight_9': 0.291778799443148}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:58,738] Trial 118 finished with value: 0.6816008248245186 and parameters: {'weight_0': 0.6383735405879397, 'weight_1': 0.07187828866847748, 'weight_2': 0.6184298944647133, 'weight_3': 0.1365272600059485, 'weight_4': 0.6684368979202082, 'weight_5': 0.29204647968540326, 'weight_6': 0.5913355043939158, 'weight_7': 0.6919080364724053, 'weight_8': 0.8058631379160158, 'weight_9': 0.31543905186827836}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:59,218] Trial 119 finished with value: 0.6812977040394252 and parameters: {'weight_0': 0.6746209899295394, 'weight_1': 0.14258553840640595, 'weight_2': 0.5758935274401533, 'weight_3': 0.7501134790629047, 'weight_4': 0.7558861154361434, 'weight_5': 0.28932277122710043, 'weight_6': 0.4673599304018894, 'weight_7': 0.687559336906185, 'weight_8': 0.7993224968742393, 'weight_9': 0.3078780420115745}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:37:59,697] Trial 120 finished with value: 0.6816119093288451 and parameters: {'weight_0': 0.6374115206180807, 'weight_1': 0.09606035228093776, 'weight_2': 0.7580649608942513, 'weight_3': 0.19845607041123808, 'weight_4': 0.6595986354982697, 'weight_5': 0.27052418843832415, 'weight_6': 0.5821142102412039, 'weight_7': 0.7980172795672285, 'weight_8': 0.8732109486740566, 'weight_9': 0.3666637946197449}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:00,175] Trial 121 finished with value: 0.6816072436925666 and parameters: {'weight_0': 0.6458350485672677, 'weight_1': 0.09741284684867377, 'weight_2': 0.7592098153630975, 'weight_3': 0.14728270403496033, 'weight_4': 0.6558619728746499, 'weight_5': 0.27717481928509674, 'weight_6': 0.5832470253858136, 'weight_7': 0.8038666572922967, 'weight_8': 0.8692027830881678, 'weight_9': 0.3549157472909251}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:00,653] Trial 122 finished with value: 0.6816138237876813 and parameters: {'weight_0': 0.6414682339936365, 'weight_1': 0.09058742698728658, 'weight_2': 0.7552664182590935, 'weight_3': 0.19513136638639844, 'weight_4': 0.6643523725698469, 'weight_5': 0.2654959441170968, 'weight_6': 0.5761604106289957, 'weight_7': 0.7942834386098523, 'weight_8': 0.8751258320165815, 'weight_9': 0.3624542393055635}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:01,130] Trial 123 finished with value: 0.6816074846448344 and parameters: {'weight_0': 0.6743962638329396, 'weight_1': 0.09296520118948254, 'weight_2': 0.7426569528849511, 'weight_3': 0.19328288702462126, 'weight_4': 0.6245810109525112, 'weight_5': 0.2642124955517785, 'weight_6': 0.5443596905508215, 'weight_7': 0.8090978698254374, 'weight_8': 0.8683681428887544, 'weight_9': 0.3612948246674992}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:01,610] Trial 124 finished with value: 0.6815883475628591 and parameters: {'weight_0': 0.7020343016019028, 'weight_1': 0.09939915259454007, 'weight_2': 0.7511394522482877, 'weight_3': 0.19420476535171566, 'weight_4': 0.6176858441587427, 'weight_5': 0.2400302868866559, 'weight_6': 0.5729360106852116, 'weight_7': 0.8119244820288046, 'weight_8': 0.8271419984165957, 'weight_9': 0.3669886347303768}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:02,111] Trial 125 finished with value: 0.6815761529742712 and parameters: {'weight_0': 0.6465982088287585, 'weight_1': 0.0898908164962689, 'weight_2': 0.758204656980801, 'weight_3': 0.26286067415253644, 'weight_4': 0.5905342201349334, 'weight_5': 0.26424264168556144, 'weight_6': 0.5232264980693336, 'weight_7': 0.7970642039693944, 'weight_8': 0.8711065151158935, 'weight_9': 0.3512636728953765}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:02,589] Trial 126 finished with value: 0.6815996705435142 and parameters: {'weight_0': 0.6923449324916674, 'weight_1': 0.1399090620057158, 'weight_2': 0.7092002120034585, 'weight_3': 0.2205084148057058, 'weight_4': 0.6470554165786515, 'weight_5': 0.22207453096415497, 'weight_6': 0.4924717828363039, 'weight_7': 0.786204542062163, 'weight_8': 0.8974234790902718, 'weight_9': 0.33769563693556764}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:03,072] Trial 127 finished with value: 0.6816087667043438 and parameters: {'weight_0': 0.7497538197706165, 'weight_1': 0.07435544507645232, 'weight_2': 0.7342138855387227, 'weight_3': 0.17671982488887322, 'weight_4': 0.6342730364909968, 'weight_5': 0.26918694243134683, 'weight_6': 0.6482829078516119, 'weight_7': 0.8151571066693787, 'weight_8': 0.9870496315561265, 'weight_9': 0.3704206525108867}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:03,550] Trial 128 finished with value: 0.681598112167331 and parameters: {'weight_0': 0.7518118851485462, 'weight_1': 0.07303360025550315, 'weight_2': 0.6839393727257699, 'weight_3': 0.2982011648540472, 'weight_4': 0.6411310467935833, 'weight_5': 0.25383989103681026, 'weight_6': 0.6520163617897563, 'weight_7': 0.8141836559816736, 'weight_8': 0.9822010088357218, 'weight_9': 0.34254506466456436}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:04,033] Trial 129 finished with value: 0.681572929665649 and parameters: {'weight_0': 0.7687594764420447, 'weight_1': 0.09222672787028924, 'weight_2': 0.739817746824027, 'weight_3': 0.23897723049439054, 'weight_4': 0.5571745453025151, 'weight_5': 0.27823351109275035, 'weight_6': 0.5394407990662283, 'weight_7': 0.8445144323962381, 'weight_8': 0.9653620698803351, 'weight_9': 0.3746150432056064}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:04,508] Trial 130 finished with value: 0.6812411843900738 and parameters: {'weight_0': 0.6254464389863377, 'weight_1': 0.0667415073744471, 'weight_2': 0.7719871189556928, 'weight_3': 0.18394072691237745, 'weight_4': 0.6610788732246973, 'weight_5': 0.32143986159271604, 'weight_6': 0.5809207223882286, 'weight_7': 0.7590761451670762, 'weight_8': 0.9864320049663803, 'weight_9': 0.9179758194260732}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6812\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:05,003] Trial 131 finished with value: 0.681574087044583 and parameters: {'weight_0': 0.7412419868303763, 'weight_1': 0.1058617265796272, 'weight_2': 0.7208318429127846, 'weight_3': 0.1729890624164953, 'weight_4': 0.6216448584414096, 'weight_5': 0.3051253033187411, 'weight_6': 0.622342383753042, 'weight_7': 0.8258551039257971, 'weight_8': 0.9078477473299417, 'weight_9': 0.3669440388210359}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:05,607] Trial 132 finished with value: 0.6815424922815264 and parameters: {'weight_0': 0.7872298062807112, 'weight_1': 0.08391803915166568, 'weight_2': 0.7417580924655006, 'weight_3': 0.4589362980261727, 'weight_4': 0.5538436342880549, 'weight_5': 0.2363308465821673, 'weight_6': 0.6394015181645668, 'weight_7': 0.778884293400878, 'weight_8': 0.9509945908410301, 'weight_9': 0.3313515598958383}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:06,230] Trial 133 finished with value: 0.6815605983671937 and parameters: {'weight_0': 0.6640162225903238, 'weight_1': 0.1295782243624311, 'weight_2': 0.6966025560734374, 'weight_3': 0.2070935881185287, 'weight_4': 0.4982595417431941, 'weight_5': 0.2648121520323391, 'weight_6': 0.6886026140630948, 'weight_7': 0.7926324957512639, 'weight_8': 0.9307572186258016, 'weight_9': 0.36083678182206536}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:06,712] Trial 134 finished with value: 0.681586265241416 and parameters: {'weight_0': 0.7060771962279465, 'weight_1': 0.16288730162677767, 'weight_2': 0.7632656717389676, 'weight_3': 0.1499932162726579, 'weight_4': 0.6780512955806712, 'weight_5': 0.276450285816765, 'weight_6': 0.5597155330270449, 'weight_7': 0.7591694153451329, 'weight_8': 0.8822217757279276, 'weight_9': 0.38151692478077587}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:07,191] Trial 135 finished with value: 0.6816009822409066 and parameters: {'weight_0': 0.675785950164007, 'weight_1': 0.10052232667722433, 'weight_2': 0.7202821229957618, 'weight_3': 0.13365031858031542, 'weight_4': 0.589988500219413, 'weight_5': 0.30972304495150205, 'weight_6': 0.5915844792246094, 'weight_7': 0.8087674767242576, 'weight_8': 0.911978631806103, 'weight_9': 0.3200823387316236}. Best is trial 96 with value: 0.6816265231387841.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:07,671] Trial 136 finished with value: 0.6816495372901298 and parameters: {'weight_0': 0.6901144428219015, 'weight_1': 0.05021057852202565, 'weight_2': 0.6803936310941302, 'weight_3': 0.19702736088847292, 'weight_4': 0.7046359231920005, 'weight_5': 0.2177648390323163, 'weight_6': 0.5072122307537521, 'weight_7': 0.8355179160073518, 'weight_8': 0.8663200626565972, 'weight_9': 0.2572309277346851}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:08,152] Trial 137 finished with value: 0.6813795773808633 and parameters: {'weight_0': 0.6464410217082548, 'weight_1': 0.05397510721958232, 'weight_2': 0.6831084278817272, 'weight_3': 0.25204690221163273, 'weight_4': 0.7123259004670048, 'weight_5': 0.7257700794824333, 'weight_6': 0.5102682795221198, 'weight_7': 0.8378963516432942, 'weight_8': 0.8369757640297517, 'weight_9': 0.25823924312705243}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:08,633] Trial 138 finished with value: 0.6815982987595762 and parameters: {'weight_0': 0.8106331031408808, 'weight_1': 0.07362079114494995, 'weight_2': 0.7457281293198254, 'weight_3': 0.19141510793379038, 'weight_4': 0.6490306394377338, 'weight_5': 0.21910275819698713, 'weight_6': 0.534401478373743, 'weight_7': 0.8580950803787083, 'weight_8': 0.8677807305095069, 'weight_9': 0.2378735600886913}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:09,116] Trial 139 finished with value: 0.6815845936075963 and parameters: {'weight_0': 0.7714807981047802, 'weight_1': 0.06865767723558838, 'weight_2': 0.7049021438777946, 'weight_3': 0.21797095032097935, 'weight_4': 0.6977368072041635, 'weight_5': 0.24544930117433458, 'weight_6': 0.5671742778419469, 'weight_7': 0.4638349212104055, 'weight_8': 0.8119979248118512, 'weight_9': 0.2775190154981596}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:09,598] Trial 140 finished with value: 0.6813573657159955 and parameters: {'weight_0': 0.7000501443096546, 'weight_1': 0.051425256785610045, 'weight_2': 0.6751601428323226, 'weight_3': 0.17269555893537822, 'weight_4': 0.625915847964239, 'weight_5': 0.33798813853017257, 'weight_6': 0.500173493829614, 'weight_7': 0.7723865836325925, 'weight_8': 0.8902291499962033, 'weight_9': 0.7785340396353677}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:10,078] Trial 141 finished with value: 0.6815916626849235 and parameters: {'weight_0': 0.7426660179878188, 'weight_1': 0.11159392996641823, 'weight_2': 0.6344047066617775, 'weight_3': 0.15541192207654445, 'weight_4': 0.6626620765407061, 'weight_5': 0.27814034425410045, 'weight_6': 0.6309093290321716, 'weight_7': 0.8181605742075858, 'weight_8': 0.9602869988149225, 'weight_9': 0.34959713282407157}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:10,556] Trial 142 finished with value: 0.6816065667404824 and parameters: {'weight_0': 0.6812377098319115, 'weight_1': 0.08690285612058893, 'weight_2': 0.7271285328291252, 'weight_3': 0.19867745381972157, 'weight_4': 0.7904111400016076, 'weight_5': 0.30438144878789536, 'weight_6': 0.601691738832197, 'weight_7': 0.7286727641295803, 'weight_8': 0.8648143025264126, 'weight_9': 0.32457555850822367}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:11,038] Trial 143 finished with value: 0.6816075467170974 and parameters: {'weight_0': 0.6837266499720613, 'weight_1': 0.0831089441919661, 'weight_2': 0.7689305976874856, 'weight_3': 0.1948011004635322, 'weight_4': 0.7876859237711515, 'weight_5': 0.3023272457453473, 'weight_6': 0.6017716359668938, 'weight_7': 0.742030794695145, 'weight_8': 0.8682066430850588, 'weight_9': 0.32036264117740376}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:11,520] Trial 144 finished with value: 0.6816015155441331 and parameters: {'weight_0': 0.6174271143665364, 'weight_1': 0.05095519298678098, 'weight_2': 0.7696163907669095, 'weight_3': 0.23376451059412465, 'weight_4': 0.6857175991442698, 'weight_5': 0.2532395712085641, 'weight_6': 0.5762281866530883, 'weight_7': 0.7471929710540497, 'weight_8': 0.8359742530155179, 'weight_9': 0.2827630134351991}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:12,021] Trial 145 finished with value: 0.6815547960899656 and parameters: {'weight_0': 0.7212826711027592, 'weight_1': 0.144629254238633, 'weight_2': 0.695687552689872, 'weight_3': 0.2804486184288927, 'weight_4': 0.7414747686143114, 'weight_5': 0.3229714406959382, 'weight_6': 0.5513493251897436, 'weight_7': 0.8008750737491291, 'weight_8': 0.7828099304545098, 'weight_9': 0.2702369904447045}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:12,500] Trial 146 finished with value: 0.6816244008337029 and parameters: {'weight_0': 0.6376864377207266, 'weight_1': 0.08594369371594794, 'weight_2': 0.7945271568172542, 'weight_3': 0.171500050623545, 'weight_4': 0.7179271123333293, 'weight_5': 0.230578192312122, 'weight_6': 0.4736494587469764, 'weight_7': 0.7669554745055619, 'weight_8': 0.8931618747063115, 'weight_9': 0.3060584576153821}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:12,984] Trial 147 finished with value: 0.6816233662307132 and parameters: {'weight_0': 0.577880273429781, 'weight_1': 0.1277209995556517, 'weight_2': 0.7930944027841836, 'weight_3': 0.17553679939141495, 'weight_4': 0.7199410760782253, 'weight_5': 0.22473305153671932, 'weight_6': 0.5183744675471337, 'weight_7': 0.7800840002877409, 'weight_8': 0.9153525193114175, 'weight_9': 0.2493382689589893}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:13,466] Trial 148 finished with value: 0.6816253263350277 and parameters: {'weight_0': 0.5904157307158908, 'weight_1': 0.12704791917683333, 'weight_2': 0.7984101780886184, 'weight_3': 0.18031609138116023, 'weight_4': 0.7082279672384552, 'weight_5': 0.22593731630712224, 'weight_6': 0.48675163307972624, 'weight_7': 0.7732972428831792, 'weight_8': 0.9193519468366895, 'weight_9': 0.21743752472218958}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:13,946] Trial 149 finished with value: 0.6815838237870137 and parameters: {'weight_0': 0.5749850957840044, 'weight_1': 0.1273557333962097, 'weight_2': 0.8239715360581709, 'weight_3': 0.16892287614617216, 'weight_4': 0.7068956144661904, 'weight_5': 0.2398449506657382, 'weight_6': 0.42522556820944124, 'weight_7': 0.7657498779653171, 'weight_8': 0.9989265866034447, 'weight_9': 0.25210964661863644}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:14,428] Trial 150 finished with value: 0.6816223402557355 and parameters: {'weight_0': 0.6050905284727114, 'weight_1': 0.1899394333932059, 'weight_2': 0.8441607265509431, 'weight_3': 0.21167946315427635, 'weight_4': 0.770673289724522, 'weight_5': 0.1644417267144164, 'weight_6': 0.46643336873106717, 'weight_7': 0.7170077405241659, 'weight_8': 0.9098132604914594, 'weight_9': 0.22095741809294586}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:14,910] Trial 151 finished with value: 0.6816054212933752 and parameters: {'weight_0': 0.5851300663033282, 'weight_1': 0.183123263896343, 'weight_2': 0.8461454740434591, 'weight_3': 0.22361869918015714, 'weight_4': 0.7699574535192367, 'weight_5': 0.21198343348342716, 'weight_6': 0.47191663859944, 'weight_7': 0.717857922027478, 'weight_8': 0.9207568114662906, 'weight_9': 0.17867902389665144}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:15,391] Trial 152 finished with value: 0.6816112580808343 and parameters: {'weight_0': 0.5524365881308501, 'weight_1': 0.21270730192144666, 'weight_2': 0.8763406523657746, 'weight_3': 0.2046145289001913, 'weight_4': 0.7205839024864208, 'weight_5': 0.17088851642897698, 'weight_6': 0.45018113596747494, 'weight_7': 0.7819578557910085, 'weight_8': 0.8995942561926143, 'weight_9': 0.22986856776520834}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:15,875] Trial 153 finished with value: 0.6816089571539672 and parameters: {'weight_0': 0.6097584493190451, 'weight_1': 0.1663023506092698, 'weight_2': 0.8837376138984643, 'weight_3': 0.24264604306212703, 'weight_4': 0.7156640591326454, 'weight_5': 0.22696524169146806, 'weight_6': 0.4564987408632501, 'weight_7': 0.7800562389410256, 'weight_8': 0.9161528860526307, 'weight_9': 0.23080720234991176}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:16,357] Trial 154 finished with value: 0.6815952152318742 and parameters: {'weight_0': 0.5390912047663666, 'weight_1': 0.19704170423315737, 'weight_2': 0.8768625592980741, 'weight_3': 0.24339083465103617, 'weight_4': 0.737416505693634, 'weight_5': 0.16821221227614025, 'weight_6': 0.4130415237599497, 'weight_7': 0.7808574869947513, 'weight_8': 0.9026232139449135, 'weight_9': 0.2170685108710681}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:16,837] Trial 155 finished with value: 0.6816025654466557 and parameters: {'weight_0': 0.5569795806018678, 'weight_1': 0.15626457877183558, 'weight_2': 0.8596823284524788, 'weight_3': 0.2064187031024803, 'weight_4': 0.69254952476612, 'weight_5': 0.2248637907635614, 'weight_6': 0.47841936449994465, 'weight_7': 0.7615081734724711, 'weight_8': 0.8963483161649615, 'weight_9': 0.2353586769558555}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:17,317] Trial 156 finished with value: 0.681578181987709 and parameters: {'weight_0': 0.6126005288863501, 'weight_1': 0.2047492555637393, 'weight_2': 0.9636041209958214, 'weight_3': 0.26380549834030054, 'weight_4': 0.7238307372347544, 'weight_5': 0.1640369769268083, 'weight_6': 0.45246560190240737, 'weight_7': 0.6686693583705334, 'weight_8': 0.9251751726286779, 'weight_9': 0.20956908372923988}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:17,796] Trial 157 finished with value: 0.68162116842222 and parameters: {'weight_0': 0.5959562998106605, 'weight_1': 0.18367531015194777, 'weight_2': 0.9241135269870211, 'weight_3': 0.15409898699184704, 'weight_4': 0.7462275462539258, 'weight_5': 0.20138894917754296, 'weight_6': 0.43906595808840493, 'weight_7': 0.7845674558265185, 'weight_8': 0.9471040294424994, 'weight_9': 0.13364352409662764}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:18,279] Trial 158 finished with value: 0.6816349859530264 and parameters: {'weight_0': 0.631955448998509, 'weight_1': 0.21607153418463398, 'weight_2': 0.8327260856445686, 'weight_3': 0.13142081047341164, 'weight_4': 0.7606328628099991, 'weight_5': 0.201797849376628, 'weight_6': 0.38080846975943916, 'weight_7': 0.7282760113243026, 'weight_8': 0.9394107539194897, 'weight_9': 0.13046178965465444}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:18,761] Trial 159 finished with value: 0.6814783637675731 and parameters: {'weight_0': 0.6295021511156954, 'weight_1': 0.13211984288750112, 'weight_2': 0.9090775589835726, 'weight_3': 0.15813116967678192, 'weight_4': 0.7472414180105343, 'weight_5': 0.6398316959434831, 'weight_6': 0.38083457389061837, 'weight_7': 0.7149417025806042, 'weight_8': 0.9519325715742363, 'weight_9': 0.05091832305576614}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:19,248] Trial 160 finished with value: 0.6815041116065969 and parameters: {'weight_0': 0.5949240965719659, 'weight_1': 0.11574620759287987, 'weight_2': 0.7970475844876591, 'weight_3': 0.5673316492598487, 'weight_4': 0.7708616820122942, 'weight_5': 0.12085510968390185, 'weight_6': 0.35918641991578, 'weight_7': 0.7350582944647265, 'weight_8': 0.9413361212670155, 'weight_9': 0.11352079762950021}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:19,729] Trial 161 finished with value: 0.681623978319077 and parameters: {'weight_0': 0.5727769564824593, 'weight_1': 0.17948323901570795, 'weight_2': 0.9546948155381819, 'weight_3': 0.1328779191263479, 'weight_4': 0.7552006299527312, 'weight_5': 0.20137787083950998, 'weight_6': 0.42746053057151784, 'weight_7': 0.7879342547175505, 'weight_8': 0.8953907422876918, 'weight_9': 0.09533659984456148}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:20,213] Trial 162 finished with value: 0.6816316037224747 and parameters: {'weight_0': 0.5642142535948789, 'weight_1': 0.23041555949507042, 'weight_2': 0.94547949855701, 'weight_3': 0.13370658212540332, 'weight_4': 0.764358233073612, 'weight_5': 0.18001529182472492, 'weight_6': 0.4114043789538821, 'weight_7': 0.7927807453540092, 'weight_8': 0.8953664244569614, 'weight_9': 0.08866904679820119}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:20,694] Trial 163 finished with value: 0.6816297943299727 and parameters: {'weight_0': 0.5689495381720474, 'weight_1': 0.2074631434844026, 'weight_2': 0.8253210311277085, 'weight_3': 0.12009987042572759, 'weight_4': 0.7396744520613601, 'weight_5': 0.2028169914016309, 'weight_6': 0.4361328569987461, 'weight_7': 0.7935439983899373, 'weight_8': 0.8934973421118075, 'weight_9': 0.0903275550465238}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:21,176] Trial 164 finished with value: 0.6816260917559055 and parameters: {'weight_0': 0.5935410988734063, 'weight_1': 0.2196357159828227, 'weight_2': 0.9272353625505371, 'weight_3': 0.13209949206872845, 'weight_4': 0.7539865780233213, 'weight_5': 0.2067658954372543, 'weight_6': 0.41964098285590684, 'weight_7': 0.844927566974014, 'weight_8': 0.8886216060628509, 'weight_9': 0.08250440383440116}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:21,658] Trial 165 finished with value: 0.6813332966542165 and parameters: {'weight_0': 0.5716895110837522, 'weight_1': 0.21908699383618968, 'weight_2': 0.9589086315692034, 'weight_3': 0.13208677205267633, 'weight_4': 0.791835993997836, 'weight_5': 0.20836224115606228, 'weight_6': 0.42257858604878135, 'weight_7': 0.8369457353997143, 'weight_8': 0.12717691323864522, 'weight_9': 0.0806461483608651}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6813\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:22,168] Trial 166 finished with value: 0.6816301228142725 and parameters: {'weight_0': 0.5838889564067842, 'weight_1': 0.18584001598117902, 'weight_2': 0.9264679762527559, 'weight_3': 0.12219413807610749, 'weight_4': 0.7511558506479128, 'weight_5': 0.19882458977278017, 'weight_6': 0.43335761336910056, 'weight_7': 0.8306205716882408, 'weight_8': 0.8881767340079098, 'weight_9': 0.13781354519411196}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:22,648] Trial 167 finished with value: 0.6816352058347426 and parameters: {'weight_0': 0.5925586206069138, 'weight_1': 0.24559088849677296, 'weight_2': 0.9425345138569269, 'weight_3': 0.11813746109289675, 'weight_4': 0.7569690115075642, 'weight_5': 0.15499179175677416, 'weight_6': 0.40280307808933313, 'weight_7': 0.86928277374648, 'weight_8': 0.9616891772073028, 'weight_9': 0.13334145931334707}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:23,129] Trial 168 finished with value: 0.6816385745684673 and parameters: {'weight_0': 0.586690980276873, 'weight_1': 0.2358537566912474, 'weight_2': 0.9488293041690485, 'weight_3': 0.11588455916933114, 'weight_4': 0.7501440812952405, 'weight_5': 0.18113094485516115, 'weight_6': 0.38731051080841256, 'weight_7': 0.8795287768059199, 'weight_8': 0.9681019700537004, 'weight_9': 0.13135747182425758}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:23,612] Trial 169 finished with value: 0.681634110015943 and parameters: {'weight_0': 0.5781822658294344, 'weight_1': 0.2422393744761473, 'weight_2': 0.9332011572881991, 'weight_3': 0.12140850930214547, 'weight_4': 0.7505250241570042, 'weight_5': 0.1558240787839179, 'weight_6': 0.3929101327528316, 'weight_7': 0.8788428788018694, 'weight_8': 0.9754266395618985, 'weight_9': 0.1388878144951413}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:24,095] Trial 170 finished with value: 0.6816378054176626 and parameters: {'weight_0': 0.5814336464323276, 'weight_1': 0.245381171088741, 'weight_2': 0.9357276759547263, 'weight_3': 0.12046351444738136, 'weight_4': 0.7559315100747267, 'weight_5': 0.15189660496513613, 'weight_6': 0.3706291064165762, 'weight_7': 0.8769663399885851, 'weight_8': 0.9677779432864883, 'weight_9': 0.1372661074222604}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:24,578] Trial 171 finished with value: 0.6816349742682996 and parameters: {'weight_0': 0.5881257765004424, 'weight_1': 0.238363159613402, 'weight_2': 0.9300502236252448, 'weight_3': 0.11893303758987277, 'weight_4': 0.7517234981449987, 'weight_5': 0.15195728292165472, 'weight_6': 0.3972811055430295, 'weight_7': 0.8828224339266769, 'weight_8': 0.9768731746184577, 'weight_9': 0.13384557002439382}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:25,060] Trial 172 finished with value: 0.6816126641324134 and parameters: {'weight_0': 0.5655639582370369, 'weight_1': 0.302612489280004, 'weight_2': 0.9899212204125737, 'weight_3': 0.1220739601907884, 'weight_4': 0.7488089542286115, 'weight_5': 0.14970841600255197, 'weight_6': 0.3634183405883912, 'weight_7': 0.8783281713439272, 'weight_8': 0.9686706352366732, 'weight_9': 0.07630303844501278}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:25,543] Trial 173 finished with value: 0.6816303186770359 and parameters: {'weight_0': 0.5446726246442888, 'weight_1': 0.24246964666463827, 'weight_2': 0.9431646673701999, 'weight_3': 0.12064621894655683, 'weight_4': 0.76930691660305, 'weight_5': 0.09759019429401591, 'weight_6': 0.3996313960411373, 'weight_7': 0.8707242722981612, 'weight_8': 0.969740238530635, 'weight_9': 0.11197575652256679}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:26,028] Trial 174 finished with value: 0.6816303953404564 and parameters: {'weight_0': 0.5331104918380762, 'weight_1': 0.24451960993496885, 'weight_2': 0.9482234529183926, 'weight_3': 0.11678122694757224, 'weight_4': 0.7623169087471466, 'weight_5': 0.12226017998860059, 'weight_6': 0.324317697148703, 'weight_7': 0.8720642832124815, 'weight_8': 0.979954008042537, 'weight_9': 0.10182705395068928}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:26,510] Trial 175 finished with value: 0.6816298854541646 and parameters: {'weight_0': 0.5366509374573011, 'weight_1': 0.24727360151170802, 'weight_2': 0.9495232933211415, 'weight_3': 0.11881698225768376, 'weight_4': 0.7755846118862109, 'weight_5': 0.10366520327775736, 'weight_6': 0.39622556103558404, 'weight_7': 0.8734585453294418, 'weight_8': 0.9667920022786218, 'weight_9': 0.10481130236137651}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:26,992] Trial 176 finished with value: 0.6816347662210764 and parameters: {'weight_0': 0.5358792904922632, 'weight_1': 0.24532219315437828, 'weight_2': 0.9366761713398768, 'weight_3': 0.11363034463898873, 'weight_4': 0.7842992234350118, 'weight_5': 0.0883074854189253, 'weight_6': 0.3283844104321709, 'weight_7': 0.8736284986090919, 'weight_8': 0.99876804223114, 'weight_9': 0.12932392404422216}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:27,476] Trial 177 finished with value: 0.6816350274929107 and parameters: {'weight_0': 0.5359543545125832, 'weight_1': 0.24991360125887382, 'weight_2': 0.9368530023782975, 'weight_3': 0.10738273398367154, 'weight_4': 0.7871243064905243, 'weight_5': 0.10782696774393305, 'weight_6': 0.3311999103939016, 'weight_7': 0.8730868806194804, 'weight_8': 0.9989444216122824, 'weight_9': 0.12975032263146852}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:27,962] Trial 178 finished with value: 0.6816262007449218 and parameters: {'weight_0': 0.538736305964195, 'weight_1': 0.27653605829899325, 'weight_2': 0.9358500910545379, 'weight_3': 0.11048171881613492, 'weight_4': 0.7767872410106209, 'weight_5': 0.08309497425014067, 'weight_6': 0.3213746327172222, 'weight_7': 0.8652750283015926, 'weight_8': 0.9742512910448405, 'weight_9': 0.12437718832035091}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:28,446] Trial 179 finished with value: 0.6816257576112454 and parameters: {'weight_0': 0.5133922805183395, 'weight_1': 0.2521365944481957, 'weight_2': 0.9360538640275208, 'weight_3': 0.0827679720512875, 'weight_4': 0.7792205560934425, 'weight_5': 0.09332246527342608, 'weight_6': 0.32138385744455583, 'weight_7': 0.8829960159750321, 'weight_8': 0.9995493834190255, 'weight_9': 0.13334965603853155}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:28,926] Trial 180 finished with value: 0.6816223414855063 and parameters: {'weight_0': 0.5429904104936089, 'weight_1': 0.2862543103801246, 'weight_2': 0.9799151896421652, 'weight_3': 0.11683789031615736, 'weight_4': 0.7765750170154978, 'weight_5': 0.12398274986740193, 'weight_6': 0.2933400189068446, 'weight_7': 0.8659557430100613, 'weight_8': 0.9755673455804119, 'weight_9': 0.11277517968001141}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:29,414] Trial 181 finished with value: 0.6816292788221539 and parameters: {'weight_0': 0.5305826133039211, 'weight_1': 0.2684462484119941, 'weight_2': 0.9412796890831567, 'weight_3': 0.10951459625062161, 'weight_4': 0.7976344204617373, 'weight_5': 0.0857592803994702, 'weight_6': 0.3374849851923672, 'weight_7': 0.8957378572255893, 'weight_8': 0.9772873300396195, 'weight_9': 0.15418074373388524}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:29,899] Trial 182 finished with value: 0.6816259846176431 and parameters: {'weight_0': 0.5212467086871264, 'weight_1': 0.2709046413992827, 'weight_2': 0.9441283928840428, 'weight_3': 0.11630713061618211, 'weight_4': 0.829387049401466, 'weight_5': 0.07577018389053891, 'weight_6': 0.3906737934708212, 'weight_7': 0.9002011303444828, 'weight_8': 0.9768202681277764, 'weight_9': 0.15466659236939495}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:30,381] Trial 183 finished with value: 0.6816250004456355 and parameters: {'weight_0': 0.5454654228857416, 'weight_1': 0.2468653559388939, 'weight_2': 0.9141370974342472, 'weight_3': 0.07320700031276425, 'weight_4': 0.7953639932604855, 'weight_5': 0.09907203431156993, 'weight_6': 0.3412489206195178, 'weight_7': 0.857648820696489, 'weight_8': 0.965431035154398, 'weight_9': 0.09307906800877232}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:30,866] Trial 184 finished with value: 0.6816315891867859 and parameters: {'weight_0': 0.5354578702497568, 'weight_1': 0.23290276000544016, 'weight_2': 0.9739518061124394, 'weight_3': 0.10067247613083426, 'weight_4': 0.7713370892329778, 'weight_5': 0.07466397998831464, 'weight_6': 0.36785521526666093, 'weight_7': 0.8806129768127688, 'weight_8': 0.9985168225226693, 'weight_9': 0.1275427504419337}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:31,352] Trial 185 finished with value: 0.681626743259461 and parameters: {'weight_0': 0.5408048305899714, 'weight_1': 0.23688912580108556, 'weight_2': 0.9692323533542649, 'weight_3': 0.10065246432630329, 'weight_4': 0.7755370983094572, 'weight_5': 0.07455723872561622, 'weight_6': 0.30993859835214466, 'weight_7': 0.875588491169676, 'weight_8': 0.9822710713078825, 'weight_9': 0.12719498774206195}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:31,856] Trial 186 finished with value: 0.6815982109676278 and parameters: {'weight_0': 0.49895889843370256, 'weight_1': 0.23715477369080226, 'weight_2': 0.9731487974356836, 'weight_3': 0.09588452957306882, 'weight_4': 0.8266388844343311, 'weight_5': 0.06087958964006527, 'weight_6': 0.2573927842836311, 'weight_7': 0.8919357677311054, 'weight_8': 0.9964835343131885, 'weight_9': 0.17285619470629546}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:32,342] Trial 187 finished with value: 0.6816247125718705 and parameters: {'weight_0': 0.5264621040178529, 'weight_1': 0.26085777460311504, 'weight_2': 0.9942692853133148, 'weight_3': 0.05390570858048231, 'weight_4': 0.7604224312463471, 'weight_5': 0.11839500884154251, 'weight_6': 0.3665340989491516, 'weight_7': 0.8821665678019184, 'weight_8': 0.9820535279978598, 'weight_9': 0.14952258316116396}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:32,824] Trial 188 finished with value: 0.6816274737147962 and parameters: {'weight_0': 0.5570134184601624, 'weight_1': 0.22701581547545113, 'weight_2': 0.9491037842068755, 'weight_3': 0.08134921025661408, 'weight_4': 0.7981691352449894, 'weight_5': 0.10469701669968712, 'weight_6': 0.2678044583303074, 'weight_7': 0.9016394860588643, 'weight_8': 0.9997364443300413, 'weight_9': 0.10644860760855845}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:33,336] Trial 189 finished with value: 0.6816293785588222 and parameters: {'weight_0': 0.5559809390604844, 'weight_1': 0.2340132384424644, 'weight_2': 0.9499632514448023, 'weight_3': 0.08170205509905352, 'weight_4': 0.7884751568396461, 'weight_5': 0.10380384605851775, 'weight_6': 0.263005965383979, 'weight_7': 0.9019165667764704, 'weight_8': 0.9609901029080313, 'weight_9': 0.10709606444386076}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:33,815] Trial 190 finished with value: 0.6816101013575944 and parameters: {'weight_0': 0.5560840539391444, 'weight_1': 0.33795206618329654, 'weight_2': 0.9517135221614998, 'weight_3': 0.07390339967312388, 'weight_4': 0.7958081160385058, 'weight_5': 0.13379460845298383, 'weight_6': 0.23398865765916516, 'weight_7': 0.9062316077220254, 'weight_8': 0.9990460131891135, 'weight_9': 0.1100702974235711}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:34,302] Trial 191 finished with value: 0.6816234130225275 and parameters: {'weight_0': 0.5132406247169745, 'weight_1': 0.23297877133705908, 'weight_2': 0.9723565271201099, 'weight_3': 0.08994752602755657, 'weight_4': 0.7398640847878845, 'weight_5': 0.10390571554497628, 'weight_6': 0.3966669990621005, 'weight_7': 0.8740032898727723, 'weight_8': 0.9620992980872036, 'weight_9': 0.1371729683764284}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:34,785] Trial 192 finished with value: 0.6816232987994324 and parameters: {'weight_0': 0.5635993378343908, 'weight_1': 0.24369271014753924, 'weight_2': 0.9015811081427799, 'weight_3': 0.10530835916874728, 'weight_4': 0.7729111918517717, 'weight_5': 0.07375291120737605, 'weight_6': 0.28482148311953664, 'weight_7': 0.9022039764704328, 'weight_8': 0.9781609215518977, 'weight_9': 0.06536971303770842}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:35,268] Trial 193 finished with value: 0.681630022247668 and parameters: {'weight_0': 0.5396803594757048, 'weight_1': 0.2203510244222158, 'weight_2': 0.9463666165339529, 'weight_3': 0.08123729988893855, 'weight_4': 0.7896592328279938, 'weight_5': 0.09495417585520531, 'weight_6': 0.34367927101455104, 'weight_7': 0.8578864198157264, 'weight_8': 0.957823121456235, 'weight_9': 0.10203626429695471}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:35,751] Trial 194 finished with value: 0.6816273414454114 and parameters: {'weight_0': 0.5230480858709246, 'weight_1': 0.21360595425878795, 'weight_2': 0.9214308510734701, 'weight_3': 0.06898037575324223, 'weight_4': 0.792541158658397, 'weight_5': 0.10506113994981883, 'weight_6': 0.3439089204792465, 'weight_7': 0.8541925825285608, 'weight_8': 0.9588741970831173, 'weight_9': 0.09925810498273806}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:36,237] Trial 195 finished with value: 0.6816073211180579 and parameters: {'weight_0': 0.5610841351473831, 'weight_1': 0.3043439362098742, 'weight_2': 0.9418418191674728, 'weight_3': 0.12114522102231105, 'weight_4': 0.7525269843106975, 'weight_5': 0.13395521243749448, 'weight_6': 0.38159991948167177, 'weight_7': 0.9174176223939976, 'weight_8': 0.9599831856012637, 'weight_9': 0.10120507740258766}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:36,723] Trial 196 finished with value: 0.6815947038108899 and parameters: {'weight_0': 0.5024627894201201, 'weight_1': 0.26982773919843456, 'weight_2': 0.996959892956619, 'weight_3': 0.053899116259953486, 'weight_4': 0.804171277895429, 'weight_5': 0.09589797615211262, 'weight_6': 0.3694788706767897, 'weight_7': 0.8934113927972245, 'weight_8': 0.9999381645487894, 'weight_9': 0.0672787117808716}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:37,257] Trial 197 finished with value: 0.6816217870487138 and parameters: {'weight_0': 0.5312824497109719, 'weight_1': 0.22531058056833214, 'weight_2': 0.9514232172295936, 'weight_3': 0.08526720495470383, 'weight_4': 0.7371611392518225, 'weight_5': 0.15242832176032212, 'weight_6': 0.26735221980686485, 'weight_7': 0.8512144965831356, 'weight_8': 0.9424189802873463, 'weight_9': 0.1445300244438795}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:38,024] Trial 198 finished with value: 0.6816334537661354 and parameters: {'weight_0': 0.579453753365655, 'weight_1': 0.255994010173873, 'weight_2': 0.9037477630529664, 'weight_3': 0.0824575789454503, 'weight_4': 0.8216833724821562, 'weight_5': 0.1132853689215304, 'weight_6': 0.39973333870109773, 'weight_7': 0.8773247703680378, 'weight_8': 0.9791966990389339, 'weight_9': 0.1652563074235965}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-25 22:38:38,804] Trial 199 finished with value: 0.6816428821452981 and parameters: {'weight_0': 0.5838129750161528, 'weight_1': 0.25821401949938105, 'weight_2': 0.8913472592846106, 'weight_3': 0.12239281944190293, 'weight_4': 0.8231864283445824, 'weight_5': 0.131614403105294, 'weight_6': 0.404922147491556, 'weight_7': 0.8383363096261871, 'weight_8': 0.9636258869755474, 'weight_9': 0.1645539577527941}. Best is trial 136 with value: 0.6816495372901298.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n",
      "Best Weights: {'weight_0': 0.6901144428219015, 'weight_1': 0.05021057852202565, 'weight_2': 0.6803936310941302, 'weight_3': 0.19702736088847292, 'weight_4': 0.7046359231920005, 'weight_5': 0.2177648390323163, 'weight_6': 0.5072122307537521, 'weight_7': 0.8355179160073518, 'weight_8': 0.8663200626565972, 'weight_9': 0.2572309277346851}\n",
      "Best AUC: 0.6816495372901298\n"
     ]
    }
   ],
   "source": [
    "import optuna\n",
    "# \n",
    "def objective(trial):\n",
    "    #  (0.01.0 )\n",
    "    weights = [trial.suggest_float(f'weight_{i}', 0.05, 1.0) for i in range(len(ranked_oof_preds))]\n",
    "\n",
    "    # 1\n",
    "    weights = np.array(weights)\n",
    "    weights /= np.sum(weights)\n",
    "\n",
    "    #  ()\n",
    "    ensemble_oof_preds = np.dot(weights, ranked_oof_preds)\n",
    "\n",
    "    curent_score = md.targets.validate_model(ensemble_oof_preds, 'Ensemble Model')\n",
    "\n",
    "    return curent_score  # \n",
    "\n",
    "# Optuna\n",
    "study = optuna.create_study(direction='maximize')  # AUC\n",
    "study.optimize(objective, n_trials=200)\n",
    "\n",
    "# \n",
    "print(\"Best Weights:\", study.best_params)\n",
    "print(\"Best AUC:\", study.best_value)\n",
    "\n",
    "CFG.weights = [1 for _ in range(len(ranked_oof_preds))]\n",
    "np.array(CFG.weights)\n",
    "\n",
    "for i in range(len(CFG.weights)):\n",
    "    CFG.weights[i] = study.best_params[f'weight_{i}']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "727ef54d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:38.894337Z",
     "iopub.status.busy": "2025-02-25T22:38:38.893962Z",
     "iopub.status.idle": "2025-02-25T22:38:38.900065Z",
     "shell.execute_reply": "2025-02-25T22:38:38.898971Z"
    },
    "papermill": {
     "duration": 0.048704,
     "end_time": "2025-02-25T22:38:38.902596",
     "exception": false,
     "start_time": "2025-02-25T22:38:38.853892",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# ensemble_oof_preds = np.sum([w * p for w, p in zip(CFG.weights, ranked_oof_preds)], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "9d5d86cf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:38.988945Z",
     "iopub.status.busy": "2025-02-25T22:38:38.988527Z",
     "iopub.status.idle": "2025-02-25T22:38:38.994373Z",
     "shell.execute_reply": "2025-02-25T22:38:38.993235Z"
    },
    "papermill": {
     "duration": 0.048362,
     "end_time": "2025-02-25T22:38:38.996426",
     "exception": false,
     "start_time": "2025-02-25T22:38:38.948064",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# y_true = train_data[['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "# y_pred = train_data[['ID']].copy()\n",
    "        \n",
    "# y_pred['prediction'] = ensemble_oof_preds\n",
    "            \n",
    "# c_index_score = score(y_true.copy(), y_pred.copy(), 'ID')\n",
    "# print(f'\\nOverall C-Index for Ensemble model: {c_index_score:.3f}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f50575c1",
   "metadata": {
    "papermill": {
     "duration": 0.038496,
     "end_time": "2025-02-25T22:38:39.076067",
     "exception": false,
     "start_time": "2025-02-25T22:38:39.037571",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<div style=\"background-color: rgb(247, 230, 202); border: 4px solid rgb(162, 87, 79); border-radius: 40px; padding: 20px; font-family: 'Roboto'; color: rgb(162, 87, 79); text-align: left; font-size: 140%;\">\n",
    "    <b>Ensemble predictions for the test data.</b>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "38fd92cd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:39.156022Z",
     "iopub.status.busy": "2025-02-25T22:38:39.155071Z",
     "iopub.status.idle": "2025-02-25T22:38:39.161433Z",
     "shell.execute_reply": "2025-02-25T22:38:39.160460Z"
    },
    "papermill": {
     "duration": 0.048362,
     "end_time": "2025-02-25T22:38:39.163448",
     "exception": false,
     "start_time": "2025-02-25T22:38:39.115086",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "preds = [\n",
    "    ctb1_preds, \n",
    "    lgb1_preds, \n",
    "    ctb2_preds, \n",
    "    lgb2_preds, \n",
    "    ctb3_preds, \n",
    "    lgb3_preds,\n",
    "    cox1_preds,\n",
    "    cox2_preds,\n",
    "    # ctb5_preds, \n",
    "    # lgb5_preds,\n",
    "    ctb6_preds, \n",
    "    lgb6_preds,\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "f1de8dad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:39.244190Z",
     "iopub.status.busy": "2025-02-25T22:38:39.243803Z",
     "iopub.status.idle": "2025-02-25T22:38:39.252243Z",
     "shell.execute_reply": "2025-02-25T22:38:39.251152Z"
    },
    "papermill": {
     "duration": 0.050636,
     "end_time": "2025-02-25T22:38:39.254302",
     "exception": false,
     "start_time": "2025-02-25T22:38:39.203666",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ranked_preds = np.array([rankdata(p) for p in preds])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "018cd0e4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:39.332443Z",
     "iopub.status.busy": "2025-02-25T22:38:39.332049Z",
     "iopub.status.idle": "2025-02-25T22:38:39.337534Z",
     "shell.execute_reply": "2025-02-25T22:38:39.336568Z"
    },
    "papermill": {
     "duration": 0.046731,
     "end_time": "2025-02-25T22:38:39.339502",
     "exception": false,
     "start_time": "2025-02-25T22:38:39.292771",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ensemble_preds = np.sum([w * p for w, p in zip(CFG.weights, ranked_preds)], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "8afb9cf0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:39.418231Z",
     "iopub.status.busy": "2025-02-25T22:38:39.417388Z",
     "iopub.status.idle": "2025-02-25T22:38:39.429252Z",
     "shell.execute_reply": "2025-02-25T22:38:39.428205Z"
    },
    "papermill": {
     "duration": 0.053611,
     "end_time": "2025-02-25T22:38:39.431565",
     "exception": false,
     "start_time": "2025-02-25T22:38:39.377954",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "subm_data = pd.read_csv(CFG.subm_path)\n",
    "subm_data['prediction'] = ensemble_preds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "f1253212",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-25T22:38:39.511497Z",
     "iopub.status.busy": "2025-02-25T22:38:39.510574Z",
     "iopub.status.idle": "2025-02-25T22:38:39.523233Z",
     "shell.execute_reply": "2025-02-25T22:38:39.522264Z"
    },
    "papermill": {
     "duration": 0.05447,
     "end_time": "2025-02-25T22:38:39.525148",
     "exception": false,
     "start_time": "2025-02-25T22:38:39.470678",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>prediction</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>28800</td>\n",
       "      <td>10.012856</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>28801</td>\n",
       "      <td>15.019284</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28802</td>\n",
       "      <td>5.006428</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      ID  prediction\n",
       "0  28800   10.012856\n",
       "1  28801   15.019284\n",
       "2  28802    5.006428"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "subm_data.to_csv('submission.csv', index=False)\n",
    "display(subm_data.head())"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 10381525,
     "sourceId": 70942,
     "sourceType": "competition"
    },
    {
     "sourceId": 211253469,
     "sourceType": "kernelVersion"
    },
    {
     "sourceId": 211322530,
     "sourceType": "kernelVersion"
    }
   ],
   "dockerImageVersionId": 30804,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 32715.166864,
   "end_time": "2025-02-25T22:38:40.988885",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-02-25T13:33:25.822021",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
