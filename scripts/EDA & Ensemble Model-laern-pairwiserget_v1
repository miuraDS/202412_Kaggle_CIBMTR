{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "389519e4",
   "metadata": {
    "papermill": {
     "duration": 0.012901,
     "end_time": "2025-03-02T02:16:23.150172",
     "exception": false,
     "start_time": "2025-03-02T02:16:23.137271",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Introduction</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e7115f54",
   "metadata": {
    "papermill": {
     "duration": 0.01042,
     "end_time": "2025-03-02T02:16:23.173658",
     "exception": false,
     "start_time": "2025-03-02T02:16:23.163238",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<div style=\"background-color: rgb(247, 230, 202); border: 4px solid rgb(162, 87, 79); border-radius: 40px; padding: 20px; font-family: 'Roboto'; color: rgb(162, 87, 79); text-align: left; font-size: 120%;\">\n",
    "    <ul style=\"list-style-type: square; padding-left: 20px;\">\n",
    "        <li>Missing values are replaced with:\n",
    "            <ul style=\"list-style-type: circle; margin-top: 10px; margin-bottom: 10px;\">\n",
    "                <li>-1 for numeric columns</li>\n",
    "                <li>Unknown for categorical columns</li>\n",
    "            </ul>\n",
    "        </li>\n",
    "        <li style=\"margin-top: 10px;\">\n",
    "            LightGBM and CatBoost are trained on 3 different targets, estimated from the survival models:\n",
    "            <ul style=\"list-style-type: circle; margin-top: 10px; margin-bottom: 10px;\">\n",
    "                <li>Cox</li>\n",
    "                <li>Kaplan-Meier</li>\n",
    "                <li>Nelson-Aalen</li>\n",
    "            </ul>\n",
    "        </li>\n",
    "        <li style=\"margin-top: 10px;\">Two additional CatBoost model are trained, with Cox loss function.</li>\n",
    "        <li style=\"margin-top: 10px;\">As per <a href=\"https://www.kaggle.com/competitions/equity-post-HCT-survival-predictions/discussion/553061\" style=\"color: #A2574F; text-decoration: underline;\">this</a> discussion post, the target is consisted of the Out-of-Fold predictions of the survival models on the validation folds to prevent target leakage.</li>\n",
    "        <li style=\"margin-top: 10px;\">\n",
    "            The ensemble prediction for each sample is computed as:\n",
    "            <ul style=\"list-style-type: circle; margin-top: 10px; margin-bottom: 10px;\">\n",
    "                <p style=\"margin-top: 10px; font-size: 110%; color: #A2574F; font-family: 'Roboto'; text-align: left;\">\n",
    "                    $ \\text{preds}_{\\text{ensemble}} = \\sum_{i=1}^{n} w_i \\cdot \\text{rankdata}(\\text{preds}_i) $\n",
    "                </p>\n",
    "                where $n$ is the number of models, $w_i$ is the weight assigned to the $i$-th model, and $\\text{rankdata}(\\text{preds}_i)$ is the rank of predictions from the $i$-th model.\n",
    "            </ul>\n",
    "        </li>\n",
    "        <li style=\"margin-top: 10px;\">Last but not least, since the competition metrics evaluates only the order of predictions and not their magnitude, the model weights are not required to add up to 1, nor should the predictions fall within a predefined range.</li>\n",
    "    </ul>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b5c2d6fc",
   "metadata": {
    "papermill": {
     "duration": 0.010201,
     "end_time": "2025-03-02T02:16:23.194589",
     "exception": false,
     "start_time": "2025-03-02T02:16:23.184388",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Install Libraries</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "028c21f6",
   "metadata": {
    "_kg_hide-output": true,
    "execution": {
     "iopub.execute_input": "2025-03-02T02:16:23.217808Z",
     "iopub.status.busy": "2025-03-02T02:16:23.217330Z",
     "iopub.status.idle": "2025-03-02T02:20:01.895080Z",
     "shell.execute_reply": "2025-03-02T02:20:01.893504Z"
    },
    "papermill": {
     "duration": 218.693089,
     "end_time": "2025-03-02T02:20:01.898212",
     "exception": false,
     "start_time": "2025-03-02T02:16:23.205123",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Processing /kaggle/input/pip-install-lifelines/autograd-1.7.0-py3-none-any.whl\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from autograd==1.7.0) (1.26.4)\r\n",
      "Installing collected packages: autograd\r\n",
      "Successfully installed autograd-1.7.0\r\n",
      "Processing /kaggle/input/pip-install-lifelines/autograd-gamma-0.5.0.tar.gz\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l-\b \bdone\r\n",
      "\u001b[?25hRequirement already satisfied: autograd>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from autograd-gamma==0.5.0) (1.7.0)\r\n",
      "Requirement already satisfied: scipy>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from autograd-gamma==0.5.0) (1.14.1)\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from autograd>=1.2.0->autograd-gamma==0.5.0) (1.26.4)\r\n",
      "Building wheels for collected packages: autograd-gamma\r\n",
      "  Building wheel for autograd-gamma (setup.py) ... \u001b[?25l-\b \b\\\b \bdone\r\n",
      "\u001b[?25h  Created wheel for autograd-gamma: filename=autograd_gamma-0.5.0-py3-none-any.whl size=4030 sha256=0523cb7d818663f68162e050fb39c88b151a85d17981f14146a1adf07e68e45a\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/6b/b5/e0/4c79e15c0b5f2c15ecf613c720bb20daab20a666eb67135155\r\n",
      "Successfully built autograd-gamma\r\n",
      "Installing collected packages: autograd-gamma\r\n",
      "Successfully installed autograd-gamma-0.5.0\r\n",
      "Processing /kaggle/input/pip-install-lifelines/interface_meta-1.3.0-py3-none-any.whl\r\n",
      "Installing collected packages: interface-meta\r\n",
      "Successfully installed interface-meta-1.3.0\r\n",
      "Processing /kaggle/input/pip-install-lifelines/formulaic-1.0.2-py3-none-any.whl\r\n",
      "Requirement already satisfied: interface-meta>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.3.0)\r\n",
      "Requirement already satisfied: numpy>=1.16.5 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.26.4)\r\n",
      "Requirement already satisfied: pandas>=1.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (2.2.3)\r\n",
      "Requirement already satisfied: scipy>=1.6 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.14.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (4.12.2)\r\n",
      "Requirement already satisfied: wrapt>=1.0 in /opt/conda/lib/python3.10/site-packages (from formulaic==1.0.2) (1.16.0)\r\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /opt/conda/lib/python3.10/site-packages (from pandas>=1.0->formulaic==1.0.2) (2.9.0.post0)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas>=1.0->formulaic==1.0.2) (2024.1)\r\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas>=1.0->formulaic==1.0.2) (2024.1)\r\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas>=1.0->formulaic==1.0.2) (1.16.0)\r\n",
      "Installing collected packages: formulaic\r\n",
      "Successfully installed formulaic-1.0.2\r\n",
      "Processing /kaggle/input/pip-install-lifelines/lifelines-0.30.0-py3-none-any.whl\r\n",
      "Requirement already satisfied: numpy>=1.14.0 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.26.4)\r\n",
      "Requirement already satisfied: scipy>=1.7.0 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.14.1)\r\n",
      "Requirement already satisfied: pandas>=2.1 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (2.2.3)\r\n",
      "Requirement already satisfied: matplotlib>=3.0 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (3.7.5)\r\n",
      "Requirement already satisfied: autograd>=1.5 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.7.0)\r\n",
      "Requirement already satisfied: autograd-gamma>=0.3 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (0.5.0)\r\n",
      "Requirement already satisfied: formulaic>=0.2.2 in /opt/conda/lib/python3.10/site-packages (from lifelines==0.30.0) (1.0.2)\r\n",
      "Requirement already satisfied: interface-meta>=1.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic>=0.2.2->lifelines==0.30.0) (1.3.0)\r\n",
      "Requirement already satisfied: typing-extensions>=4.2.0 in /opt/conda/lib/python3.10/site-packages (from formulaic>=0.2.2->lifelines==0.30.0) (4.12.2)\r\n",
      "Requirement already satisfied: wrapt>=1.0 in /opt/conda/lib/python3.10/site-packages (from formulaic>=0.2.2->lifelines==0.30.0) (1.16.0)\r\n",
      "Requirement already satisfied: contourpy>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (1.2.1)\r\n",
      "Requirement already satisfied: cycler>=0.10 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (0.12.1)\r\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (4.53.0)\r\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (1.4.5)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (21.3)\r\n",
      "Requirement already satisfied: pillow>=6.2.0 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (10.3.0)\r\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (3.1.2)\r\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /opt/conda/lib/python3.10/site-packages (from matplotlib>=3.0->lifelines==0.30.0) (2.9.0.post0)\r\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.1->lifelines==0.30.0) (2024.1)\r\n",
      "Requirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas>=2.1->lifelines==0.30.0) (2024.1)\r\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib>=3.0->lifelines==0.30.0) (1.16.0)\r\n",
      "Installing collected packages: lifelines\r\n",
      "Successfully installed lifelines-0.30.0\r\n"
     ]
    }
   ],
   "source": [
    "!pip install /kaggle/input/pip-install-lifelines/autograd-1.7.0-py3-none-any.whl\n",
    "!pip install /kaggle/input/pip-install-lifelines/autograd-gamma-0.5.0.tar.gz\n",
    "!pip install /kaggle/input/pip-install-lifelines/interface_meta-1.3.0-py3-none-any.whl\n",
    "!pip install /kaggle/input/pip-install-lifelines/formulaic-1.0.2-py3-none-any.whl\n",
    "!pip install /kaggle/input/pip-install-lifelines/lifelines-0.30.0-py3-none-any.whl"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e7a1740d",
   "metadata": {
    "papermill": {
     "duration": 0.012459,
     "end_time": "2025-03-02T02:20:01.924436",
     "exception": false,
     "start_time": "2025-03-02T02:20:01.911977",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Imports</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "67e57d72",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:01.952242Z",
     "iopub.status.busy": "2025-03-02T02:20:01.951708Z",
     "iopub.status.idle": "2025-03-02T02:20:01.957935Z",
     "shell.execute_reply": "2025-03-02T02:20:01.956655Z"
    },
    "papermill": {
     "duration": 0.023142,
     "end_time": "2025-03-02T02:20:01.960291",
     "exception": false,
     "start_time": "2025-03-02T02:20:01.937149",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import warnings\n",
    "from pathlib import Path\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cdc1e258",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:01.987230Z",
     "iopub.status.busy": "2025-03-02T02:20:01.986844Z",
     "iopub.status.idle": "2025-03-02T02:20:03.910469Z",
     "shell.execute_reply": "2025-03-02T02:20:03.909237Z"
    },
    "papermill": {
     "duration": 1.940352,
     "end_time": "2025-03-02T02:20:03.913189",
     "exception": false,
     "start_time": "2025-03-02T02:20:01.972837",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import polars as pl\n",
    "import pandas as pd\n",
    "import plotly.colors as pc\n",
    "import plotly.express as px\n",
    "import plotly.graph_objects as go"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "52b77c72",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:03.941584Z",
     "iopub.status.busy": "2025-03-02T02:20:03.940913Z",
     "iopub.status.idle": "2025-03-02T02:20:04.107798Z",
     "shell.execute_reply": "2025-03-02T02:20:04.106476Z"
    },
    "papermill": {
     "duration": 0.183733,
     "end_time": "2025-03-02T02:20:04.110531",
     "exception": false,
     "start_time": "2025-03-02T02:20:03.926798",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import plotly.io as pio\n",
    "pio.renderers.default = 'iframe'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "73b071b9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:04.137759Z",
     "iopub.status.busy": "2025-03-02T02:20:04.137337Z",
     "iopub.status.idle": "2025-03-02T02:20:04.143195Z",
     "shell.execute_reply": "2025-03-02T02:20:04.142049Z"
    },
    "papermill": {
     "duration": 0.021974,
     "end_time": "2025-03-02T02:20:04.145338",
     "exception": false,
     "start_time": "2025-03-02T02:20:04.123364",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "pd.options.display.max_columns = None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "78e1f728",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:04.172209Z",
     "iopub.status.busy": "2025-03-02T02:20:04.171787Z",
     "iopub.status.idle": "2025-03-02T02:20:07.379374Z",
     "shell.execute_reply": "2025-03-02T02:20:07.378299Z"
    },
    "papermill": {
     "duration": 3.224228,
     "end_time": "2025-03-02T02:20:07.382165",
     "exception": false,
     "start_time": "2025-03-02T02:20:04.157937",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import lightgbm as lgb\n",
    "from metric import score\n",
    "from scipy.stats import rankdata \n",
    "from catboost import CatBoostRegressor\n",
    "from sklearn.model_selection import KFold\n",
    "from lifelines import CoxPHFitter, KaplanMeierFitter, NelsonAalenFitter"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "12e803cb",
   "metadata": {
    "papermill": {
     "duration": 0.012418,
     "end_time": "2025-03-02T02:20:07.407519",
     "exception": false,
     "start_time": "2025-03-02T02:20:07.395101",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Configuration</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "56aa1573",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:07.435738Z",
     "iopub.status.busy": "2025-03-02T02:20:07.434520Z",
     "iopub.status.idle": "2025-03-02T02:20:07.445018Z",
     "shell.execute_reply": "2025-03-02T02:20:07.443693Z"
    },
    "papermill": {
     "duration": 0.027162,
     "end_time": "2025-03-02T02:20:07.447387",
     "exception": false,
     "start_time": "2025-03-02T02:20:07.420225",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class CFG:\n",
    "\n",
    "    train_path = Path('/kaggle/input/equity-post-HCT-survival-predictions/train.csv')\n",
    "    test_path = Path('/kaggle/input/equity-post-HCT-survival-predictions/test.csv')\n",
    "    subm_path = Path('/kaggle/input/equity-post-HCT-survival-predictions/sample_submission.csv')\n",
    "\n",
    "    color = '#A2574F'\n",
    "\n",
    "    batch_size = 32768\n",
    "    early_stop = 300\n",
    "    penalizer = 0.01\n",
    "    n_splits = 5\n",
    "\n",
    "    weights = [1.0, 1.0, 8.0, 4.0, 8.0, 4.0, 6.0, 6.0]\n",
    "\n",
    "    ctb_params = {\n",
    "        'loss_function': 'RMSE',\n",
    "        'learning_rate': 0.03,\n",
    "        'random_state': 42,\n",
    "        'task_type': 'CPU',\n",
    "        'num_trees': 6000,\n",
    "        'subsample': 0.85,\n",
    "        'reg_lambda': 8.0,\n",
    "        'depth': 8\n",
    "    }\n",
    "\n",
    "    lgb_params = {\n",
    "        'objective': 'regression',\n",
    "        'min_child_samples': 32,\n",
    "        'num_iterations': 6000,\n",
    "        'learning_rate': 0.03,\n",
    "        'extra_trees': True,\n",
    "        'reg_lambda': 8.0,\n",
    "        'reg_alpha': 0.1,\n",
    "        'num_leaves': 64,\n",
    "        'metric': 'rmse',\n",
    "        'max_depth': 8,\n",
    "        'device': 'cpu',\n",
    "        'max_bin': 128,\n",
    "        'verbose': -1,\n",
    "        'seed': 42\n",
    "    }\n",
    "\n",
    "    # Parameters of the first CatBoost model with Cox loss function\n",
    "    cox1_params = {\n",
    "        'grow_policy': 'Depthwise',\n",
    "        'min_child_samples': 8,\n",
    "        'loss_function': 'Cox',\n",
    "        'learning_rate': 0.03,\n",
    "        'random_state': 42,\n",
    "        'task_type': 'CPU',\n",
    "        'num_trees': 6000,\n",
    "        'subsample': 0.85,\n",
    "        'reg_lambda': 8.0,\n",
    "        'depth': 8\n",
    "    }\n",
    "\n",
    "    # Parameters of the second CatBoost model with Cox loss function\n",
    "    cox2_params = {\n",
    "        'grow_policy': 'Lossguide',\n",
    "        'loss_function': 'Cox',\n",
    "        'learning_rate': 0.03,\n",
    "        'random_state': 42,\n",
    "        'task_type': 'CPU',\n",
    "        'num_trees': 6000,\n",
    "        'subsample': 0.85,\n",
    "        'reg_lambda': 8.0,\n",
    "        'num_leaves': 32,\n",
    "        'depth': 8\n",
    "    }"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ef7d203",
   "metadata": {
    "papermill": {
     "duration": 0.013992,
     "end_time": "2025-03-02T02:20:07.475155",
     "exception": false,
     "start_time": "2025-03-02T02:20:07.461163",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Feature Engineering</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "0fd9ba53",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:07.502914Z",
     "iopub.status.busy": "2025-03-02T02:20:07.502425Z",
     "iopub.status.idle": "2025-03-02T02:20:07.514316Z",
     "shell.execute_reply": "2025-03-02T02:20:07.513158Z"
    },
    "papermill": {
     "duration": 0.028466,
     "end_time": "2025-03-02T02:20:07.516576",
     "exception": false,
     "start_time": "2025-03-02T02:20:07.488110",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class FE:\n",
    "\n",
    "    def __init__(self, batch_size):\n",
    "        self.batch_size = batch_size\n",
    "\n",
    "    def load_data(self, path):\n",
    "\n",
    "        return pl.read_csv(path, batch_size=self.batch_size)\n",
    "\n",
    "    def cast_datatypes(self, df):\n",
    "\n",
    "        num_cols = [\n",
    "            'hla_high_res_8',\n",
    "            'hla_low_res_8',\n",
    "            'hla_high_res_6',\n",
    "            'hla_low_res_6',\n",
    "            'hla_high_res_10',\n",
    "            'hla_low_res_10',\n",
    "            'hla_match_dqb1_high',\n",
    "            'hla_match_dqb1_low',\n",
    "            'hla_match_drb1_high',\n",
    "            'hla_match_drb1_low',\n",
    "            'hla_nmdp_6',\n",
    "            'year_hct',\n",
    "            'hla_match_a_high',\n",
    "            'hla_match_a_low',\n",
    "            'hla_match_b_high',\n",
    "            'hla_match_b_low',\n",
    "            'hla_match_c_high',\n",
    "            'hla_match_c_low',\n",
    "            'donor_age',\n",
    "            'age_at_hct',\n",
    "            'comorbidity_score',\n",
    "            'karnofsky_score',\n",
    "            'efs',\n",
    "            'efs_time'\n",
    "        ]\n",
    "\n",
    "        for col in df.columns:\n",
    "\n",
    "            if col in num_cols:\n",
    "                df = df.with_columns(pl.col(col).fill_null(-1).cast(pl.Float32))  \n",
    "\n",
    "            else:\n",
    "                df = df.with_columns(pl.col(col).fill_null('Unknown').cast(pl.String))  \n",
    "\n",
    "        return df.with_columns(pl.col('ID').cast(pl.Int32))\n",
    "\n",
    "    def info(self, df):\n",
    "        \n",
    "        print(f'\\nShape of dataframe: {df.shape}') \n",
    "        \n",
    "        mem = df.memory_usage().sum() / 1024**2\n",
    "        print('Memory usage: {:.2f} MB\\n'.format(mem))\n",
    "\n",
    "        display(df.head())\n",
    "\n",
    "    def apply_fe(self, path):\n",
    "\n",
    "        df = self.load_data(path)\n",
    "        df = self.cast_datatypes(df)\n",
    "        df = df.to_pandas()\n",
    "\n",
    "        self.info(df)\n",
    "        \n",
    "        cat_cols = [col for col in df.columns if df[col].dtype == pl.String]\n",
    "\n",
    "        return df, cat_cols"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "66b202ec",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:07.543587Z",
     "iopub.status.busy": "2025-03-02T02:20:07.543117Z",
     "iopub.status.idle": "2025-03-02T02:20:07.548535Z",
     "shell.execute_reply": "2025-03-02T02:20:07.547534Z"
    },
    "papermill": {
     "duration": 0.021394,
     "end_time": "2025-03-02T02:20:07.550535",
     "exception": false,
     "start_time": "2025-03-02T02:20:07.529141",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "fe = FE(CFG.batch_size)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "298148f0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:07.577394Z",
     "iopub.status.busy": "2025-03-02T02:20:07.576353Z",
     "iopub.status.idle": "2025-03-02T02:20:08.322924Z",
     "shell.execute_reply": "2025-03-02T02:20:08.321790Z"
    },
    "papermill": {
     "duration": 0.762484,
     "end_time": "2025-03-02T02:20:08.325190",
     "exception": false,
     "start_time": "2025-03-02T02:20:07.562706",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Shape of dataframe: (28800, 60)\n",
      "Memory usage: 10.44 MB\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>dri_score</th>\n",
       "      <th>psych_disturb</th>\n",
       "      <th>cyto_score</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>hla_match_c_high</th>\n",
       "      <th>hla_high_res_8</th>\n",
       "      <th>tbi_status</th>\n",
       "      <th>arrhythmia</th>\n",
       "      <th>hla_low_res_6</th>\n",
       "      <th>graft_type</th>\n",
       "      <th>vent_hist</th>\n",
       "      <th>renal_issue</th>\n",
       "      <th>pulm_severe</th>\n",
       "      <th>prim_disease_hct</th>\n",
       "      <th>hla_high_res_6</th>\n",
       "      <th>cmv_status</th>\n",
       "      <th>hla_high_res_10</th>\n",
       "      <th>hla_match_dqb1_high</th>\n",
       "      <th>tce_imm_match</th>\n",
       "      <th>hla_nmdp_6</th>\n",
       "      <th>hla_match_c_low</th>\n",
       "      <th>rituximab</th>\n",
       "      <th>hla_match_drb1_low</th>\n",
       "      <th>hla_match_dqb1_low</th>\n",
       "      <th>prod_type</th>\n",
       "      <th>cyto_score_detail</th>\n",
       "      <th>conditioning_intensity</th>\n",
       "      <th>ethnicity</th>\n",
       "      <th>year_hct</th>\n",
       "      <th>obesity</th>\n",
       "      <th>mrd_hct</th>\n",
       "      <th>in_vivo_tcd</th>\n",
       "      <th>tce_match</th>\n",
       "      <th>hla_match_a_high</th>\n",
       "      <th>hepatic_severe</th>\n",
       "      <th>donor_age</th>\n",
       "      <th>prior_tumor</th>\n",
       "      <th>hla_match_b_low</th>\n",
       "      <th>peptic_ulcer</th>\n",
       "      <th>age_at_hct</th>\n",
       "      <th>hla_match_a_low</th>\n",
       "      <th>gvhd_proph</th>\n",
       "      <th>rheum_issue</th>\n",
       "      <th>sex_match</th>\n",
       "      <th>hla_match_b_high</th>\n",
       "      <th>race_group</th>\n",
       "      <th>comorbidity_score</th>\n",
       "      <th>karnofsky_score</th>\n",
       "      <th>hepatic_mild</th>\n",
       "      <th>tce_div_match</th>\n",
       "      <th>donor_related</th>\n",
       "      <th>melphalan_dose</th>\n",
       "      <th>hla_low_res_8</th>\n",
       "      <th>cardiac</th>\n",
       "      <th>hla_match_drb1_high</th>\n",
       "      <th>pulm_moderate</th>\n",
       "      <th>hla_low_res_10</th>\n",
       "      <th>efs</th>\n",
       "      <th>efs_time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>IEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2016.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>9.942000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FKalone</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>42.355999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>TBI +- Other, &gt;cGy</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>AML</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2008.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>72.290001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.705002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Other GVHD Prophylaxis</td>\n",
       "      <td>No</td>\n",
       "      <td>F-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Asian</td>\n",
       "      <td>3.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.672000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>HIS</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2019.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>33.997002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Cyclophosphamide alone</td>\n",
       "      <td>No</td>\n",
       "      <td>F-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19.792999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>ALL</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2009.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.230000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.244999</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FK+ MMF +- others</td>\n",
       "      <td>No</td>\n",
       "      <td>M-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>White</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>102.348999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>MPN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Hispanic or Latino</td>\n",
       "      <td>2018.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>56.810001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.740000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>TDEPLETION +- other</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>American Indian or Alaska Native</td>\n",
       "      <td>1.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>MEL</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.223000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   ID                       dri_score psych_disturb    cyto_score diabetes  \\\n",
       "0   0  N/A - non-malignant indication            No       Unknown       No   \n",
       "1   1                    Intermediate            No  Intermediate       No   \n",
       "2   2  N/A - non-malignant indication            No       Unknown       No   \n",
       "3   3                            High            No  Intermediate       No   \n",
       "4   4                            High            No       Unknown       No   \n",
       "\n",
       "   hla_match_c_high  hla_high_res_8          tbi_status arrhythmia  \\\n",
       "0              -1.0            -1.0              No TBI         No   \n",
       "1               2.0             8.0  TBI +- Other, >cGy         No   \n",
       "2               2.0             8.0              No TBI         No   \n",
       "3               2.0             8.0              No TBI         No   \n",
       "4               2.0             8.0              No TBI         No   \n",
       "\n",
       "   hla_low_res_6        graft_type vent_hist renal_issue pulm_severe  \\\n",
       "0            6.0       Bone marrow        No          No          No   \n",
       "1            6.0  Peripheral blood        No          No          No   \n",
       "2            6.0       Bone marrow        No          No          No   \n",
       "3            6.0       Bone marrow        No          No          No   \n",
       "4            6.0  Peripheral blood        No          No          No   \n",
       "\n",
       "  prim_disease_hct  hla_high_res_6 cmv_status  hla_high_res_10  \\\n",
       "0              IEA             6.0        +/+             -1.0   \n",
       "1              AML             6.0        +/+             10.0   \n",
       "2              HIS             6.0        +/+             10.0   \n",
       "3              ALL             6.0        +/+             10.0   \n",
       "4              MPN             6.0        +/+             10.0   \n",
       "\n",
       "   hla_match_dqb1_high tce_imm_match  hla_nmdp_6  hla_match_c_low rituximab  \\\n",
       "0                  2.0       Unknown         6.0              2.0        No   \n",
       "1                  2.0           P/P         6.0              2.0        No   \n",
       "2                  2.0           P/P         6.0              2.0        No   \n",
       "3                  2.0           P/P         6.0              2.0        No   \n",
       "4                  2.0       Unknown         5.0              2.0        No   \n",
       "\n",
       "   hla_match_drb1_low  hla_match_dqb1_low prod_type cyto_score_detail  \\\n",
       "0                 2.0                 2.0        BM           Unknown   \n",
       "1                 2.0                 2.0        PB      Intermediate   \n",
       "2                 2.0                 2.0        BM           Unknown   \n",
       "3                 2.0                 2.0        BM      Intermediate   \n",
       "4                 2.0                 2.0        PB           Unknown   \n",
       "\n",
       "  conditioning_intensity               ethnicity  year_hct obesity   mrd_hct  \\\n",
       "0                Unknown  Not Hispanic or Latino    2016.0      No   Unknown   \n",
       "1                    MAC  Not Hispanic or Latino    2008.0      No  Positive   \n",
       "2                Unknown  Not Hispanic or Latino    2019.0      No   Unknown   \n",
       "3                    MAC  Not Hispanic or Latino    2009.0      No  Positive   \n",
       "4                    MAC      Hispanic or Latino    2018.0      No   Unknown   \n",
       "\n",
       "  in_vivo_tcd   tce_match  hla_match_a_high hepatic_severe  donor_age  \\\n",
       "0         Yes     Unknown               2.0             No  -1.000000   \n",
       "1          No  Permissive               2.0             No  72.290001   \n",
       "2         Yes     Unknown               2.0             No  -1.000000   \n",
       "3          No  Permissive               2.0             No  29.230000   \n",
       "4         Yes     Unknown               2.0             No  56.810001   \n",
       "\n",
       "  prior_tumor  hla_match_b_low peptic_ulcer  age_at_hct  hla_match_a_low  \\\n",
       "0          No              2.0           No    9.942000              2.0   \n",
       "1          No              2.0           No   43.705002              2.0   \n",
       "2          No              2.0           No   33.997002              2.0   \n",
       "3          No              2.0           No   43.244999              2.0   \n",
       "4          No              2.0           No   29.740000              2.0   \n",
       "\n",
       "               gvhd_proph rheum_issue sex_match  hla_match_b_high  \\\n",
       "0                 FKalone          No       M-F               2.0   \n",
       "1  Other GVHD Prophylaxis          No       F-F               2.0   \n",
       "2  Cyclophosphamide alone          No       F-M               2.0   \n",
       "3       FK+ MMF +- others          No       M-M               2.0   \n",
       "4     TDEPLETION +- other          No       M-F               2.0   \n",
       "\n",
       "                         race_group  comorbidity_score  karnofsky_score  \\\n",
       "0                More than one race                0.0             90.0   \n",
       "1                             Asian                3.0             90.0   \n",
       "2                More than one race                0.0             90.0   \n",
       "3                             White                0.0             90.0   \n",
       "4  American Indian or Alaska Native                1.0             90.0   \n",
       "\n",
       "  hepatic_mild          tce_div_match donor_related      melphalan_dose  \\\n",
       "0           No                Unknown     Unrelated  N/A, Mel not given   \n",
       "1           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "2           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "3          Yes  Permissive mismatched     Unrelated  N/A, Mel not given   \n",
       "4           No  Permissive mismatched       Related                 MEL   \n",
       "\n",
       "   hla_low_res_8 cardiac  hla_match_drb1_high pulm_moderate  hla_low_res_10  \\\n",
       "0            8.0      No                  2.0            No            10.0   \n",
       "1            8.0      No                  2.0           Yes            10.0   \n",
       "2            8.0      No                  2.0            No            10.0   \n",
       "3            8.0      No                  2.0            No            10.0   \n",
       "4            8.0      No                  2.0            No            10.0   \n",
       "\n",
       "   efs    efs_time  \n",
       "0  0.0   42.355999  \n",
       "1  1.0    4.672000  \n",
       "2  0.0   19.792999  \n",
       "3  0.0  102.348999  \n",
       "4  0.0   16.223000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "train_data, cat_cols = fe.apply_fe(CFG.train_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "406123c5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:08.353285Z",
     "iopub.status.busy": "2025-03-02T02:20:08.352904Z",
     "iopub.status.idle": "2025-03-02T02:20:08.419514Z",
     "shell.execute_reply": "2025-03-02T02:20:08.418320Z"
    },
    "papermill": {
     "duration": 0.083753,
     "end_time": "2025-03-02T02:20:08.422130",
     "exception": false,
     "start_time": "2025-03-02T02:20:08.338377",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Shape of dataframe: (3, 58)\n",
      "Memory usage: 0.00 MB\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>dri_score</th>\n",
       "      <th>psych_disturb</th>\n",
       "      <th>cyto_score</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>hla_match_c_high</th>\n",
       "      <th>hla_high_res_8</th>\n",
       "      <th>tbi_status</th>\n",
       "      <th>arrhythmia</th>\n",
       "      <th>hla_low_res_6</th>\n",
       "      <th>graft_type</th>\n",
       "      <th>vent_hist</th>\n",
       "      <th>renal_issue</th>\n",
       "      <th>pulm_severe</th>\n",
       "      <th>prim_disease_hct</th>\n",
       "      <th>hla_high_res_6</th>\n",
       "      <th>cmv_status</th>\n",
       "      <th>hla_high_res_10</th>\n",
       "      <th>hla_match_dqb1_high</th>\n",
       "      <th>tce_imm_match</th>\n",
       "      <th>hla_nmdp_6</th>\n",
       "      <th>hla_match_c_low</th>\n",
       "      <th>rituximab</th>\n",
       "      <th>hla_match_drb1_low</th>\n",
       "      <th>hla_match_dqb1_low</th>\n",
       "      <th>prod_type</th>\n",
       "      <th>cyto_score_detail</th>\n",
       "      <th>conditioning_intensity</th>\n",
       "      <th>ethnicity</th>\n",
       "      <th>year_hct</th>\n",
       "      <th>obesity</th>\n",
       "      <th>mrd_hct</th>\n",
       "      <th>in_vivo_tcd</th>\n",
       "      <th>tce_match</th>\n",
       "      <th>hla_match_a_high</th>\n",
       "      <th>hepatic_severe</th>\n",
       "      <th>donor_age</th>\n",
       "      <th>prior_tumor</th>\n",
       "      <th>hla_match_b_low</th>\n",
       "      <th>peptic_ulcer</th>\n",
       "      <th>age_at_hct</th>\n",
       "      <th>hla_match_a_low</th>\n",
       "      <th>gvhd_proph</th>\n",
       "      <th>rheum_issue</th>\n",
       "      <th>sex_match</th>\n",
       "      <th>hla_match_b_high</th>\n",
       "      <th>race_group</th>\n",
       "      <th>comorbidity_score</th>\n",
       "      <th>karnofsky_score</th>\n",
       "      <th>hepatic_mild</th>\n",
       "      <th>tce_div_match</th>\n",
       "      <th>donor_related</th>\n",
       "      <th>melphalan_dose</th>\n",
       "      <th>hla_low_res_8</th>\n",
       "      <th>cardiac</th>\n",
       "      <th>hla_match_drb1_high</th>\n",
       "      <th>pulm_moderate</th>\n",
       "      <th>hla_low_res_10</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>28800</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>IEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2016.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>9.942000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FKalone</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>28801</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>TBI +- Other, &gt;cGy</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>AML</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2008.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>72.290001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.705002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Other GVHD Prophylaxis</td>\n",
       "      <td>No</td>\n",
       "      <td>F-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Asian</td>\n",
       "      <td>3.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28802</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>HIS</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2019.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>33.997002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Cyclophosphamide alone</td>\n",
       "      <td>No</td>\n",
       "      <td>F-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      ID                       dri_score psych_disturb    cyto_score diabetes  \\\n",
       "0  28800  N/A - non-malignant indication            No       Unknown       No   \n",
       "1  28801                    Intermediate            No  Intermediate       No   \n",
       "2  28802  N/A - non-malignant indication            No       Unknown       No   \n",
       "\n",
       "   hla_match_c_high  hla_high_res_8          tbi_status arrhythmia  \\\n",
       "0              -1.0            -1.0              No TBI         No   \n",
       "1               2.0             8.0  TBI +- Other, >cGy         No   \n",
       "2               2.0             8.0              No TBI         No   \n",
       "\n",
       "   hla_low_res_6        graft_type vent_hist renal_issue pulm_severe  \\\n",
       "0            6.0       Bone marrow        No          No          No   \n",
       "1            6.0  Peripheral blood        No          No          No   \n",
       "2            6.0       Bone marrow        No          No          No   \n",
       "\n",
       "  prim_disease_hct  hla_high_res_6 cmv_status  hla_high_res_10  \\\n",
       "0              IEA             6.0        +/+             -1.0   \n",
       "1              AML             6.0        +/+             10.0   \n",
       "2              HIS             6.0        +/+             10.0   \n",
       "\n",
       "   hla_match_dqb1_high tce_imm_match  hla_nmdp_6  hla_match_c_low rituximab  \\\n",
       "0                  2.0       Unknown         6.0              2.0        No   \n",
       "1                  2.0           P/P         6.0              2.0        No   \n",
       "2                  2.0           P/P         6.0              2.0        No   \n",
       "\n",
       "   hla_match_drb1_low  hla_match_dqb1_low prod_type cyto_score_detail  \\\n",
       "0                 2.0                 2.0        BM           Unknown   \n",
       "1                 2.0                 2.0        PB      Intermediate   \n",
       "2                 2.0                 2.0        BM           Unknown   \n",
       "\n",
       "  conditioning_intensity               ethnicity  year_hct obesity   mrd_hct  \\\n",
       "0                Unknown  Not Hispanic or Latino    2016.0      No   Unknown   \n",
       "1                    MAC  Not Hispanic or Latino    2008.0      No  Positive   \n",
       "2                Unknown  Not Hispanic or Latino    2019.0      No   Unknown   \n",
       "\n",
       "  in_vivo_tcd   tce_match  hla_match_a_high hepatic_severe  donor_age  \\\n",
       "0         Yes     Unknown               2.0             No  -1.000000   \n",
       "1          No  Permissive               2.0             No  72.290001   \n",
       "2         Yes     Unknown               2.0             No  -1.000000   \n",
       "\n",
       "  prior_tumor  hla_match_b_low peptic_ulcer  age_at_hct  hla_match_a_low  \\\n",
       "0          No              2.0           No    9.942000              2.0   \n",
       "1          No              2.0           No   43.705002              2.0   \n",
       "2          No              2.0           No   33.997002              2.0   \n",
       "\n",
       "               gvhd_proph rheum_issue sex_match  hla_match_b_high  \\\n",
       "0                 FKalone          No       M-F               2.0   \n",
       "1  Other GVHD Prophylaxis          No       F-F               2.0   \n",
       "2  Cyclophosphamide alone          No       F-M               2.0   \n",
       "\n",
       "           race_group  comorbidity_score  karnofsky_score hepatic_mild  \\\n",
       "0  More than one race                0.0             90.0           No   \n",
       "1               Asian                3.0             90.0           No   \n",
       "2  More than one race                0.0             90.0           No   \n",
       "\n",
       "           tce_div_match donor_related      melphalan_dose  hla_low_res_8  \\\n",
       "0                Unknown     Unrelated  N/A, Mel not given            8.0   \n",
       "1  Permissive mismatched       Related  N/A, Mel not given            8.0   \n",
       "2  Permissive mismatched       Related  N/A, Mel not given            8.0   \n",
       "\n",
       "  cardiac  hla_match_drb1_high pulm_moderate  hla_low_res_10  \n",
       "0      No                  2.0            No            10.0  \n",
       "1      No                  2.0           Yes            10.0  \n",
       "2      No                  2.0            No            10.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "test_data, _ = fe.apply_fe(CFG.test_path)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "72058a9a",
   "metadata": {
    "papermill": {
     "duration": 0.013212,
     "end_time": "2025-03-02T02:20:08.449148",
     "exception": false,
     "start_time": "2025-03-02T02:20:08.435936",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Model Development</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d3358550",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:08.479385Z",
     "iopub.status.busy": "2025-03-02T02:20:08.478971Z",
     "iopub.status.idle": "2025-03-02T02:20:08.492663Z",
     "shell.execute_reply": "2025-03-02T02:20:08.491459Z"
    },
    "papermill": {
     "duration": 0.032277,
     "end_time": "2025-03-02T02:20:08.494989",
     "exception": false,
     "start_time": "2025-03-02T02:20:08.462712",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class EDA:\n",
    "    \n",
    "    def __init__(self, color, data):\n",
    "        self._color = color  \n",
    "        self.data = data\n",
    "\n",
    "    def _template(self, fig, title):\n",
    "        \n",
    "        fig.update_layout(\n",
    "            title=title,\n",
    "            title_x=0.5, \n",
    "            plot_bgcolor='rgba(247, 230, 202, 1)',  \n",
    "            paper_bgcolor='rgba(247, 230, 202, 1)', \n",
    "            font=dict(color=self._color),\n",
    "            margin=dict(l=72, r=72, t=72, b=72), \n",
    "            height=720\n",
    "        )\n",
    "        \n",
    "        return fig\n",
    "\n",
    "    def distribution_plot(self, col, title):\n",
    "        \n",
    "        fig = px.histogram(\n",
    "            self.data,\n",
    "            x=col,\n",
    "            nbins=100,\n",
    "            color_discrete_sequence=[self._color]\n",
    "        )\n",
    "        \n",
    "        fig.update_layout(\n",
    "            xaxis_title='Values',\n",
    "            yaxis_title='Count',\n",
    "            bargap=0.1,\n",
    "            xaxis=dict(gridcolor='grey'),\n",
    "            yaxis=dict(gridcolor='grey', zerolinecolor='grey')\n",
    "        )\n",
    "        \n",
    "        fig.update_traces(hovertemplate='Value: %{x:.2f}<br>Count: %{y:,}')\n",
    "        \n",
    "        fig = self._template(fig, f'{title}')\n",
    "        fig.show()\n",
    "        \n",
    "    def _plot_cv(self, scores, title, metric='C-Index'):\n",
    "        \n",
    "        fold_scores = [round(score, 3) for score in scores]\n",
    "        mean_score = round(np.mean(scores), 3)\n",
    "\n",
    "        fig = go.Figure()\n",
    "\n",
    "        fig.add_trace(go.Scatter(\n",
    "            x = list(range(1, len(fold_scores) + 1)),\n",
    "            y = fold_scores,\n",
    "            mode = 'markers', \n",
    "            name = 'Fold Scores',\n",
    "            marker = dict(size = 27, color=self._color, symbol='diamond'),\n",
    "            text = [f'{score:.3f}' for score in fold_scores],\n",
    "            hovertemplate = 'Fold %{x}: %{text}<extra></extra>',\n",
    "            hoverlabel = dict(font=dict(size=18))  \n",
    "        ))\n",
    "\n",
    "        fig.add_trace(go.Scatter(\n",
    "            x = [1, len(fold_scores)],\n",
    "            y = [mean_score, mean_score],\n",
    "            mode = 'lines',\n",
    "            name = f'Mean: {mean_score:.3f}',\n",
    "            line = dict(dash = 'dash', color = '#B22222'),\n",
    "            hoverinfo = 'none'\n",
    "        ))\n",
    "        \n",
    "        fig.update_layout(\n",
    "            title = f'{title} | Cross-validation Mean {metric} Score: {mean_score}',\n",
    "            xaxis_title = 'Fold',\n",
    "            yaxis_title = f'{metric} Score',\n",
    "            plot_bgcolor = 'rgba(247, 230, 202, 1)',  \n",
    "            paper_bgcolor = 'rgba(247, 230, 202, 1)',\n",
    "            font = dict(color=self._color), \n",
    "            xaxis = dict(\n",
    "                gridcolor = 'grey',\n",
    "                tickmode = 'linear',\n",
    "                tick0 = 1,\n",
    "                dtick = 1,\n",
    "                range = [0.5, len(fold_scores) + 0.5],\n",
    "                zerolinecolor = 'grey'\n",
    "            ),\n",
    "            yaxis = dict(\n",
    "                gridcolor = 'grey',\n",
    "                zerolinecolor = 'grey'\n",
    "            )\n",
    "        )\n",
    "        \n",
    "        fig.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "43877de9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:08.525695Z",
     "iopub.status.busy": "2025-03-02T02:20:08.525271Z",
     "iopub.status.idle": "2025-03-02T02:20:12.375089Z",
     "shell.execute_reply": "2025-03-02T02:20:12.373853Z"
    },
    "papermill": {
     "duration": 3.868652,
     "end_time": "2025-03-02T02:20:12.377763",
     "exception": false,
     "start_time": "2025-03-02T02:20:08.509111",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torch\n",
    "class Targets:\n",
    "\n",
    "    def __init__(self, data, cat_cols, penalizer, n_splits):\n",
    "        \n",
    "        self.data = data\n",
    "        self.cat_cols = cat_cols\n",
    "        \n",
    "        self._length = len(self.data)\n",
    "        self._penalizer = penalizer\n",
    "        self._n_splits = n_splits\n",
    "\n",
    "    def _prepare_cv(self):\n",
    "        \n",
    "        oof_preds = np.zeros(self._length)\n",
    "            \n",
    "        # cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=42)\n",
    "        cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=2025)\n",
    "\n",
    "        return cv, oof_preds\n",
    "\n",
    "    def validate_model(self, preds, title):\n",
    "\n",
    "        y_true = self.data[['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "        y_pred = self.data[['ID']].copy()\n",
    "\n",
    "        y_pred['prediction'] = preds\n",
    "\n",
    "        c_index_score = score(y_true.copy(), y_pred.copy(), 'ID')\n",
    "        print(f'Overall Stratified C-Index Score for {title}: {c_index_score:.4f}')\n",
    "\n",
    "        return c_index_score\n",
    "\n",
    "    def create_target1(self):  \n",
    "\n",
    "        '''\n",
    "        Inside the CV loop, constant columns are dropped if they exist in a fold. Otherwise, the code produces error:\n",
    "\n",
    "        delta contains nan value(s). Convergence halted. Please see the following tips in the lifelines documentation: \n",
    "        https://lifelines.readthedocs.io/en/latest/Examples.html#problems-with-convergence-in-the-cox-proportional-hazard-model\n",
    "        '''\n",
    "\n",
    "        cv, oof_preds = self._prepare_cv()\n",
    "\n",
    "        # Apply one hot encoding to categorical columns\n",
    "        data = pd.get_dummies(self.data, columns=self.cat_cols, drop_first=True).drop('ID', axis=1) \n",
    "\n",
    "        for train_index, valid_index in cv.split(data):\n",
    "\n",
    "            train_data = data.iloc[train_index]\n",
    "            valid_data = data.iloc[valid_index]\n",
    "\n",
    "            # Drop constant columns if they exist\n",
    "            train_data = train_data.loc[:, train_data.nunique() > 1]\n",
    "            valid_data = valid_data[train_data.columns]\n",
    "\n",
    "            cph = CoxPHFitter(penalizer=self._penalizer)\n",
    "            cph.fit(train_data, duration_col='efs_time', event_col='efs')\n",
    "            \n",
    "            oof_preds[valid_index] = cph.predict_partial_hazard(valid_data)              \n",
    "\n",
    "        self.data['target1'] = oof_preds  \n",
    "        self.validate_model(oof_preds, 'Cox')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target2(self):        \n",
    "\n",
    "        cv, oof_preds = self._prepare_cv()\n",
    "\n",
    "        for train_index, valid_index in cv.split(self.data):\n",
    "\n",
    "            train_data = self.data.iloc[train_index]\n",
    "            valid_data = self.data.iloc[valid_index]\n",
    "\n",
    "            kmf = KaplanMeierFitter()\n",
    "            kmf.fit(durations=train_data['efs_time'], event_observed=train_data['efs'])\n",
    "            \n",
    "            oof_preds[valid_index] = kmf.survival_function_at_times(valid_data['efs_time']).values\n",
    "\n",
    "        self.data['target2'] = oof_preds\n",
    "        self.validate_model(oof_preds, 'Kaplan-Meier')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target3(self):        \n",
    "\n",
    "        cv, oof_preds = self._prepare_cv()\n",
    "\n",
    "        for train_index, valid_index in cv.split(self.data):\n",
    "\n",
    "            train_data = self.data.iloc[train_index]\n",
    "            valid_data = self.data.iloc[valid_index]\n",
    "            \n",
    "            naf = NelsonAalenFitter()\n",
    "            naf.fit(durations=train_data['efs_time'], event_observed=train_data['efs'])\n",
    "            \n",
    "            oof_preds[valid_index] = -naf.cumulative_hazard_at_times(valid_data['efs_time']).values\n",
    "\n",
    "        self.data['target3'] = oof_preds\n",
    "        self.validate_model(oof_preds, 'Nelson-Aalen')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target4(self):\n",
    "\n",
    "        self.data['target4'] = self.data.efs_time.copy()\n",
    "        self.data.loc[self.data.efs == 0, 'target4'] *= -1\n",
    "\n",
    "        self.validate_model(self.data['target4'], 'Target for Cox-Loss Models')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    def create_target5(self):\n",
    "\n",
    "        self.data['target5'] = -self.data.efs_time.copy()\n",
    "\n",
    "        self.validate_model(self.data['target5'], 'efs_time')\n",
    "\n",
    "        return self.data\n",
    "\n",
    "    # def create_target6(self):\n",
    "\n",
    "    #     # id\n",
    "    #     win_counts = {idx: 0 for idx in self.data.index}\n",
    "        \n",
    "    #     # \n",
    "    #     for i in range(len(self.data)):\n",
    "    #         for j in range(i + 1, len(self.data)):  # j > i \n",
    "    #             efs_i, efs_j = self.data.loc[i, \"efs\"], self.data.loc[j, \"efs\"]\n",
    "    #             time_i, time_j = self.data.loc[i, \"efs_time\"], self.data.loc[j, \"efs_time\"]\n",
    "        \n",
    "    #             if efs_i == 1 and efs_j == 1:  # (1,1) \n",
    "    #                 if time_i > time_j:\n",
    "    #                     win_counts[i] += 1\n",
    "    #                 else:\n",
    "    #                     win_counts[j] += 1\n",
    "        \n",
    "    #             elif efs_i == 1 and efs_j == 0:  # (1,0) efs=0  j \n",
    "    #                 if time_j > time_i:\n",
    "    #                     win_counts[j] += 1\n",
    "        \n",
    "    #             elif efs_i == 0 and efs_j == 1:  # (0,1) efs=0  i \n",
    "    #                 if time_i > time_j:\n",
    "    #                     win_counts[i] += 1\n",
    "        \n",
    "    #     # \n",
    "    #     self.data[\"target6\"] = -self.data.index.map(win_counts)\n",
    "    #     self.validate_model(self.data[\"target6\"], 'pair_wise')\n",
    "\n",
    "    #     return self.data\n",
    "\n",
    "\n",
    "    def create_target6(self):\n",
    "        # GPU  \"cuda\"  \"cpu\" \n",
    "        device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n",
    "        \n",
    "        # pandas  \"efs\"  \"efs_time\"  PyTorch \n",
    "        efs = torch.tensor(self.data[\"efs\"].values, device=device)\n",
    "        efs_time = torch.tensor(self.data[\"efs_time\"].values, device=device)\n",
    "        \n",
    "        N = len(self.data)\n",
    "        \n",
    "        #  (i, j) (i < j) torch.combinations \n",
    "        pairs = torch.combinations(torch.arange(N, device=device), r=2)\n",
    "        i_idx, j_idx = pairs[:, 0], pairs[:, 1]\n",
    "        \n",
    "        # \n",
    "        efs_i, efs_j = efs[i_idx], efs[j_idx]\n",
    "        time_i, time_j = efs_time[i_idx], efs_time[j_idx]\n",
    "        \n",
    "        # 0\n",
    "        win_counts = torch.zeros(N, device=device)\n",
    "        \n",
    "        # (1,1) \n",
    "        condition_11 = (efs_i == 1) & (efs_j == 1)\n",
    "        win_counts.index_add_(0, i_idx[condition_11 & (time_i > time_j)], torch.ones((((condition_11) & (time_i > time_j)).sum(),), device=device))\n",
    "        win_counts.index_add_(0, j_idx[condition_11 & (time_j > time_i)], torch.ones((((condition_11) & (time_j > time_i)).sum(),), device=device))\n",
    "        \n",
    "        # (1,0) efs_i==1  efs_j==0 time_j > time_i j \n",
    "        condition_10 = (efs_i == 1) & (efs_j == 0) & (time_j > time_i)\n",
    "        win_counts.index_add_(0, j_idx[condition_10], torch.ones((condition_10.sum(),), device=device))\n",
    "        \n",
    "        # (0,1) efs_i==0  efs_j==1 time_i > time_j i \n",
    "        condition_01 = (efs_i == 0) & (efs_j == 1) & (time_i > time_j)\n",
    "        win_counts.index_add_(0, i_idx[condition_01], torch.ones((condition_01.sum(),), device=device))\n",
    "        \n",
    "        # \n",
    "        self.data[\"target6\"] = -win_counts.cpu().numpy()\n",
    "        \n",
    "        # \n",
    "        self.validate_model(self.data[\"target6\"], 'pair_wise')\n",
    "    \n",
    "        return self.data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "167a8a37",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:12.409095Z",
     "iopub.status.busy": "2025-03-02T02:20:12.408170Z",
     "iopub.status.idle": "2025-03-02T02:20:12.428178Z",
     "shell.execute_reply": "2025-03-02T02:20:12.427020Z"
    },
    "papermill": {
     "duration": 0.038758,
     "end_time": "2025-03-02T02:20:12.430674",
     "exception": false,
     "start_time": "2025-03-02T02:20:12.391916",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class MD:\n",
    "    \n",
    "    def __init__(self, color, data, cat_cols, penalizer, n_splits, early_stop):\n",
    "        \n",
    "        self.eda = EDA(color, data)\n",
    "        self.targets = Targets(data, cat_cols, penalizer, n_splits)\n",
    "        \n",
    "        self.data = data\n",
    "        self.cat_cols = cat_cols\n",
    "        self._n_splits = n_splits\n",
    "        self._early_stop = early_stop\n",
    "\n",
    "    def create_targets(self):\n",
    "\n",
    "        self.data = self.targets.create_target1()\n",
    "        self.data = self.targets.create_target2()\n",
    "        self.data = self.targets.create_target3()\n",
    "        self.data = self.targets.create_target4()\n",
    "        # self.data = self.targets.create_target5()\n",
    "        self.data = self.targets.create_target6()\n",
    "\n",
    "        return self.data\n",
    "        \n",
    "    def train_model(self, params, target, title):\n",
    "        \n",
    "        for col in self.cat_cols:\n",
    "            self.data[col] = self.data[col].astype('category')\n",
    "            \n",
    "        X = self.data.drop(['ID', 'efs', 'efs_time',\n",
    "                            'target1',\n",
    "                            'target2',\n",
    "                            'target3',\n",
    "                            'target4',\n",
    "                            # 'target5',\n",
    "                            'target6'], axis=1)\n",
    "        y = self.data[target]\n",
    "\n",
    "        w =  1 + self.data[\"efs\"]  # 12\n",
    "        \n",
    "        models, fold_scores = [], []\n",
    "            \n",
    "        cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=42)\n",
    "        # cv = KFold(n_splits=self._n_splits, shuffle=True, random_state=2025)\n",
    "                \n",
    "        oof_preds = np.zeros(len(X))\n",
    "    \n",
    "        for fold, (train_index, valid_index) in enumerate(cv.split(X, y)):\n",
    "                \n",
    "            X_train = X.iloc[train_index]\n",
    "            X_valid = X.iloc[valid_index]\n",
    "                \n",
    "            y_train = y.iloc[train_index]\n",
    "            y_valid = y.iloc[valid_index]\n",
    "\n",
    "            w_train = w.iloc[train_index]\n",
    "    \n",
    "            if title.startswith('LightGBM'):\n",
    "                        \n",
    "                model = lgb.LGBMRegressor(**params)\n",
    "                        \n",
    "                model.fit(\n",
    "                    X_train, \n",
    "                    y_train,  \n",
    "                    sample_weight=w_train,\n",
    "                    eval_set=[(X_valid, y_valid)],\n",
    "                    eval_metric='rmse',\n",
    "                    callbacks=[lgb.early_stopping(self._early_stop, verbose=0), lgb.log_evaluation(0)]\n",
    "                )\n",
    "                        \n",
    "            elif title.startswith('CatBoost'):\n",
    "                        \n",
    "                model = CatBoostRegressor(**params, verbose=0, cat_features=self.cat_cols)\n",
    "                        \n",
    "                model.fit(\n",
    "                    X_train,\n",
    "                    y_train,\n",
    "                    sample_weight=w_train,\n",
    "                    eval_set=(X_valid, y_valid),\n",
    "                    early_stopping_rounds=self._early_stop, \n",
    "                    verbose=0\n",
    "                )               \n",
    "                    \n",
    "            models.append(model)\n",
    "                \n",
    "            oof_preds[valid_index] = model.predict(X_valid)\n",
    "\n",
    "            y_true_fold = self.data.iloc[valid_index][['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "            y_pred_fold = self.data.iloc[valid_index][['ID']].copy()\n",
    "            \n",
    "            y_pred_fold['prediction'] = oof_preds[valid_index]\n",
    "    \n",
    "            fold_score = score(y_true_fold, y_pred_fold, 'ID')\n",
    "            fold_scores.append(fold_score)\n",
    "    \n",
    "        self.eda._plot_cv(fold_scores, title)\n",
    "            \n",
    "        y_true = self.data[['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "        y_pred = self.data[['ID']].copy()\n",
    "        \n",
    "        y_pred['prediction'] = oof_preds\n",
    "            \n",
    "        c_index_score = score(y_true.copy(), y_pred.copy(), 'ID')\n",
    "        print(f'\\nOverall C-Index for {title}: {c_index_score:.3f}\\n')\n",
    "        \n",
    "        return models, oof_preds\n",
    "\n",
    "    def infer_model(self, data, models):\n",
    "        \n",
    "        data = data.drop(['ID'], axis=1)\n",
    "\n",
    "        for col in self.cat_cols:\n",
    "            data[col] = data[col].astype('category')\n",
    "\n",
    "        return np.mean([model.predict(data) for model in models], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "1a572ab7",
   "metadata": {
    "_kg_hide-input": false,
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:12.460473Z",
     "iopub.status.busy": "2025-03-02T02:20:12.459458Z",
     "iopub.status.idle": "2025-03-02T02:20:12.465202Z",
     "shell.execute_reply": "2025-03-02T02:20:12.464071Z"
    },
    "papermill": {
     "duration": 0.023547,
     "end_time": "2025-03-02T02:20:12.467755",
     "exception": false,
     "start_time": "2025-03-02T02:20:12.444208",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "md = MD(CFG.color, train_data, cat_cols, CFG.penalizer, CFG.n_splits, CFG.early_stop)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "838c9dae",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:20:12.497745Z",
     "iopub.status.busy": "2025-03-02T02:20:12.497273Z",
     "iopub.status.idle": "2025-03-02T02:24:25.230577Z",
     "shell.execute_reply": "2025-03-02T02:24:25.228856Z"
    },
    "papermill": {
     "duration": 252.752314,
     "end_time": "2025-03-02T02:24:25.234094",
     "exception": false,
     "start_time": "2025-03-02T02:20:12.481780",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Cox: 0.6563\n",
      "Overall Stratified C-Index Score for Kaplan-Meier: 0.9987\n",
      "Overall Stratified C-Index Score for Nelson-Aalen: 0.9987\n",
      "Overall Stratified C-Index Score for Target for Cox-Loss Models: 0.5819\n",
      "Overall Stratified C-Index Score for pair_wise: 1.0000\n"
     ]
    }
   ],
   "source": [
    "train_data = md.create_targets()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "d6b4806d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:25.266531Z",
     "iopub.status.busy": "2025-03-02T02:24:25.266067Z",
     "iopub.status.idle": "2025-03-02T02:24:27.546768Z",
     "shell.execute_reply": "2025-03-02T02:24:27.545392Z"
    },
    "papermill": {
     "duration": 2.300301,
     "end_time": "2025-03-02T02:24:27.549389",
     "exception": false,
     "start_time": "2025-03-02T02:24:25.249088",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_17.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target1', 'Cox Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "f4d1f566",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:27.580191Z",
     "iopub.status.busy": "2025-03-02T02:24:27.578926Z",
     "iopub.status.idle": "2025-03-02T02:24:27.666800Z",
     "shell.execute_reply": "2025-03-02T02:24:27.665621Z"
    },
    "papermill": {
     "duration": 0.105492,
     "end_time": "2025-03-02T02:24:27.669079",
     "exception": false,
     "start_time": "2025-03-02T02:24:27.563587",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_18.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target2', 'Kaplan-Meier Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "54b75d72",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:27.698746Z",
     "iopub.status.busy": "2025-03-02T02:24:27.698299Z",
     "iopub.status.idle": "2025-03-02T02:24:27.787511Z",
     "shell.execute_reply": "2025-03-02T02:24:27.786180Z"
    },
    "papermill": {
     "duration": 0.1076,
     "end_time": "2025-03-02T02:24:27.790543",
     "exception": false,
     "start_time": "2025-03-02T02:24:27.682943",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_19.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target3', 'Nelson-Aalen Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "75f08833",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:27.822420Z",
     "iopub.status.busy": "2025-03-02T02:24:27.821969Z",
     "iopub.status.idle": "2025-03-02T02:24:27.909342Z",
     "shell.execute_reply": "2025-03-02T02:24:27.907932Z"
    },
    "papermill": {
     "duration": 0.105986,
     "end_time": "2025-03-02T02:24:27.911612",
     "exception": false,
     "start_time": "2025-03-02T02:24:27.805626",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_20.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target4', 'Target for Cox-Loss Models')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "36a11f46",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:27.942898Z",
     "iopub.status.busy": "2025-03-02T02:24:27.942402Z",
     "iopub.status.idle": "2025-03-02T02:24:27.947893Z",
     "shell.execute_reply": "2025-03-02T02:24:27.946673Z"
    },
    "papermill": {
     "duration": 0.02393,
     "end_time": "2025-03-02T02:24:27.950126",
     "exception": false,
     "start_time": "2025-03-02T02:24:27.926196",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# md.eda.distribution_plot('target5', 'efs_time')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "9b26e5ab",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:27.980898Z",
     "iopub.status.busy": "2025-03-02T02:24:27.980419Z",
     "iopub.status.idle": "2025-03-02T02:24:28.070620Z",
     "shell.execute_reply": "2025-03-02T02:24:28.069190Z"
    },
    "papermill": {
     "duration": 0.108938,
     "end_time": "2025-03-02T02:24:28.073382",
     "exception": false,
     "start_time": "2025-03-02T02:24:27.964444",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"740\"\n",
       "    src=\"iframe_figures/figure_22.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "md.eda.distribution_plot('target6', 'Pairwise Target')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "5c5cc882",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:28.106128Z",
     "iopub.status.busy": "2025-03-02T02:24:28.105644Z",
     "iopub.status.idle": "2025-03-02T02:24:28.161051Z",
     "shell.execute_reply": "2025-03-02T02:24:28.159777Z"
    },
    "papermill": {
     "duration": 0.073865,
     "end_time": "2025-03-02T02:24:28.163395",
     "exception": false,
     "start_time": "2025-03-02T02:24:28.089530",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Shape of dataframe: (28800, 65)\n",
      "Memory usage: 11.32 MB\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>dri_score</th>\n",
       "      <th>psych_disturb</th>\n",
       "      <th>cyto_score</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>hla_match_c_high</th>\n",
       "      <th>hla_high_res_8</th>\n",
       "      <th>tbi_status</th>\n",
       "      <th>arrhythmia</th>\n",
       "      <th>hla_low_res_6</th>\n",
       "      <th>graft_type</th>\n",
       "      <th>vent_hist</th>\n",
       "      <th>renal_issue</th>\n",
       "      <th>pulm_severe</th>\n",
       "      <th>prim_disease_hct</th>\n",
       "      <th>hla_high_res_6</th>\n",
       "      <th>cmv_status</th>\n",
       "      <th>hla_high_res_10</th>\n",
       "      <th>hla_match_dqb1_high</th>\n",
       "      <th>tce_imm_match</th>\n",
       "      <th>hla_nmdp_6</th>\n",
       "      <th>hla_match_c_low</th>\n",
       "      <th>rituximab</th>\n",
       "      <th>hla_match_drb1_low</th>\n",
       "      <th>hla_match_dqb1_low</th>\n",
       "      <th>prod_type</th>\n",
       "      <th>cyto_score_detail</th>\n",
       "      <th>conditioning_intensity</th>\n",
       "      <th>ethnicity</th>\n",
       "      <th>year_hct</th>\n",
       "      <th>obesity</th>\n",
       "      <th>mrd_hct</th>\n",
       "      <th>in_vivo_tcd</th>\n",
       "      <th>tce_match</th>\n",
       "      <th>hla_match_a_high</th>\n",
       "      <th>hepatic_severe</th>\n",
       "      <th>donor_age</th>\n",
       "      <th>prior_tumor</th>\n",
       "      <th>hla_match_b_low</th>\n",
       "      <th>peptic_ulcer</th>\n",
       "      <th>age_at_hct</th>\n",
       "      <th>hla_match_a_low</th>\n",
       "      <th>gvhd_proph</th>\n",
       "      <th>rheum_issue</th>\n",
       "      <th>sex_match</th>\n",
       "      <th>hla_match_b_high</th>\n",
       "      <th>race_group</th>\n",
       "      <th>comorbidity_score</th>\n",
       "      <th>karnofsky_score</th>\n",
       "      <th>hepatic_mild</th>\n",
       "      <th>tce_div_match</th>\n",
       "      <th>donor_related</th>\n",
       "      <th>melphalan_dose</th>\n",
       "      <th>hla_low_res_8</th>\n",
       "      <th>cardiac</th>\n",
       "      <th>hla_match_drb1_high</th>\n",
       "      <th>pulm_moderate</th>\n",
       "      <th>hla_low_res_10</th>\n",
       "      <th>efs</th>\n",
       "      <th>efs_time</th>\n",
       "      <th>target1</th>\n",
       "      <th>target2</th>\n",
       "      <th>target3</th>\n",
       "      <th>target4</th>\n",
       "      <th>target6</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>IEA</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2016.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>9.942000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FKalone</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>42.355999</td>\n",
       "      <td>0.259437</td>\n",
       "      <td>0.458538</td>\n",
       "      <td>-0.779686</td>\n",
       "      <td>-42.355999</td>\n",
       "      <td>-15521.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>TBI +- Other, &gt;cGy</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>AML</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2008.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>72.290001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.705002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Other GVHD Prophylaxis</td>\n",
       "      <td>No</td>\n",
       "      <td>F-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Asian</td>\n",
       "      <td>3.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.672000</td>\n",
       "      <td>1.119238</td>\n",
       "      <td>0.847373</td>\n",
       "      <td>-0.165610</td>\n",
       "      <td>4.672000</td>\n",
       "      <td>-4381.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>N/A - non-malignant indication</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>HIS</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2019.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>33.997002</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Cyclophosphamide alone</td>\n",
       "      <td>No</td>\n",
       "      <td>F-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>More than one race</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19.792999</td>\n",
       "      <td>0.138415</td>\n",
       "      <td>0.461865</td>\n",
       "      <td>-0.772458</td>\n",
       "      <td>-19.792999</td>\n",
       "      <td>-15443.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Bone marrow</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>ALL</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>P/P</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>BM</td>\n",
       "      <td>Intermediate</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Not Hispanic or Latino</td>\n",
       "      <td>2009.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Positive</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.230000</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>43.244999</td>\n",
       "      <td>2.0</td>\n",
       "      <td>FK+ MMF +- others</td>\n",
       "      <td>No</td>\n",
       "      <td>M-M</td>\n",
       "      <td>2.0</td>\n",
       "      <td>White</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Unrelated</td>\n",
       "      <td>N/A, Mel not given</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>102.348999</td>\n",
       "      <td>1.250770</td>\n",
       "      <td>0.455493</td>\n",
       "      <td>-0.786347</td>\n",
       "      <td>-102.348999</td>\n",
       "      <td>-15530.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>High</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No TBI</td>\n",
       "      <td>No</td>\n",
       "      <td>6.0</td>\n",
       "      <td>Peripheral blood</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>MPN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>+/+</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>PB</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>MAC</td>\n",
       "      <td>Hispanic or Latino</td>\n",
       "      <td>2018.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>56.810001</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>29.740000</td>\n",
       "      <td>2.0</td>\n",
       "      <td>TDEPLETION +- other</td>\n",
       "      <td>No</td>\n",
       "      <td>M-F</td>\n",
       "      <td>2.0</td>\n",
       "      <td>American Indian or Alaska Native</td>\n",
       "      <td>1.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>No</td>\n",
       "      <td>Permissive mismatched</td>\n",
       "      <td>Related</td>\n",
       "      <td>MEL</td>\n",
       "      <td>8.0</td>\n",
       "      <td>No</td>\n",
       "      <td>2.0</td>\n",
       "      <td>No</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.223000</td>\n",
       "      <td>1.005994</td>\n",
       "      <td>0.464399</td>\n",
       "      <td>-0.766987</td>\n",
       "      <td>-16.223000</td>\n",
       "      <td>-15383.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   ID                       dri_score psych_disturb    cyto_score diabetes  \\\n",
       "0   0  N/A - non-malignant indication            No       Unknown       No   \n",
       "1   1                    Intermediate            No  Intermediate       No   \n",
       "2   2  N/A - non-malignant indication            No       Unknown       No   \n",
       "3   3                            High            No  Intermediate       No   \n",
       "4   4                            High            No       Unknown       No   \n",
       "\n",
       "   hla_match_c_high  hla_high_res_8          tbi_status arrhythmia  \\\n",
       "0              -1.0            -1.0              No TBI         No   \n",
       "1               2.0             8.0  TBI +- Other, >cGy         No   \n",
       "2               2.0             8.0              No TBI         No   \n",
       "3               2.0             8.0              No TBI         No   \n",
       "4               2.0             8.0              No TBI         No   \n",
       "\n",
       "   hla_low_res_6        graft_type vent_hist renal_issue pulm_severe  \\\n",
       "0            6.0       Bone marrow        No          No          No   \n",
       "1            6.0  Peripheral blood        No          No          No   \n",
       "2            6.0       Bone marrow        No          No          No   \n",
       "3            6.0       Bone marrow        No          No          No   \n",
       "4            6.0  Peripheral blood        No          No          No   \n",
       "\n",
       "  prim_disease_hct  hla_high_res_6 cmv_status  hla_high_res_10  \\\n",
       "0              IEA             6.0        +/+             -1.0   \n",
       "1              AML             6.0        +/+             10.0   \n",
       "2              HIS             6.0        +/+             10.0   \n",
       "3              ALL             6.0        +/+             10.0   \n",
       "4              MPN             6.0        +/+             10.0   \n",
       "\n",
       "   hla_match_dqb1_high tce_imm_match  hla_nmdp_6  hla_match_c_low rituximab  \\\n",
       "0                  2.0       Unknown         6.0              2.0        No   \n",
       "1                  2.0           P/P         6.0              2.0        No   \n",
       "2                  2.0           P/P         6.0              2.0        No   \n",
       "3                  2.0           P/P         6.0              2.0        No   \n",
       "4                  2.0       Unknown         5.0              2.0        No   \n",
       "\n",
       "   hla_match_drb1_low  hla_match_dqb1_low prod_type cyto_score_detail  \\\n",
       "0                 2.0                 2.0        BM           Unknown   \n",
       "1                 2.0                 2.0        PB      Intermediate   \n",
       "2                 2.0                 2.0        BM           Unknown   \n",
       "3                 2.0                 2.0        BM      Intermediate   \n",
       "4                 2.0                 2.0        PB           Unknown   \n",
       "\n",
       "  conditioning_intensity               ethnicity  year_hct obesity   mrd_hct  \\\n",
       "0                Unknown  Not Hispanic or Latino    2016.0      No   Unknown   \n",
       "1                    MAC  Not Hispanic or Latino    2008.0      No  Positive   \n",
       "2                Unknown  Not Hispanic or Latino    2019.0      No   Unknown   \n",
       "3                    MAC  Not Hispanic or Latino    2009.0      No  Positive   \n",
       "4                    MAC      Hispanic or Latino    2018.0      No   Unknown   \n",
       "\n",
       "  in_vivo_tcd   tce_match  hla_match_a_high hepatic_severe  donor_age  \\\n",
       "0         Yes     Unknown               2.0             No  -1.000000   \n",
       "1          No  Permissive               2.0             No  72.290001   \n",
       "2         Yes     Unknown               2.0             No  -1.000000   \n",
       "3          No  Permissive               2.0             No  29.230000   \n",
       "4         Yes     Unknown               2.0             No  56.810001   \n",
       "\n",
       "  prior_tumor  hla_match_b_low peptic_ulcer  age_at_hct  hla_match_a_low  \\\n",
       "0          No              2.0           No    9.942000              2.0   \n",
       "1          No              2.0           No   43.705002              2.0   \n",
       "2          No              2.0           No   33.997002              2.0   \n",
       "3          No              2.0           No   43.244999              2.0   \n",
       "4          No              2.0           No   29.740000              2.0   \n",
       "\n",
       "               gvhd_proph rheum_issue sex_match  hla_match_b_high  \\\n",
       "0                 FKalone          No       M-F               2.0   \n",
       "1  Other GVHD Prophylaxis          No       F-F               2.0   \n",
       "2  Cyclophosphamide alone          No       F-M               2.0   \n",
       "3       FK+ MMF +- others          No       M-M               2.0   \n",
       "4     TDEPLETION +- other          No       M-F               2.0   \n",
       "\n",
       "                         race_group  comorbidity_score  karnofsky_score  \\\n",
       "0                More than one race                0.0             90.0   \n",
       "1                             Asian                3.0             90.0   \n",
       "2                More than one race                0.0             90.0   \n",
       "3                             White                0.0             90.0   \n",
       "4  American Indian or Alaska Native                1.0             90.0   \n",
       "\n",
       "  hepatic_mild          tce_div_match donor_related      melphalan_dose  \\\n",
       "0           No                Unknown     Unrelated  N/A, Mel not given   \n",
       "1           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "2           No  Permissive mismatched       Related  N/A, Mel not given   \n",
       "3          Yes  Permissive mismatched     Unrelated  N/A, Mel not given   \n",
       "4           No  Permissive mismatched       Related                 MEL   \n",
       "\n",
       "   hla_low_res_8 cardiac  hla_match_drb1_high pulm_moderate  hla_low_res_10  \\\n",
       "0            8.0      No                  2.0            No            10.0   \n",
       "1            8.0      No                  2.0           Yes            10.0   \n",
       "2            8.0      No                  2.0            No            10.0   \n",
       "3            8.0      No                  2.0            No            10.0   \n",
       "4            8.0      No                  2.0            No            10.0   \n",
       "\n",
       "   efs    efs_time   target1   target2   target3     target4  target6  \n",
       "0  0.0   42.355999  0.259437  0.458538 -0.779686  -42.355999 -15521.0  \n",
       "1  1.0    4.672000  1.119238  0.847373 -0.165610    4.672000  -4381.0  \n",
       "2  0.0   19.792999  0.138415  0.461865 -0.772458  -19.792999 -15443.0  \n",
       "3  0.0  102.348999  1.250770  0.455493 -0.786347 -102.348999 -15530.0  \n",
       "4  0.0   16.223000  1.005994  0.464399 -0.766987  -16.223000 -15383.0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fe.info(train_data)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2c6fa62",
   "metadata": {
    "papermill": {
     "duration": 0.014724,
     "end_time": "2025-03-02T02:24:28.193576",
     "exception": false,
     "start_time": "2025-03-02T02:24:28.178852",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Models with Cox Target</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "087bc3b2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T02:24:28.226638Z",
     "iopub.status.busy": "2025-03-02T02:24:28.225594Z",
     "iopub.status.idle": "2025-03-02T03:55:29.293597Z",
     "shell.execute_reply": "2025-03-02T03:55:29.290097Z"
    },
    "papermill": {
     "duration": 5461.089263,
     "end_time": "2025-03-02T03:55:29.298118",
     "exception": false,
     "start_time": "2025-03-02T02:24:28.208855",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_24.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.660\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb1_models, ctb1_oof_preds = md.train_model(CFG.ctb_params, target='target1', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "effa6fc8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T03:55:29.335775Z",
     "iopub.status.busy": "2025-03-02T03:55:29.335278Z",
     "iopub.status.idle": "2025-03-02T04:01:36.131029Z",
     "shell.execute_reply": "2025-03-02T04:01:36.129608Z"
    },
    "papermill": {
     "duration": 366.8193,
     "end_time": "2025-03-02T04:01:36.134015",
     "exception": false,
     "start_time": "2025-03-02T03:55:29.314715",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_25.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.658\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb1_models, lgb1_oof_preds = md.train_model(CFG.lgb_params, target='target1', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "0fe00a47",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T04:01:36.168788Z",
     "iopub.status.busy": "2025-03-02T04:01:36.168309Z",
     "iopub.status.idle": "2025-03-02T04:01:36.430965Z",
     "shell.execute_reply": "2025-03-02T04:01:36.429747Z"
    },
    "papermill": {
     "duration": 0.283377,
     "end_time": "2025-03-02T04:01:36.433951",
     "exception": false,
     "start_time": "2025-03-02T04:01:36.150574",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb1_preds = md.infer_model(test_data, ctb1_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "c74727bb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T04:01:36.468271Z",
     "iopub.status.busy": "2025-03-02T04:01:36.467843Z",
     "iopub.status.idle": "2025-03-02T04:01:36.697707Z",
     "shell.execute_reply": "2025-03-02T04:01:36.696474Z"
    },
    "papermill": {
     "duration": 0.250474,
     "end_time": "2025-03-02T04:01:36.700417",
     "exception": false,
     "start_time": "2025-03-02T04:01:36.449943",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb1_preds = md.infer_model(test_data, lgb1_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "95e9c22c",
   "metadata": {
    "papermill": {
     "duration": 0.015255,
     "end_time": "2025-03-02T04:01:36.731332",
     "exception": false,
     "start_time": "2025-03-02T04:01:36.716077",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Models with Kaplan-Meier Target</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "752aabc6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T04:01:36.764503Z",
     "iopub.status.busy": "2025-03-02T04:01:36.764079Z",
     "iopub.status.idle": "2025-03-02T05:16:20.141909Z",
     "shell.execute_reply": "2025-03-02T05:16:20.140425Z"
    },
    "papermill": {
     "duration": 4483.397311,
     "end_time": "2025-03-02T05:16:20.144184",
     "exception": false,
     "start_time": "2025-03-02T04:01:36.746873",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_28.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.670\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb2_models, ctb2_oof_preds = md.train_model(CFG.ctb_params, target='target2', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "c73082a3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T05:16:20.177083Z",
     "iopub.status.busy": "2025-03-02T05:16:20.176580Z",
     "iopub.status.idle": "2025-03-02T05:17:16.148931Z",
     "shell.execute_reply": "2025-03-02T05:17:16.147345Z"
    },
    "papermill": {
     "duration": 55.992107,
     "end_time": "2025-03-02T05:17:16.151603",
     "exception": false,
     "start_time": "2025-03-02T05:16:20.159496",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_29.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.662\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb2_models, lgb2_oof_preds = md.train_model(CFG.lgb_params, target='target2', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "421ac56b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T05:17:16.186918Z",
     "iopub.status.busy": "2025-03-02T05:17:16.186460Z",
     "iopub.status.idle": "2025-03-02T05:17:16.255707Z",
     "shell.execute_reply": "2025-03-02T05:17:16.254430Z"
    },
    "papermill": {
     "duration": 0.0903,
     "end_time": "2025-03-02T05:17:16.258749",
     "exception": false,
     "start_time": "2025-03-02T05:17:16.168449",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb2_preds = md.infer_model(test_data, ctb2_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "b9ad8026",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T05:17:16.293585Z",
     "iopub.status.busy": "2025-03-02T05:17:16.293187Z",
     "iopub.status.idle": "2025-03-02T05:17:16.452910Z",
     "shell.execute_reply": "2025-03-02T05:17:16.451800Z"
    },
    "papermill": {
     "duration": 0.180498,
     "end_time": "2025-03-02T05:17:16.455806",
     "exception": false,
     "start_time": "2025-03-02T05:17:16.275308",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb2_preds = md.infer_model(test_data, lgb2_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a26bdcd",
   "metadata": {
    "papermill": {
     "duration": 0.015576,
     "end_time": "2025-03-02T05:17:16.488492",
     "exception": false,
     "start_time": "2025-03-02T05:17:16.472916",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Models with Nelson-Aalen Target</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "0406e17c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T05:17:16.521566Z",
     "iopub.status.busy": "2025-03-02T05:17:16.521205Z",
     "iopub.status.idle": "2025-03-02T06:41:11.719935Z",
     "shell.execute_reply": "2025-03-02T06:41:11.718146Z"
    },
    "papermill": {
     "duration": 5035.218967,
     "end_time": "2025-03-02T06:41:11.722960",
     "exception": false,
     "start_time": "2025-03-02T05:17:16.503993",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_32.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.675\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb3_models, ctb3_oof_preds = md.train_model(CFG.ctb_params, target='target3', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "164bf29c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T06:41:11.758869Z",
     "iopub.status.busy": "2025-03-02T06:41:11.758373Z",
     "iopub.status.idle": "2025-03-02T06:42:11.212340Z",
     "shell.execute_reply": "2025-03-02T06:42:11.210641Z"
    },
    "papermill": {
     "duration": 59.475688,
     "end_time": "2025-03-02T06:42:11.215298",
     "exception": false,
     "start_time": "2025-03-02T06:41:11.739610",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_33.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.664\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb3_models, lgb3_oof_preds = md.train_model(CFG.lgb_params, target='target3', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "67054ba1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T06:42:11.252752Z",
     "iopub.status.busy": "2025-03-02T06:42:11.252235Z",
     "iopub.status.idle": "2025-03-02T06:42:11.339848Z",
     "shell.execute_reply": "2025-03-02T06:42:11.338215Z"
    },
    "papermill": {
     "duration": 0.109794,
     "end_time": "2025-03-02T06:42:11.342671",
     "exception": false,
     "start_time": "2025-03-02T06:42:11.232877",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb3_preds = md.infer_model(test_data, ctb3_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "8579c380",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T06:42:11.379701Z",
     "iopub.status.busy": "2025-03-02T06:42:11.379213Z",
     "iopub.status.idle": "2025-03-02T06:42:11.560705Z",
     "shell.execute_reply": "2025-03-02T06:42:11.559330Z"
    },
    "papermill": {
     "duration": 0.203033,
     "end_time": "2025-03-02T06:42:11.563941",
     "exception": false,
     "start_time": "2025-03-02T06:42:11.360908",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb3_preds = md.infer_model(test_data, lgb3_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6319b27e",
   "metadata": {
    "papermill": {
     "duration": 0.017471,
     "end_time": "2025-03-02T06:42:11.599049",
     "exception": false,
     "start_time": "2025-03-02T06:42:11.581578",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Cox-Loss Models</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "ca2020ab",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T06:42:11.638351Z",
     "iopub.status.busy": "2025-03-02T06:42:11.637865Z",
     "iopub.status.idle": "2025-03-02T06:51:56.287320Z",
     "shell.execute_reply": "2025-03-02T06:51:56.285832Z"
    },
    "papermill": {
     "duration": 584.672439,
     "end_time": "2025-03-02T06:51:56.290402",
     "exception": false,
     "start_time": "2025-03-02T06:42:11.617963",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_36.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.672\n",
      "\n"
     ]
    }
   ],
   "source": [
    "cox1_models, cox1_oof_preds = md.train_model(CFG.cox1_params, target='target4', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "076ad9a7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T06:51:56.326827Z",
     "iopub.status.busy": "2025-03-02T06:51:56.326328Z",
     "iopub.status.idle": "2025-03-02T07:10:57.142788Z",
     "shell.execute_reply": "2025-03-02T07:10:57.139893Z"
    },
    "papermill": {
     "duration": 1140.838932,
     "end_time": "2025-03-02T07:10:57.146630",
     "exception": false,
     "start_time": "2025-03-02T06:51:56.307698",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_37.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.672\n",
      "\n"
     ]
    }
   ],
   "source": [
    "cox2_models, cox2_oof_preds = md.train_model(CFG.cox2_params, target='target4', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "ef6b7057",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.186943Z",
     "iopub.status.busy": "2025-03-02T07:10:57.186356Z",
     "iopub.status.idle": "2025-03-02T07:10:57.245387Z",
     "shell.execute_reply": "2025-03-02T07:10:57.244183Z"
    },
    "papermill": {
     "duration": 0.084027,
     "end_time": "2025-03-02T07:10:57.248238",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.164211",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "cox1_preds = md.infer_model(test_data, cox1_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "dd8df6b1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.284779Z",
     "iopub.status.busy": "2025-03-02T07:10:57.284256Z",
     "iopub.status.idle": "2025-03-02T07:10:57.346688Z",
     "shell.execute_reply": "2025-03-02T07:10:57.345587Z"
    },
    "papermill": {
     "duration": 0.083742,
     "end_time": "2025-03-02T07:10:57.349161",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.265419",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "cox2_preds = md.infer_model(test_data, cox2_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "9e0fc813",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.385260Z",
     "iopub.status.busy": "2025-03-02T07:10:57.384255Z",
     "iopub.status.idle": "2025-03-02T07:10:57.389611Z",
     "shell.execute_reply": "2025-03-02T07:10:57.388588Z"
    },
    "papermill": {
     "duration": 0.026018,
     "end_time": "2025-03-02T07:10:57.391798",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.365780",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# ctb5_models, ctb5_oof_preds = md.train_model(CFG.ctb_params, target='target5', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "cc057d69",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.427569Z",
     "iopub.status.busy": "2025-03-02T07:10:57.427138Z",
     "iopub.status.idle": "2025-03-02T07:10:57.432327Z",
     "shell.execute_reply": "2025-03-02T07:10:57.431184Z"
    },
    "papermill": {
     "duration": 0.025901,
     "end_time": "2025-03-02T07:10:57.434954",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.409053",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# lgb5_models, lgb5_oof_preds = md.train_model(CFG.lgb_params, target='target5', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "29d1d09f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.472341Z",
     "iopub.status.busy": "2025-03-02T07:10:57.471139Z",
     "iopub.status.idle": "2025-03-02T07:10:57.476672Z",
     "shell.execute_reply": "2025-03-02T07:10:57.475505Z"
    },
    "papermill": {
     "duration": 0.026751,
     "end_time": "2025-03-02T07:10:57.478868",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.452117",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# ctb5_preds = md.infer_model(test_data, ctb5_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "bc4335e7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.514639Z",
     "iopub.status.busy": "2025-03-02T07:10:57.513605Z",
     "iopub.status.idle": "2025-03-02T07:10:57.518851Z",
     "shell.execute_reply": "2025-03-02T07:10:57.517773Z"
    },
    "papermill": {
     "duration": 0.025755,
     "end_time": "2025-03-02T07:10:57.521163",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.495408",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# lgb5_preds = md.infer_model(test_data, lgb5_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "a8559301",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T07:10:57.559672Z",
     "iopub.status.busy": "2025-03-02T07:10:57.558693Z",
     "iopub.status.idle": "2025-03-02T08:32:36.363379Z",
     "shell.execute_reply": "2025-03-02T08:32:36.361856Z"
    },
    "papermill": {
     "duration": 4898.826804,
     "end_time": "2025-03-02T08:32:36.366181",
     "exception": false,
     "start_time": "2025-03-02T07:10:57.539377",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_44.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for CatBoost: 0.669\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ctb6_models, ctb6_oof_preds = md.train_model(CFG.ctb_params, target='target6', title='CatBoost')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "f9071ff5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:32:36.403481Z",
     "iopub.status.busy": "2025-03-02T08:32:36.402538Z",
     "iopub.status.idle": "2025-03-02T08:33:35.863332Z",
     "shell.execute_reply": "2025-03-02T08:33:35.861974Z"
    },
    "papermill": {
     "duration": 59.481727,
     "end_time": "2025-03-02T08:33:35.865558",
     "exception": false,
     "start_time": "2025-03-02T08:32:36.383831",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<iframe\n",
       "    scrolling=\"no\"\n",
       "    width=\"100%\"\n",
       "    height=\"545px\"\n",
       "    src=\"iframe_figures/figure_45.html\"\n",
       "    frameborder=\"0\"\n",
       "    allowfullscreen\n",
       "></iframe>\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Overall C-Index for LightGBM: 0.660\n",
      "\n"
     ]
    }
   ],
   "source": [
    "lgb6_models, lgb6_oof_preds = md.train_model(CFG.lgb_params, target='target6', title='LightGBM')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "5286e678",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:33:35.902560Z",
     "iopub.status.busy": "2025-03-02T08:33:35.901786Z",
     "iopub.status.idle": "2025-03-02T08:33:35.988148Z",
     "shell.execute_reply": "2025-03-02T08:33:35.986810Z"
    },
    "papermill": {
     "duration": 0.108062,
     "end_time": "2025-03-02T08:33:35.990643",
     "exception": false,
     "start_time": "2025-03-02T08:33:35.882581",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ctb6_preds = md.infer_model(test_data, ctb6_models)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "f3933180",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:33:36.028438Z",
     "iopub.status.busy": "2025-03-02T08:33:36.027905Z",
     "iopub.status.idle": "2025-03-02T08:33:36.210749Z",
     "shell.execute_reply": "2025-03-02T08:33:36.209438Z"
    },
    "papermill": {
     "duration": 0.204801,
     "end_time": "2025-03-02T08:33:36.213478",
     "exception": false,
     "start_time": "2025-03-02T08:33:36.008677",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lgb6_preds = md.infer_model(test_data, lgb6_models)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cc33957a",
   "metadata": {
    "papermill": {
     "duration": 0.017356,
     "end_time": "2025-03-02T08:33:36.448927",
     "exception": false,
     "start_time": "2025-03-02T08:33:36.431571",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<p style=\"background-color: rgb(247, 230, 202); font-size: 300%; text-align: center; border-radius: 40px 40px; color: rgb(162, 87, 79); font-weight: bold; font-family: 'Roboto'; border: 4px solid rgb(162, 87, 79);\">Ensemble Model</p>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e456efe3",
   "metadata": {
    "papermill": {
     "duration": 0.019428,
     "end_time": "2025-03-02T08:33:36.485880",
     "exception": false,
     "start_time": "2025-03-02T08:33:36.466452",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<div style=\"background-color: rgb(247, 230, 202); border: 4px solid rgb(162, 87, 79); border-radius: 40px; padding: 20px; font-family: 'Roboto'; color: rgb(162, 87, 79); text-align: left; font-size: 140%;\">\n",
    "    <b>Calculate C-Index score for Ensemble model using Out-of-Fold (OOF) predictions.</b>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "d6e11871",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:33:36.522829Z",
     "iopub.status.busy": "2025-03-02T08:33:36.522318Z",
     "iopub.status.idle": "2025-03-02T08:33:36.529410Z",
     "shell.execute_reply": "2025-03-02T08:33:36.528102Z"
    },
    "papermill": {
     "duration": 0.028696,
     "end_time": "2025-03-02T08:33:36.531940",
     "exception": false,
     "start_time": "2025-03-02T08:33:36.503244",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "oof_preds = [\n",
    "    ctb1_oof_preds, \n",
    "    lgb1_oof_preds, \n",
    "    ctb2_oof_preds, \n",
    "    lgb2_oof_preds, \n",
    "    ctb3_oof_preds, \n",
    "    lgb3_oof_preds, \n",
    "    cox1_oof_preds,\n",
    "    cox2_oof_preds,\n",
    "    # ctb5_oof_preds, \n",
    "    # lgb5_oof_preds,\n",
    "    ctb6_oof_preds, \n",
    "    lgb6_oof_preds,\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "6dd6e38c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:33:36.569463Z",
     "iopub.status.busy": "2025-03-02T08:33:36.568481Z",
     "iopub.status.idle": "2025-03-02T08:33:36.619383Z",
     "shell.execute_reply": "2025-03-02T08:33:36.618002Z"
    },
    "papermill": {
     "duration": 0.072826,
     "end_time": "2025-03-02T08:33:36.622150",
     "exception": false,
     "start_time": "2025-03-02T08:33:36.549324",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ranked_oof_preds = np.array([rankdata(p) for p in oof_preds])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "f0641a28",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:33:36.660425Z",
     "iopub.status.busy": "2025-03-02T08:33:36.659962Z",
     "iopub.status.idle": "2025-03-02T08:35:22.343107Z",
     "shell.execute_reply": "2025-03-02T08:35:22.341323Z"
    },
    "papermill": {
     "duration": 105.70511,
     "end_time": "2025-03-02T08:35:22.345585",
     "exception": false,
     "start_time": "2025-03-02T08:33:36.640475",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:36,885] A new study created in memory with name: no-name-3e8568a6-05dd-4f26-b191-605e476b0e7e\n",
      "[I 2025-03-02 08:33:37,351] Trial 0 finished with value: 0.6822095060319139 and parameters: {'weight_0': 0.32241307060547, 'weight_1': 0.9696563778907089, 'weight_2': 0.5825927965956849, 'weight_3': 0.5181396771172946, 'weight_4': 0.25521555038178884, 'weight_5': 0.9957709395011393, 'weight_6': 0.17346451455741152, 'weight_7': 0.8703327303951484, 'weight_8': 0.5334082518979284, 'weight_9': 0.5326679024150103}. Best is trial 0 with value: 0.6822095060319139.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6822\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:37,811] Trial 1 finished with value: 0.6830167852555039 and parameters: {'weight_0': 0.6881901408208047, 'weight_1': 0.5112022334217491, 'weight_2': 0.734782137436165, 'weight_3': 0.25402206527334803, 'weight_4': 0.5338269428324214, 'weight_5': 0.3016385028714781, 'weight_6': 0.6350206567192315, 'weight_7': 0.254910287885111, 'weight_8': 0.8576976018985272, 'weight_9': 0.5016824520443255}. Best is trial 1 with value: 0.6830167852555039.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6830\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:38,273] Trial 2 finished with value: 0.6819800935640461 and parameters: {'weight_0': 0.658771777597499, 'weight_1': 0.6772829617729946, 'weight_2': 0.24853988186104325, 'weight_3': 0.8135835678856611, 'weight_4': 0.4449671871692524, 'weight_5': 0.6077326725950356, 'weight_6': 0.11342251218181515, 'weight_7': 0.8315376911309638, 'weight_8': 0.776294828031606, 'weight_9': 0.7977523228237413}. Best is trial 1 with value: 0.6830167852555039.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6820\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:38,732] Trial 3 finished with value: 0.682255429909724 and parameters: {'weight_0': 0.3392229995670744, 'weight_1': 0.36490578435490406, 'weight_2': 0.3836278073247899, 'weight_3': 0.9284821408642759, 'weight_4': 0.7418000251299245, 'weight_5': 0.3389020904937981, 'weight_6': 0.780119220689021, 'weight_7': 0.9193671025234135, 'weight_8': 0.1957182433749705, 'weight_9': 0.9909537866005443}. Best is trial 1 with value: 0.6830167852555039.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6823\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:39,191] Trial 4 finished with value: 0.6779578957961812 and parameters: {'weight_0': 0.11200991657422141, 'weight_1': 0.48069316657972494, 'weight_2': 0.679643549131967, 'weight_3': 0.3494527378899766, 'weight_4': 0.9397474502203015, 'weight_5': 0.5525326798418588, 'weight_6': 0.07041524475987873, 'weight_7': 0.21896891454687395, 'weight_8': 0.9845854821990347, 'weight_9': 0.9649848831977119}. Best is trial 1 with value: 0.6830167852555039.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6780\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:39,654] Trial 5 finished with value: 0.6831661669868869 and parameters: {'weight_0': 0.6692403122816947, 'weight_1': 0.9887464739670592, 'weight_2': 0.6164914414048114, 'weight_3': 0.4718961670366003, 'weight_4': 0.8207819656527537, 'weight_5': 0.6217844060969046, 'weight_6': 0.7636052995270513, 'weight_7': 0.18831628636202535, 'weight_8': 0.6842665630164573, 'weight_9': 0.28241548519972}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6832\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:40,114] Trial 6 finished with value: 0.6815261046405345 and parameters: {'weight_0': 0.12483906757785718, 'weight_1': 0.7372612058701623, 'weight_2': 0.6514009985770928, 'weight_3': 0.38226163278674113, 'weight_4': 0.97984915192562, 'weight_5': 0.2742241100864242, 'weight_6': 0.5682377935098583, 'weight_7': 0.23694093254743165, 'weight_8': 0.6097054124086071, 'weight_9': 0.9047718238731906}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6815\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:40,579] Trial 7 finished with value: 0.6814412653498712 and parameters: {'weight_0': 0.8361821727132024, 'weight_1': 0.13739416358810452, 'weight_2': 0.4602594626283802, 'weight_3': 0.7874828931534608, 'weight_4': 0.17107721338896864, 'weight_5': 0.32740186258649306, 'weight_6': 0.3168984979079584, 'weight_7': 0.14959172666088383, 'weight_8': 0.8827490838386627, 'weight_9': 0.3370452555397966}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6814\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:41,048] Trial 8 finished with value: 0.68155096744322 and parameters: {'weight_0': 0.5486944844348847, 'weight_1': 0.057928415525320145, 'weight_2': 0.7566065181468145, 'weight_3': 0.9697361091480252, 'weight_4': 0.26282842927254957, 'weight_5': 0.6843486387743593, 'weight_6': 0.83335871080579, 'weight_7': 0.22980264847733628, 'weight_8': 0.3849679435616885, 'weight_9': 0.1366195362886354}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6816\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:41,513] Trial 9 finished with value: 0.6821029591236845 and parameters: {'weight_0': 0.2692271069141767, 'weight_1': 0.89809614618305, 'weight_2': 0.8817049684723312, 'weight_3': 0.22791807978046047, 'weight_4': 0.13084477000669303, 'weight_5': 0.9477281368457998, 'weight_6': 0.7130909681409507, 'weight_7': 0.21071155004918812, 'weight_8': 0.8224137124757731, 'weight_9': 0.477845815318786}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6821\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:42,026] Trial 10 finished with value: 0.6804179648707337 and parameters: {'weight_0': 0.9800495891565215, 'weight_1': 0.7704902131260668, 'weight_2': 0.07052776544542838, 'weight_3': 0.059477335725831915, 'weight_4': 0.7759793331483439, 'weight_5': 0.08142161445926133, 'weight_6': 0.359172385094908, 'weight_7': 0.5569055426878469, 'weight_8': 0.11256527613118839, 'weight_9': 0.08094985006914024}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6804\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:42,534] Trial 11 finished with value: 0.6827979212470838 and parameters: {'weight_0': 0.6843313735039842, 'weight_1': 0.34908671127991786, 'weight_2': 0.9463988678565458, 'weight_3': 0.5929966976793262, 'weight_4': 0.5242284190475957, 'weight_5': 0.764281383488279, 'weight_6': 0.9975689478009966, 'weight_7': 0.44495543234827106, 'weight_8': 0.674538428034563, 'weight_9': 0.341278988928905}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6828\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:43,039] Trial 12 finished with value: 0.6827562469703714 and parameters: {'weight_0': 0.7803902580907637, 'weight_1': 0.5586871548065258, 'weight_2': 0.7917308262833045, 'weight_3': 0.1798953321121754, 'weight_4': 0.7343953655500746, 'weight_5': 0.4517777730091911, 'weight_6': 0.5799269038010678, 'weight_7': 0.051896307451068796, 'weight_8': 0.39058654311264795, 'weight_9': 0.6420115445817249}. Best is trial 5 with value: 0.6831661669868869.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6828\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:43,547] Trial 13 finished with value: 0.6836430437026413 and parameters: {'weight_0': 0.5011281210288715, 'weight_1': 0.5503598720729839, 'weight_2': 0.516049735511354, 'weight_3': 0.5375511595564803, 'weight_4': 0.619859395613209, 'weight_5': 0.08422320973234004, 'weight_6': 0.9336182350242866, 'weight_7': 0.40180102509451765, 'weight_8': 0.7114444374283909, 'weight_9': 0.2947509055951489}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:44,063] Trial 14 finished with value: 0.6835737370140339 and parameters: {'weight_0': 0.5192495387991728, 'weight_1': 0.8448401676821948, 'weight_2': 0.352192993222476, 'weight_3': 0.585079837957645, 'weight_4': 0.620162246278821, 'weight_5': 0.06523633268797588, 'weight_6': 0.999171155743321, 'weight_7': 0.4527115292230081, 'weight_8': 0.6510284662175715, 'weight_9': 0.23821727753681662}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:44,578] Trial 15 finished with value: 0.6835263313215957 and parameters: {'weight_0': 0.4584320358419779, 'weight_1': 0.8226604059805496, 'weight_2': 0.34394660063569704, 'weight_3': 0.6763032890927729, 'weight_4': 0.6227171562342774, 'weight_5': 0.05676109053229518, 'weight_6': 0.9580469846926101, 'weight_7': 0.47502262639041026, 'weight_8': 0.4195623706770395, 'weight_9': 0.19396069277663208}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:45,087] Trial 16 finished with value: 0.6833942825512949 and parameters: {'weight_0': 0.48451576711131267, 'weight_1': 0.6664161705196072, 'weight_2': 0.2025080969774432, 'weight_3': 0.6398563940244546, 'weight_4': 0.4286787489353298, 'weight_5': 0.17096468610111795, 'weight_6': 0.9158540687903594, 'weight_7': 0.6469864658746752, 'weight_8': 0.5270496567045289, 'weight_9': 0.22061774357610364}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:45,638] Trial 17 finished with value: 0.6819134367088858 and parameters: {'weight_0': 0.3977038429005753, 'weight_1': 0.2718720239386109, 'weight_2': 0.48844953601773433, 'weight_3': 0.748010776133976, 'weight_4': 0.588880848258098, 'weight_5': 0.16956934229039436, 'weight_6': 0.4471405181709263, 'weight_7': 0.3798335616681042, 'weight_8': 0.7007855823372484, 'weight_9': 0.3893399980164601}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6819\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:46,152] Trial 18 finished with value: 0.6835849224865973 and parameters: {'weight_0': 0.5538861461272565, 'weight_1': 0.6055052956420004, 'weight_2': 0.3772785246831465, 'weight_3': 0.43238345801295275, 'weight_4': 0.35923723937050256, 'weight_5': 0.44743313371930815, 'weight_6': 0.8690301779480362, 'weight_7': 0.6295245746059437, 'weight_8': 0.9875588515090764, 'weight_9': 0.054943836102140015}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:46,670] Trial 19 finished with value: 0.6835196890241646 and parameters: {'weight_0': 0.221561122957182, 'weight_1': 0.5994302932381607, 'weight_2': 0.21133704684331373, 'weight_3': 0.4215772110814859, 'weight_4': 0.3311411731811855, 'weight_5': 0.4361082787803732, 'weight_6': 0.8825902308463851, 'weight_7': 0.6965438270495209, 'weight_8': 0.977900164391487, 'weight_9': 0.05470706495240363}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:47,186] Trial 20 finished with value: 0.6832169665335145 and parameters: {'weight_0': 0.5656119956698972, 'weight_1': 0.461458585197566, 'weight_2': 0.5311074449220408, 'weight_3': 0.31572217957291343, 'weight_4': 0.3465026821713799, 'weight_5': 0.8186087238016204, 'weight_6': 0.6648127028090309, 'weight_7': 0.7021196330070236, 'weight_8': 0.9271040202980867, 'weight_9': 0.1575892315280851}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6832\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:47,700] Trial 21 finished with value: 0.6835735435093748 and parameters: {'weight_0': 0.584734672107823, 'weight_1': 0.834977424272652, 'weight_2': 0.3945396191713756, 'weight_3': 0.5607452931129079, 'weight_4': 0.6679813169407292, 'weight_5': 0.17854001154302568, 'weight_6': 0.8581017841640168, 'weight_7': 0.3717600418100665, 'weight_8': 0.7655136737492174, 'weight_9': 0.261193421670377}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:48,221] Trial 22 finished with value: 0.68348649407231 and parameters: {'weight_0': 0.4312811105267913, 'weight_1': 0.6476159844680099, 'weight_2': 0.29398781948582575, 'weight_3': 0.46985717843402175, 'weight_4': 0.44956112102775403, 'weight_5': 0.21890180536019366, 'weight_6': 0.971232511033833, 'weight_7': 0.5825176743136639, 'weight_8': 0.619591614605169, 'weight_9': 0.4225444412615715}. Best is trial 13 with value: 0.6836430437026413.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:48,742] Trial 23 finished with value: 0.6836683488688056 and parameters: {'weight_0': 0.5120729006909095, 'weight_1': 0.37075121189005394, 'weight_2': 0.12367711391659536, 'weight_3': 0.6825500455349768, 'weight_4': 0.6673775227640509, 'weight_5': 0.0849789524281063, 'weight_6': 0.8090743080614803, 'weight_7': 0.3335127424772618, 'weight_8': 0.4815603555252522, 'weight_9': 0.13609613630454037}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:49,253] Trial 24 finished with value: 0.6835245130502533 and parameters: {'weight_0': 0.7952462498696743, 'weight_1': 0.397312955957299, 'weight_2': 0.08601901192266276, 'weight_3': 0.681076167780163, 'weight_4': 0.8656110223902256, 'weight_5': 0.41830450145745324, 'weight_6': 0.7963612193825406, 'weight_7': 0.33352400131445675, 'weight_8': 0.3357747070736233, 'weight_9': 0.12022256698401591}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:49,764] Trial 25 finished with value: 0.6834801776548565 and parameters: {'weight_0': 0.3709947139154768, 'weight_1': 0.2919311412344249, 'weight_2': 0.1384366026796785, 'weight_3': 0.8507470158719375, 'weight_4': 0.5117672643519502, 'weight_5': 0.12615872880268947, 'weight_6': 0.7131022907672633, 'weight_7': 0.7705109315214509, 'weight_8': 0.26655156585865014, 'weight_9': 0.15372435942896617}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:50,274] Trial 26 finished with value: 0.683305904327129 and parameters: {'weight_0': 0.5977774721335224, 'weight_1': 0.22437359875931318, 'weight_2': 0.4557267128312812, 'weight_3': 0.7054015285857704, 'weight_4': 0.06746366594644015, 'weight_5': 0.2685005558478448, 'weight_6': 0.8870367818081619, 'weight_7': 0.3295070004302208, 'weight_8': 0.47695898013779126, 'weight_9': 0.05193072498527798}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6833\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:50,784] Trial 27 finished with value: 0.6824067666560539 and parameters: {'weight_0': 0.49864089041256193, 'weight_1': 0.4231349610421753, 'weight_2': 0.5551722583335712, 'weight_3': 0.506220266467789, 'weight_4': 0.7043417176580977, 'weight_5': 0.38923615964378955, 'weight_6': 0.4697249113792649, 'weight_7': 0.5202373616115943, 'weight_8': 0.5628534970927646, 'weight_9': 0.6691304198595235}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6824\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:51,295] Trial 28 finished with value: 0.6835195834118624 and parameters: {'weight_0': 0.20665742033027806, 'weight_1': 0.5345048053727908, 'weight_2': 0.2929867517723438, 'weight_3': 0.41003368392132084, 'weight_4': 0.4015118204541504, 'weight_5': 0.12789526514829325, 'weight_6': 0.7266744033295153, 'weight_7': 0.6254920336973235, 'weight_8': 0.7690460961190337, 'weight_9': 0.3185918788800759}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:51,808] Trial 29 finished with value: 0.682587322549816 and parameters: {'weight_0': 0.33211958163356015, 'weight_1': 0.5956945013196696, 'weight_2': 0.1490573063879523, 'weight_3': 0.5277668184705707, 'weight_4': 0.2401807511757634, 'weight_5': 0.5187479365398044, 'weight_6': 0.8273143133855491, 'weight_7': 0.40533379899397715, 'weight_8': 0.5061053040175123, 'weight_9': 0.5815227878060473}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6826\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:52,320] Trial 30 finished with value: 0.6832782737201283 and parameters: {'weight_0': 0.41990402408140576, 'weight_1': 0.20500589619194032, 'weight_2': 0.43864304607116533, 'weight_3': 0.6273520816618777, 'weight_4': 0.5733497654645225, 'weight_5': 0.21327039484767543, 'weight_6': 0.9396640628104028, 'weight_7': 0.3087937569183524, 'weight_8': 0.46112408213121914, 'weight_9': 0.1960918283425582}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6833\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:52,836] Trial 31 finished with value: 0.6834705823201891 and parameters: {'weight_0': 0.5267634899167847, 'weight_1': 0.9447268110350393, 'weight_2': 0.3524589442395776, 'weight_3': 0.5824731727411047, 'weight_4': 0.6386189711971194, 'weight_5': 0.053300046249844954, 'weight_6': 0.9962532183982111, 'weight_7': 0.482097746654929, 'weight_8': 0.5758849101418544, 'weight_9': 0.24962617033909545}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:53,345] Trial 32 finished with value: 0.6835940715485365 and parameters: {'weight_0': 0.6321361697467712, 'weight_1': 0.7425052175100032, 'weight_2': 0.5610508093952278, 'weight_3': 0.45944947798413954, 'weight_4': 0.5136824776488674, 'weight_5': 0.13254524803185772, 'weight_6': 0.9069725088249629, 'weight_7': 0.42865018538297645, 'weight_8': 0.6364132263734763, 'weight_9': 0.118715108676693}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:53,859] Trial 33 finished with value: 0.683599366831903 and parameters: {'weight_0': 0.6200007935522224, 'weight_1': 0.7045289718529356, 'weight_2': 0.6196960336956888, 'weight_3': 0.4560251701896979, 'weight_4': 0.48570816973336517, 'weight_5': 0.13369636261853907, 'weight_6': 0.9010972586602917, 'weight_7': 0.2861646418675834, 'weight_8': 0.7346901861190874, 'weight_9': 0.10479350929622645}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:54,374] Trial 34 finished with value: 0.6835262620044981 and parameters: {'weight_0': 0.6249985694701021, 'weight_1': 0.7336828433705307, 'weight_2': 0.5851301913307114, 'weight_3': 0.2817878783056542, 'weight_4': 0.4734808952651041, 'weight_5': 0.10957492134095206, 'weight_6': 0.6580904739531596, 'weight_7': 0.2806291115951315, 'weight_8': 0.7512031894694015, 'weight_9': 0.14902710342660858}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:54,887] Trial 35 finished with value: 0.6834792521216101 and parameters: {'weight_0': 0.748590177278409, 'weight_1': 0.724920047592482, 'weight_2': 0.7015819315587901, 'weight_3': 0.5091938232602354, 'weight_4': 0.5177946283945409, 'weight_5': 0.2539719993358415, 'weight_6': 0.9289307860959889, 'weight_7': 0.1367601594108977, 'weight_8': 0.8172677961549515, 'weight_9': 0.10316402202408434}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:55,446] Trial 36 finished with value: 0.6835694789804482 and parameters: {'weight_0': 0.7286467503786027, 'weight_1': 0.4795209000472956, 'weight_2': 0.8047684543062443, 'weight_3': 0.35681956958057426, 'weight_4': 0.6823115794272461, 'weight_5': 0.14248567070232082, 'weight_6': 0.7562386040013513, 'weight_7': 0.3949363731494364, 'weight_8': 0.7410924593563193, 'weight_9': 0.30343897367788014}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:55,959] Trial 37 finished with value: 0.6825912939462788 and parameters: {'weight_0': 0.8811253799564265, 'weight_1': 0.7885755036990769, 'weight_2': 0.614621576271622, 'weight_3': 0.8649675691474648, 'weight_4': 0.565737787865499, 'weight_5': 0.2224156556116843, 'weight_6': 0.1868094036904237, 'weight_7': 0.3056617795610757, 'weight_8': 0.70846229432496, 'weight_9': 0.3898121704448758}. Best is trial 23 with value: 0.6836683488688056.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6826\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:56,472] Trial 38 finished with value: 0.683812282586289 and parameters: {'weight_0': 0.623884174808907, 'weight_1': 0.6910184405531484, 'weight_2': 0.4964357527528282, 'weight_3': 0.4661036649048563, 'weight_4': 0.839695048107177, 'weight_5': 0.3240864882282216, 'weight_6': 0.810693910964882, 'weight_7': 0.9594078027658783, 'weight_8': 0.6092666898535457, 'weight_9': 0.18798501897117328}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:57,045] Trial 39 finished with value: 0.6837325590056434 and parameters: {'weight_0': 0.6943745656718194, 'weight_1': 0.6679285358905173, 'weight_2': 0.6465584084531659, 'weight_3': 0.7678046221190558, 'weight_4': 0.8924644328188542, 'weight_5': 0.3628056344338216, 'weight_6': 0.8220642907265715, 'weight_7': 0.9966299852072653, 'weight_8': 0.5747624766724484, 'weight_9': 0.19694410215694225}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:57,919] Trial 40 finished with value: 0.683442261720254 and parameters: {'weight_0': 0.710963471582776, 'weight_1': 0.5173489512583278, 'weight_2': 0.6954716606580752, 'weight_3': 0.7654261493362756, 'weight_4': 0.9184923056821406, 'weight_5': 0.31678874945212177, 'weight_6': 0.6161381260327379, 'weight_7': 0.9953407647816958, 'weight_8': 0.568673938598225, 'weight_9': 0.4591644278112742}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:58,752] Trial 41 finished with value: 0.6837103068695995 and parameters: {'weight_0': 0.6263788066304632, 'weight_1': 0.6923947977337336, 'weight_2': 0.6452947105975886, 'weight_3': 0.7182184635344065, 'weight_4': 0.8455181155321696, 'weight_5': 0.3493318885116846, 'weight_6': 0.8093894168235816, 'weight_7': 0.9022793233362892, 'weight_8': 0.6049224652281735, 'weight_9': 0.19330280966050006}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:59,268] Trial 42 finished with value: 0.683706765149865 and parameters: {'weight_0': 0.6605825103087589, 'weight_1': 0.6472931661853453, 'weight_2': 0.503059833986496, 'weight_3': 0.7265515673870064, 'weight_4': 0.8169944639870775, 'weight_5': 0.34906705114707437, 'weight_6': 0.7991872084897456, 'weight_7': 0.9119172997524548, 'weight_8': 0.5985196834528187, 'weight_9': 0.18634692564749675}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:33:59,781] Trial 43 finished with value: 0.6836357240922226 and parameters: {'weight_0': 0.8514896881719356, 'weight_1': 0.6429871531148564, 'weight_2': 0.6501700106770842, 'weight_3': 0.9017804180867585, 'weight_4': 0.8393026884556787, 'weight_5': 0.3775826339691062, 'weight_6': 0.7977766856819469, 'weight_7': 0.8830758393891448, 'weight_8': 0.4717656587578093, 'weight_9': 0.21638826746032375}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:00,294] Trial 44 finished with value: 0.68310637801323 and parameters: {'weight_0': 0.6544802163709157, 'weight_1': 0.6805871917405555, 'weight_2': 0.7536533043287783, 'weight_3': 0.725024095517827, 'weight_4': 0.9944547431467985, 'weight_5': 0.5135200083899878, 'weight_6': 0.7629452261958213, 'weight_7': 0.9998954027495018, 'weight_8': 0.5788251164956315, 'weight_9': 0.7844974852446537}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6831\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:00,812] Trial 45 finished with value: 0.6836512569039055 and parameters: {'weight_0': 0.6831415634582113, 'weight_1': 0.8921068270458842, 'weight_2': 0.8573217831432067, 'weight_3': 0.8178711390559137, 'weight_4': 0.7955824692701327, 'weight_5': 0.3632838982179412, 'weight_6': 0.692001258334881, 'weight_7': 0.9463655117874966, 'weight_8': 0.4357137419631937, 'weight_9': 0.164850474999751}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:01,328] Trial 46 finished with value: 0.6833289165039412 and parameters: {'weight_0': 0.7684341635290389, 'weight_1': 0.7873941547296448, 'weight_2': 0.6608430845308175, 'weight_3': 0.9856815381282042, 'weight_4': 0.8864323804908046, 'weight_5': 0.5804814924002414, 'weight_6': 0.8222440556832518, 'weight_7': 0.8321546380896232, 'weight_8': 0.5164269835293934, 'weight_9': 0.35411596547850144}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6833\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:01,840] Trial 47 finished with value: 0.6836155554592278 and parameters: {'weight_0': 0.7147461599850832, 'weight_1': 0.580375687124435, 'weight_2': 0.7186688558618994, 'weight_3': 0.8106052282155923, 'weight_4': 0.7590844771297622, 'weight_5': 0.32085303905468243, 'weight_6': 0.6014954437303256, 'weight_7': 0.9289622502687022, 'weight_8': 0.3573664203041539, 'weight_9': 0.2729158439820815}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:02,354] Trial 48 finished with value: 0.6834570853017339 and parameters: {'weight_0': 0.8098810353309197, 'weight_1': 0.6335088619357214, 'weight_2': 0.9600694185866862, 'weight_3': 0.6472984608227562, 'weight_4': 0.929319974649079, 'weight_5': 0.47404766597582965, 'weight_6': 0.5349784067664338, 'weight_7': 0.8033897193908237, 'weight_8': 0.6145515106550579, 'weight_9': 0.2009476296446107}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:02,866] Trial 49 finished with value: 0.6834634457035064 and parameters: {'weight_0': 0.887610612695164, 'weight_1': 0.6991157740320599, 'weight_2': 0.49241508720205784, 'weight_3': 0.9155094313093488, 'weight_4': 0.8192394687005464, 'weight_5': 0.6242480483150868, 'weight_6': 0.7432569791840007, 'weight_7': 0.8757255475232965, 'weight_8': 0.666386953284089, 'weight_9': 0.17078944233305438}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:03,375] Trial 50 finished with value: 0.6836887447405687 and parameters: {'weight_0': 0.6553521974848027, 'weight_1': 0.7594444833774765, 'weight_2': 0.4126813431549306, 'weight_3': 0.7774604640406128, 'weight_4': 0.9521782299820798, 'weight_5': 0.35197641064798524, 'weight_6': 0.8434932095709188, 'weight_7': 0.9606296397429668, 'weight_8': 0.5378761036235041, 'weight_9': 0.24553761765165993}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:03,892] Trial 51 finished with value: 0.6836753206897519 and parameters: {'weight_0': 0.6595003414448132, 'weight_1': 0.7859784451911794, 'weight_2': 0.4255421890975498, 'weight_3': 0.7773563540137292, 'weight_4': 0.8768765982360864, 'weight_5': 0.34034982101607536, 'weight_6': 0.8447162060320098, 'weight_7': 0.9542721728436692, 'weight_8': 0.5445849617634331, 'weight_9': 0.23582652347165656}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:04,405] Trial 52 finished with value: 0.6836752486839036 and parameters: {'weight_0': 0.66673713350294, 'weight_1': 0.8769821178231275, 'weight_2': 0.4304865617230807, 'weight_3': 0.7812266841115137, 'weight_4': 0.9558800800158068, 'weight_5': 0.34224637357648796, 'weight_6': 0.8455525917585023, 'weight_7': 0.9582723268890981, 'weight_8': 0.5442625585613219, 'weight_9': 0.24174262977120484}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:04,917] Trial 53 finished with value: 0.6836921947899192 and parameters: {'weight_0': 0.6037105014260372, 'weight_1': 0.7734587282274404, 'weight_2': 0.5113103903302377, 'weight_3': 0.7389198962426623, 'weight_4': 0.8781829291207653, 'weight_5': 0.2914647369580032, 'weight_6': 0.7755811174231747, 'weight_7': 0.9014253046713325, 'weight_8': 0.5979987134251011, 'weight_9': 0.2761507407021067}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:05,473] Trial 54 finished with value: 0.6835965768230258 and parameters: {'weight_0': 0.6064316530626898, 'weight_1': 0.7575779569736383, 'weight_2': 0.5114122898803839, 'weight_3': 0.7419771469654906, 'weight_4': 0.8989449928219901, 'weight_5': 0.28705516732259684, 'weight_6': 0.7678320204567421, 'weight_7': 0.8464695834541281, 'weight_8': 0.6489756179474673, 'weight_9': 0.36595621191528077}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:05,982] Trial 55 finished with value: 0.683410301705281 and parameters: {'weight_0': 0.5664982627610113, 'weight_1': 0.6773353794059002, 'weight_2': 0.6038740048835606, 'weight_3': 0.8548241591137494, 'weight_4': 0.9665635881016562, 'weight_5': 0.4032740757635483, 'weight_6': 0.680123674973371, 'weight_7': 0.8986988791450348, 'weight_8': 0.610490685036493, 'weight_9': 0.2848856968636108}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:06,494] Trial 56 finished with value: 0.6834742911265963 and parameters: {'weight_0': 0.7077946810249931, 'weight_1': 0.8255281444329015, 'weight_2': 0.5416172959194681, 'weight_3': 0.946576440463917, 'weight_4': 0.8444634611577972, 'weight_5': 0.47859660876022475, 'weight_6': 0.786852851721515, 'weight_7': 0.7779582341552904, 'weight_8': 0.588972976213911, 'weight_9': 0.18413861597696085}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:07,015] Trial 57 finished with value: 0.6836216284503072 and parameters: {'weight_0': 0.7445312044321459, 'weight_1': 0.9484091132798413, 'weight_2': 0.4758852679998869, 'weight_3': 0.6246365769227308, 'weight_4': 0.7875106628338562, 'weight_5': 0.2902057099563128, 'weight_6': 0.6375886283154037, 'weight_7': 0.9167374493628107, 'weight_8': 0.67642799983101, 'weight_9': 0.3261242646990405}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:07,526] Trial 58 finished with value: 0.6835219629025238 and parameters: {'weight_0': 0.5400450250665902, 'weight_1': 0.6374344456387433, 'weight_2': 0.40316579707513556, 'weight_3': 0.725838166821119, 'weight_4': 0.7325997289306365, 'weight_5': 0.24637489248767064, 'weight_6': 0.8690771193155836, 'weight_7': 0.9809280642841328, 'weight_8': 0.809023279451677, 'weight_9': 0.5193664157280866}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:08,041] Trial 59 finished with value: 0.6836507047387717 and parameters: {'weight_0': 0.6428220653306493, 'weight_1': 0.7046738960026254, 'weight_2': 0.5851204085742667, 'weight_3': 0.8153414033686075, 'weight_4': 0.9229705287607547, 'weight_5': 0.36326634576079814, 'weight_6': 0.7155150018797106, 'weight_7': 0.7452864086369113, 'weight_8': 0.5234321024941145, 'weight_9': 0.09171683232937305}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:08,554] Trial 60 finished with value: 0.6834041301467738 and parameters: {'weight_0': 0.5838451339063448, 'weight_1': 0.8528965859038038, 'weight_2': 0.6441350282508297, 'weight_3': 0.6979520698782266, 'weight_4': 0.9999607874312595, 'weight_5': 0.42666622045488534, 'weight_6': 0.29548556123134867, 'weight_7': 0.8664688503067088, 'weight_8': 0.431888258881997, 'weight_9': 0.2727946809656185}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:09,064] Trial 61 finished with value: 0.6836897000316502 and parameters: {'weight_0': 0.6737856155957713, 'weight_1': 0.7833424914018878, 'weight_2': 0.41809882999774645, 'weight_3': 0.7788076991693715, 'weight_4': 0.8699625149472505, 'weight_5': 0.3356580850771033, 'weight_6': 0.8422375391373189, 'weight_7': 0.9672834541631329, 'weight_8': 0.5996345376337694, 'weight_9': 0.2324776649196117}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:09,574] Trial 62 finished with value: 0.6836241420083966 and parameters: {'weight_0': 0.6888214816370601, 'weight_1': 0.8083399466589243, 'weight_2': 0.30152617886987987, 'weight_3': 0.877610873614448, 'weight_4': 0.8236105545236053, 'weight_5': 0.29990695993609007, 'weight_6': 0.8132861137751055, 'weight_7': 0.9175211754199577, 'weight_8': 0.6371605920758354, 'weight_9': 0.21710954728386792}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:10,089] Trial 63 finished with value: 0.6837468164943385 and parameters: {'weight_0': 0.6081998085394923, 'weight_1': 0.7476640963784553, 'weight_2': 0.5050711395326831, 'weight_3': 0.6564828184611389, 'weight_4': 0.869627663756313, 'weight_5': 0.39963758716811165, 'weight_6': 0.8734647059911618, 'weight_7': 0.9661935906483503, 'weight_8': 0.5966624100456392, 'weight_9': 0.17327241562557463}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:10,606] Trial 64 finished with value: 0.6836496505373767 and parameters: {'weight_0': 0.47541620060593587, 'weight_1': 0.5706777933055154, 'weight_2': 0.5084281181033677, 'weight_3': 0.6454673673128606, 'weight_4': 0.8672499438871321, 'weight_5': 0.3989034317223002, 'weight_6': 0.952386256929133, 'weight_7': 0.8121123544469127, 'weight_8': 0.6912290206573981, 'weight_9': 0.18333254526903578}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:11,121] Trial 65 finished with value: 0.683678880051022 and parameters: {'weight_0': 0.5952522772751597, 'weight_1': 0.6708606165737584, 'weight_2': 0.45869235805879477, 'weight_3': 0.667985815306062, 'weight_4': 0.8029655460391621, 'weight_5': 0.46376913616122956, 'weight_6': 0.8813026385001307, 'weight_7': 0.854243338166179, 'weight_8': 0.596488028305954, 'weight_9': 0.13981268361674581}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:11,640] Trial 66 finished with value: 0.6836724244950559 and parameters: {'weight_0': 0.547400810319186, 'weight_1': 0.8649075054849642, 'weight_2': 0.5596060340014924, 'weight_3': 0.7237530615334341, 'weight_4': 0.7557957481868157, 'weight_5': 0.19340957289850497, 'weight_6': 0.7803630268326193, 'weight_7': 0.9133777173129501, 'weight_8': 0.6276436949813331, 'weight_9': 0.30765175647514376}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:12,172] Trial 67 finished with value: 0.6837936402075036 and parameters: {'weight_0': 0.6194268798799363, 'weight_1': 0.715132562529081, 'weight_2': 0.5305608471494936, 'weight_3': 0.6121772518594437, 'weight_4': 0.8443374043983058, 'weight_5': 0.25700471336018216, 'weight_6': 0.7383720338826716, 'weight_7': 0.9753191740701952, 'weight_8': 0.497934235891652, 'weight_9': 0.2083102846183965}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:12,686] Trial 68 finished with value: 0.6837924396687398 and parameters: {'weight_0': 0.45139917915297184, 'weight_1': 0.6149506476041982, 'weight_2': 0.5304769733669976, 'weight_3': 0.6133246964525089, 'weight_4': 0.7200350644223159, 'weight_5': 0.26345023304916937, 'weight_6': 0.7214978748455749, 'weight_7': 0.9433433116224694, 'weight_8': 0.393005516557576, 'weight_9': 0.07863706177347177}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:13,198] Trial 69 finished with value: 0.6837221219211108 and parameters: {'weight_0': 0.37081537278995597, 'weight_1': 0.717698616946456, 'weight_2': 0.676065766259649, 'weight_3': 0.5624622773947445, 'weight_4': 0.7121260876725916, 'weight_5': 0.3850413133565048, 'weight_6': 0.7450728024508563, 'weight_7': 0.926992301011285, 'weight_8': 0.29932798923255916, 'weight_9': 0.07581075531280258}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:13,715] Trial 70 finished with value: 0.6838095368571167 and parameters: {'weight_0': 0.3673440972944938, 'weight_1': 0.6209922700843086, 'weight_2': 0.7819937488730222, 'weight_3': 0.5579113582911328, 'weight_4': 0.7153056663477022, 'weight_5': 0.25070100331873346, 'weight_6': 0.6977798795701187, 'weight_7': 0.9340840965056574, 'weight_8': 0.29517338036164975, 'weight_9': 0.09124236642185046}. Best is trial 38 with value: 0.683812282586289.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:14,228] Trial 71 finished with value: 0.683826549378487 and parameters: {'weight_0': 0.29512391197728205, 'weight_1': 0.6043800831368916, 'weight_2': 0.7838613135265882, 'weight_3': 0.5558972261070699, 'weight_4': 0.7202651512352393, 'weight_5': 0.23500001230199602, 'weight_6': 0.7286641894034459, 'weight_7': 0.9867495684219335, 'weight_8': 0.25893568745352685, 'weight_9': 0.0793362976595745}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:14,743] Trial 72 finished with value: 0.6837999053957683 and parameters: {'weight_0': 0.2923285741716751, 'weight_1': 0.6230979008882231, 'weight_2': 0.9025079490539178, 'weight_3': 0.5562005234868669, 'weight_4': 0.7127438686690447, 'weight_5': 0.2494778581283367, 'weight_6': 0.6922434435130095, 'weight_7': 0.941830858423379, 'weight_8': 0.25556337404716045, 'weight_9': 0.0748730924155653}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:15,263] Trial 73 finished with value: 0.68373232812947 and parameters: {'weight_0': 0.2025586245606027, 'weight_1': 0.5433046017811984, 'weight_2': 0.8772790173132359, 'weight_3': 0.5986406055243876, 'weight_4': 0.6528857051658615, 'weight_5': 0.2416171321306763, 'weight_6': 0.6462675352391836, 'weight_7': 0.9960637204295812, 'weight_8': 0.2022498652563122, 'weight_9': 0.07394741205118997}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:15,807] Trial 74 finished with value: 0.6838244125742818 and parameters: {'weight_0': 0.3086314987019437, 'weight_1': 0.6195270375351932, 'weight_2': 0.7940587532126893, 'weight_3': 0.4876293875038426, 'weight_4': 0.7120794734452199, 'weight_5': 0.2045667496947211, 'weight_6': 0.6845468270630076, 'weight_7': 0.9439725745312982, 'weight_8': 0.2335823190842709, 'weight_9': 0.1264574421423375}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:16,324] Trial 75 finished with value: 0.6838145703425564 and parameters: {'weight_0': 0.2799877284997076, 'weight_1': 0.6192795936445121, 'weight_2': 0.8278941580775858, 'weight_3': 0.5446957640277013, 'weight_4': 0.724901831373626, 'weight_5': 0.20154697388164083, 'weight_6': 0.6954387163675972, 'weight_7': 0.932872532154303, 'weight_8': 0.18318431711441066, 'weight_9': 0.12355942852909135}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:16,837] Trial 76 finished with value: 0.6838221351336559 and parameters: {'weight_0': 0.2641322394565092, 'weight_1': 0.6131955476358197, 'weight_2': 0.9271250614548517, 'weight_3': 0.4890515745860882, 'weight_4': 0.7165666543951148, 'weight_5': 0.19548239562915615, 'weight_6': 0.690879750416154, 'weight_7': 0.9408578530657443, 'weight_8': 0.11997745538856426, 'weight_9': 0.12275322861415124}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:17,353] Trial 77 finished with value: 0.6837664098195044 and parameters: {'weight_0': 0.23887821311920238, 'weight_1': 0.5032968215362406, 'weight_2': 0.9243673395803214, 'weight_3': 0.48632664637499917, 'weight_4': 0.6998957315807374, 'weight_5': 0.19570835513960405, 'weight_6': 0.5805979103287737, 'weight_7': 0.8701962697621246, 'weight_8': 0.09307991658894024, 'weight_9': 0.1035180189242361}. Best is trial 71 with value: 0.683826549378487.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:17,873] Trial 78 finished with value: 0.6838471152476563 and parameters: {'weight_0': 0.2810838565721602, 'weight_1': 0.6177477684393821, 'weight_2': 0.8111506869512263, 'weight_3': 0.5619081034186149, 'weight_4': 0.7682624341571699, 'weight_5': 0.1574580013494069, 'weight_6': 0.6863315460749447, 'weight_7': 0.9403337518584242, 'weight_8': 0.1640405953047831, 'weight_9': 0.11812049456567654}. Best is trial 78 with value: 0.6838471152476563.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:18,388] Trial 79 finished with value: 0.6838264299059984 and parameters: {'weight_0': 0.29447550597873173, 'weight_1': 0.6130053385372948, 'weight_2': 0.8168104545597119, 'weight_3': 0.5491996786388635, 'weight_4': 0.7578613984933391, 'weight_5': 0.15751372426657217, 'weight_6': 0.6863884856100209, 'weight_7': 0.8100784349436261, 'weight_8': 0.14706983331810006, 'weight_9': 0.12039586865512078}. Best is trial 78 with value: 0.6838471152476563.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:18,905] Trial 80 finished with value: 0.6837672582138677 and parameters: {'weight_0': 0.1564151086246194, 'weight_1': 0.5930649465021212, 'weight_2': 0.8240137707478464, 'weight_3': 0.4366336253369412, 'weight_4': 0.607735003788429, 'weight_5': 0.16998871275090996, 'weight_6': 0.5575248285143103, 'weight_7': 0.8155358844744511, 'weight_8': 0.14869333885378408, 'weight_9': 0.12126321756041489}. Best is trial 78 with value: 0.6838471152476563.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:19,423] Trial 81 finished with value: 0.6838672748823752 and parameters: {'weight_0': 0.27465020700018045, 'weight_1': 0.616085196807233, 'weight_2': 0.9302356529821447, 'weight_3': 0.5524031620691208, 'weight_4': 0.7671337346992643, 'weight_5': 0.15213005953663372, 'weight_6': 0.6910505094890524, 'weight_7': 0.9432308965882875, 'weight_8': 0.22410455083729677, 'weight_9': 0.05019681765030254}. Best is trial 81 with value: 0.6838672748823752.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:19,943] Trial 82 finished with value: 0.683863580178689 and parameters: {'weight_0': 0.3003347905610909, 'weight_1': 0.5641981066253685, 'weight_2': 0.9966484167188284, 'weight_3': 0.5356112650418204, 'weight_4': 0.7646388232651506, 'weight_5': 0.15309742115291008, 'weight_6': 0.6807070030576226, 'weight_7': 0.8857012075870955, 'weight_8': 0.05489057508481586, 'weight_9': 0.05142588571219592}. Best is trial 81 with value: 0.6838672748823752.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:20,460] Trial 83 finished with value: 0.6838961972974181 and parameters: {'weight_0': 0.30128242717914744, 'weight_1': 0.5725631731401508, 'weight_2': 0.9784808996700131, 'weight_3': 0.4893946447587806, 'weight_4': 0.7678659827974278, 'weight_5': 0.09628864416706867, 'weight_6': 0.6231759797056239, 'weight_7': 0.8867484509053317, 'weight_8': 0.054608705088282875, 'weight_9': 0.056315823514183086}. Best is trial 83 with value: 0.6838961972974181.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:20,973] Trial 84 finished with value: 0.6838937282873226 and parameters: {'weight_0': 0.2998423301497301, 'weight_1': 0.5651150568473945, 'weight_2': 0.9925690692599812, 'weight_3': 0.49176819688704376, 'weight_4': 0.7588490358626758, 'weight_5': 0.10613767431309427, 'weight_6': 0.6125888233730012, 'weight_7': 0.8875627068102986, 'weight_8': 0.05446745086774943, 'weight_9': 0.05601292574486027}. Best is trial 83 with value: 0.6838961972974181.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:21,486] Trial 85 finished with value: 0.6839157834119225 and parameters: {'weight_0': 0.3172703761842295, 'weight_1': 0.44697794263720914, 'weight_2': 0.9983537382415485, 'weight_3': 0.40229762431828525, 'weight_4': 0.7720450381063809, 'weight_5': 0.10364928898134455, 'weight_6': 0.6159001869164228, 'weight_7': 0.8845519355822272, 'weight_8': 0.06015868404001595, 'weight_9': 0.05466596121383657}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:21,999] Trial 86 finished with value: 0.6838928616220784 and parameters: {'weight_0': 0.3063619838429539, 'weight_1': 0.4415288148131687, 'weight_2': 0.988040022083621, 'weight_3': 0.3829431319210484, 'weight_4': 0.68227033984375, 'weight_5': 0.10139890829493478, 'weight_6': 0.6095037891878912, 'weight_7': 0.8378139389459152, 'weight_8': 0.05664652772796036, 'weight_9': 0.06340909868419549}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:22,516] Trial 87 finished with value: 0.683897880085192 and parameters: {'weight_0': 0.3473678629460758, 'weight_1': 0.4463423366246341, 'weight_2': 0.9977235686640216, 'weight_3': 0.361030339944979, 'weight_4': 0.7725724388258044, 'weight_5': 0.09491915603131648, 'weight_6': 0.47347851201570923, 'weight_7': 0.7788585799320911, 'weight_8': 0.05247780918072091, 'weight_9': 0.05622223689590761}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:23,025] Trial 88 finished with value: 0.6838457759592674 and parameters: {'weight_0': 0.3469161276846612, 'weight_1': 0.44319484254278035, 'weight_2': 0.9934234409340638, 'weight_3': 0.39366199045835926, 'weight_4': 0.67118492666628, 'weight_5': 0.09639140319191765, 'weight_6': 0.4866478462379011, 'weight_7': 0.732430303759606, 'weight_8': 0.05709034313102601, 'weight_9': 0.06392055303785968}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:23,530] Trial 89 finished with value: 0.6838165084367765 and parameters: {'weight_0': 0.336919053490427, 'weight_1': 0.44111834388977667, 'weight_2': 0.988617159730727, 'weight_3': 0.39611894367615363, 'weight_4': 0.7749230589600161, 'weight_5': 0.08345381951189741, 'weight_6': 0.4720434370312528, 'weight_7': 0.7153347348820466, 'weight_8': 0.06496736937845919, 'weight_9': 0.06123895947493957}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:24,039] Trial 90 finished with value: 0.6839003680177707 and parameters: {'weight_0': 0.39295111887875, 'weight_1': 0.3381284177455084, 'weight_2': 0.9980486148363192, 'weight_3': 0.3531709699556894, 'weight_4': 0.6817231043040299, 'weight_5': 0.10284649396883655, 'weight_6': 0.5210710067715558, 'weight_7': 0.772294062642942, 'weight_8': 0.05136951548589994, 'weight_9': 0.05182850044096035}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:24,550] Trial 91 finished with value: 0.683900006540562 and parameters: {'weight_0': 0.39871455372209635, 'weight_1': 0.3203827056109706, 'weight_2': 0.9961889479942194, 'weight_3': 0.3388385025593429, 'weight_4': 0.680285245726425, 'weight_5': 0.10773984970964212, 'weight_6': 0.5156531164603049, 'weight_7': 0.7823332058093236, 'weight_8': 0.05490079682285694, 'weight_9': 0.053760008118991946}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:25,060] Trial 92 finished with value: 0.6838280341198618 and parameters: {'weight_0': 0.40776758879331004, 'weight_1': 0.30877991434390606, 'weight_2': 0.9611924875758348, 'weight_3': 0.3557325504839671, 'weight_4': 0.7751763398984053, 'weight_5': 0.10526032498820659, 'weight_6': 0.40793188471367414, 'weight_7': 0.7707433016267744, 'weight_8': 0.09251443586409314, 'weight_9': 0.05222874322783343}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:25,622] Trial 93 finished with value: 0.6837778955869342 and parameters: {'weight_0': 0.2540879361066047, 'weight_1': 0.3921445326399876, 'weight_2': 0.9739163953880225, 'weight_3': 0.32004666392680353, 'weight_4': 0.6371653755240209, 'weight_5': 0.06310505394210449, 'weight_6': 0.5065845295011409, 'weight_7': 0.6853570980374823, 'weight_8': 0.0838686130842527, 'weight_9': 0.0946189379017715}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:26,143] Trial 94 finished with value: 0.6838983655333861 and parameters: {'weight_0': 0.3158189546866648, 'weight_1': 0.49373297163118923, 'weight_2': 0.9382580468170119, 'weight_3': 0.23288194435393306, 'weight_4': 0.75108930675633, 'weight_5': 0.14907083516305014, 'weight_6': 0.6199994148564992, 'weight_7': 0.834327189630483, 'weight_8': 0.12205460349189391, 'weight_9': 0.15493333879909}. Best is trial 85 with value: 0.6839157834119225.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:26,663] Trial 95 finished with value: 0.6839477880427118 and parameters: {'weight_0': 0.39188777251509194, 'weight_1': 0.3363433162737404, 'weight_2': 0.9384178932094686, 'weight_3': 0.2131045431320891, 'weight_4': 0.6830923093531995, 'weight_5': 0.11313049099670094, 'weight_6': 0.5397179558497064, 'weight_7': 0.7893235287615169, 'weight_8': 0.1167940363060376, 'weight_9': 0.050130209833212896}. Best is trial 95 with value: 0.6839477880427118.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:27,179] Trial 96 finished with value: 0.6838793843413705 and parameters: {'weight_0': 0.3884014524728294, 'weight_1': 0.34534624107523537, 'weight_2': 0.9339379117044839, 'weight_3': 0.20075297329824024, 'weight_4': 0.5527594992608142, 'weight_5': 0.1182174601926269, 'weight_6': 0.6117608280708868, 'weight_7': 0.7848169303513682, 'weight_8': 0.12081032060205102, 'weight_9': 0.143064040586311}. Best is trial 95 with value: 0.6839477880427118.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:27,694] Trial 97 finished with value: 0.6839093171464999 and parameters: {'weight_0': 0.38579460373312185, 'weight_1': 0.3316116986998272, 'weight_2': 0.9478523888687497, 'weight_3': 0.17833426976151467, 'weight_4': 0.692077675429849, 'weight_5': 0.11611348287627275, 'weight_6': 0.5470956982221697, 'weight_7': 0.834710361424331, 'weight_8': 0.12087227665722303, 'weight_9': 0.15005101366436713}. Best is trial 95 with value: 0.6839477880427118.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:28,208] Trial 98 finished with value: 0.6839484134953353 and parameters: {'weight_0': 0.4375494701535538, 'weight_1': 0.2563963815558881, 'weight_2': 0.9016394767408579, 'weight_3': 0.2782469700550444, 'weight_4': 0.6536436305826818, 'weight_5': 0.05098637290905347, 'weight_6': 0.5325352328666143, 'weight_7': 0.846110174379535, 'weight_8': 0.07615754868635127, 'weight_9': 0.15228232542023126}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:28,725] Trial 99 finished with value: 0.6839346421570889 and parameters: {'weight_0': 0.4397531878775643, 'weight_1': 0.2407429860056717, 'weight_2': 0.8864996284661357, 'weight_3': 0.13862837310009946, 'weight_4': 0.5985960750160467, 'weight_5': 0.07314119299882671, 'weight_6': 0.43043653705581536, 'weight_7': 0.7446157334007837, 'weight_8': 0.10461540322095403, 'weight_9': 0.16157099795587707}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:29,271] Trial 100 finished with value: 0.6839138202976488 and parameters: {'weight_0': 0.4288944627427983, 'weight_1': 0.2480454452692766, 'weight_2': 0.8980816353623774, 'weight_3': 0.10059778787930423, 'weight_4': 0.6519675546130577, 'weight_5': 0.05066539937270614, 'weight_6': 0.40162500398358125, 'weight_7': 0.7455660920257253, 'weight_8': 0.14096700341902013, 'weight_9': 0.1517607605472593}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:29,797] Trial 101 finished with value: 0.6839298668115156 and parameters: {'weight_0': 0.4369813317680935, 'weight_1': 0.23353163966135135, 'weight_2': 0.9019030286046997, 'weight_3': 0.11988025978510475, 'weight_4': 0.5940320878483555, 'weight_5': 0.05117093028758689, 'weight_6': 0.4329346508039937, 'weight_7': 0.6709076828668157, 'weight_8': 0.105175420693936, 'weight_9': 0.10074060132079775}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:30,315] Trial 102 finished with value: 0.6838951339499726 and parameters: {'weight_0': 0.4511237178150042, 'weight_1': 0.22599012988813436, 'weight_2': 0.8843573577086407, 'weight_3': 0.13109164137543727, 'weight_4': 0.594994285559662, 'weight_5': 0.05245461683410702, 'weight_6': 0.4247212604186936, 'weight_7': 0.6808936004489876, 'weight_8': 0.13893965303475136, 'weight_9': 0.16360920070959892}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:30,835] Trial 103 finished with value: 0.6838196822787734 and parameters: {'weight_0': 0.429485102157971, 'weight_1': 0.16464478563906018, 'weight_2': 0.9089062834370127, 'weight_3': 0.11073174056267891, 'weight_4': 0.6403188702448669, 'weight_5': 0.07627238601801149, 'weight_6': 0.3787584064777987, 'weight_7': 0.6670572429644359, 'weight_8': 0.1062458228605061, 'weight_9': 0.15271478285550677}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:31,354] Trial 104 finished with value: 0.6838977149946596 and parameters: {'weight_0': 0.3959835149827076, 'weight_1': 0.25948967619927077, 'weight_2': 0.946914656137431, 'weight_3': 0.26460051547934965, 'weight_4': 0.6128840042769458, 'weight_5': 0.06924420580974805, 'weight_6': 0.5364549901500758, 'weight_7': 0.7362523328613804, 'weight_8': 0.07462682813877664, 'weight_9': 0.10539381861291706}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:31,872] Trial 105 finished with value: 0.6829699497133562 and parameters: {'weight_0': 0.48645890134372854, 'weight_1': 0.32391833312354007, 'weight_2': 0.8555102087017801, 'weight_3': 0.2257492437215977, 'weight_4': 0.6908019475272648, 'weight_5': 0.12732189902339786, 'weight_6': 0.44928674097050886, 'weight_7': 0.7524618996190846, 'weight_8': 0.10972764604663339, 'weight_9': 0.9579817707801461}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6830\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:32,388] Trial 106 finished with value: 0.6830082319432499 and parameters: {'weight_0': 0.35438905811629107, 'weight_1': 0.26765266865430193, 'weight_2': 0.9616554474721655, 'weight_3': 0.15367065412487557, 'weight_4': 0.5404157101027014, 'weight_5': 0.9366559778481744, 'weight_6': 0.5095221526551577, 'weight_7': 0.7960935221951595, 'weight_8': 0.18139746983196572, 'weight_9': 0.0972517070402492}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6830\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:32,911] Trial 107 finished with value: 0.6838847015526638 and parameters: {'weight_0': 0.4143299680017128, 'weight_1': 0.2355067876984379, 'weight_2': 0.9029290417117132, 'weight_3': 0.05018451185895906, 'weight_4': 0.5763206150130004, 'weight_5': 0.07883563997574877, 'weight_6': 0.33707325489842344, 'weight_7': 0.7556595379080291, 'weight_8': 0.13437339920529617, 'weight_9': 0.14908506482162542}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:33,424] Trial 108 finished with value: 0.6829963699282848 and parameters: {'weight_0': 0.3876253056626104, 'weight_1': 0.17052436859214393, 'weight_2': 0.8529180555172255, 'weight_3': 0.30198140415167074, 'weight_4': 0.6525719352935699, 'weight_5': 0.1357663329152341, 'weight_6': 0.5627210496846016, 'weight_7': 0.7168845476067464, 'weight_8': 0.16445875294820472, 'weight_9': 0.6812571652984925}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6830\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:33,941] Trial 109 finished with value: 0.6839179849435079 and parameters: {'weight_0': 0.32511584197275256, 'weight_1': 0.2931603697113095, 'weight_2': 0.878990993067363, 'weight_3': 0.09739629261962421, 'weight_4': 0.6616301225765215, 'weight_5': 0.05361555749476933, 'weight_6': 0.38740190279401043, 'weight_7': 0.8235306613214468, 'weight_8': 0.08088098775901201, 'weight_9': 0.14131217739708796}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:34,457] Trial 110 finished with value: 0.6839274348364797 and parameters: {'weight_0': 0.4380728095336134, 'weight_1': 0.30083319816027226, 'weight_2': 0.8798450272661106, 'weight_3': 0.09169919511047955, 'weight_4': 0.5972036004657906, 'weight_5': 0.05808125320623408, 'weight_6': 0.3977126810235345, 'weight_7': 0.850860089582191, 'weight_8': 0.09697414727260686, 'weight_9': 0.1359166535616999}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:34,976] Trial 111 finished with value: 0.6839295811775871 and parameters: {'weight_0': 0.4316421300262395, 'weight_1': 0.29171640117734304, 'weight_2': 0.9483075560790298, 'weight_3': 0.08489003151917658, 'weight_4': 0.6624375821489855, 'weight_5': 0.05248172671121598, 'weight_6': 0.2882980733080899, 'weight_7': 0.8281234012156503, 'weight_8': 0.09576314693411594, 'weight_9': 0.16620770465100423}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:35,549] Trial 112 finished with value: 0.6838723907378905 and parameters: {'weight_0': 0.44201443290828113, 'weight_1': 0.28670389845136623, 'weight_2': 0.878223858763499, 'weight_3': 0.06905877942670052, 'weight_4': 0.5899252517449389, 'weight_5': 0.052091394095784234, 'weight_6': 0.24957723222797545, 'weight_7': 0.5956242743392284, 'weight_8': 0.09464440897539797, 'weight_9': 0.13635682179574724}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:36,071] Trial 113 finished with value: 0.6839014263004374 and parameters: {'weight_0': 0.4655948316845047, 'weight_1': 0.34506467313330685, 'weight_2': 0.9078037642711076, 'weight_3': 0.08365935435372251, 'weight_4': 0.6251216743872445, 'weight_5': 0.06964190441634205, 'weight_6': 0.39365520967483325, 'weight_7': 0.8552110318299833, 'weight_8': 0.07935007476448985, 'weight_9': 0.10575385987966048}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:36,590] Trial 114 finished with value: 0.6839255807476973 and parameters: {'weight_0': 0.4696454665635818, 'weight_1': 0.35791084923748595, 'weight_2': 0.8391286168161066, 'weight_3': 0.08927390156131601, 'weight_4': 0.6261791040829086, 'weight_5': 0.07654705765235642, 'weight_6': 0.38711390138489077, 'weight_7': 0.8231992431465862, 'weight_8': 0.07913270854357339, 'weight_9': 0.17637470286984452}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:37,144] Trial 115 finished with value: 0.6839040752136357 and parameters: {'weight_0': 0.46982276807908213, 'weight_1': 0.36780652654969787, 'weight_2': 0.8378197728323507, 'weight_3': 0.08310955506698099, 'weight_4': 0.6253189030442823, 'weight_5': 0.06649068462346809, 'weight_6': 0.37397207417160944, 'weight_7': 0.8569170223102618, 'weight_8': 0.08678483834029774, 'weight_9': 0.17958833317664633}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:37,666] Trial 116 finished with value: 0.6839385656378667 and parameters: {'weight_0': 0.5082818482385216, 'weight_1': 0.37420648224072567, 'weight_2': 0.8471767367348386, 'weight_3': 0.10550274717328005, 'weight_4': 0.6565552449590613, 'weight_5': 0.05049870211246555, 'weight_6': 0.3605163869085068, 'weight_7': 0.8521792094062711, 'weight_8': 0.16207178986041812, 'weight_9': 0.21632442918070371}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:38,191] Trial 117 finished with value: 0.683834577873473 and parameters: {'weight_0': 0.5048386363213019, 'weight_1': 0.20076911815539114, 'weight_2': 0.8883671358153192, 'weight_3': 0.165038094973852, 'weight_4': 0.6580832059839008, 'weight_5': 0.0806945558287005, 'weight_6': 0.2738343173613482, 'weight_7': 0.818878166750755, 'weight_8': 0.19850386103986914, 'weight_9': 0.20658045541296097}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:38,715] Trial 118 finished with value: 0.6839030462511353 and parameters: {'weight_0': 0.42442959966370497, 'weight_1': 0.40442644071688016, 'weight_2': 0.8650710374185467, 'weight_3': 0.11048363253074327, 'weight_4': 0.5684535315054413, 'weight_5': 0.051527312693716146, 'weight_6': 0.34051844619903004, 'weight_7': 0.8238971532067612, 'weight_8': 0.1586526898499454, 'weight_9': 0.2306527593156365}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:39,238] Trial 119 finished with value: 0.6839341007675275 and parameters: {'weight_0': 0.5286075438619102, 'weight_1': 0.08872408568007137, 'weight_2': 0.758789993402718, 'weight_3': 0.13332837570928563, 'weight_4': 0.49234960750622814, 'weight_5': 0.1283800239008473, 'weight_6': 0.4396061299775416, 'weight_7': 0.7966511003378607, 'weight_8': 0.1282609188358712, 'weight_9': 0.16996833699575958}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:39,762] Trial 120 finished with value: 0.6838287734902426 and parameters: {'weight_0': 0.5193639660426369, 'weight_1': 0.29852989341430286, 'weight_2': 0.7421998249578943, 'weight_3': 0.12917592938342065, 'weight_4': 0.49030990171786265, 'weight_5': 0.05013445616592343, 'weight_6': 0.4189815744500752, 'weight_7': 0.7938384945501694, 'weight_8': 0.10782515879054545, 'weight_9': 0.1688544184802655}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:40,285] Trial 121 finished with value: 0.683938218323987 and parameters: {'weight_0': 0.4894607210621036, 'weight_1': 0.25156265934164984, 'weight_2': 0.8490843389186936, 'weight_3': 0.18681703198294208, 'weight_4': 0.5381293714149527, 'weight_5': 0.12172303718777733, 'weight_6': 0.43250388084919894, 'weight_7': 0.8369189288723734, 'weight_8': 0.13540737018127347, 'weight_9': 0.14075077610882436}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:40,813] Trial 122 finished with value: 0.6838651166513993 and parameters: {'weight_0': 0.48315582502355936, 'weight_1': 0.09699792294873671, 'weight_2': 0.8406926580786962, 'weight_3': 0.10140540040453337, 'weight_4': 0.532809018871423, 'weight_5': 0.12694716370846854, 'weight_6': 0.4454652748927979, 'weight_7': 0.8042315948234793, 'weight_8': 0.1334319984197035, 'weight_9': 0.2145067997768003}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:41,341] Trial 123 finished with value: 0.6838645469332151 and parameters: {'weight_0': 0.4406105599618874, 'weight_1': 0.24722117070792043, 'weight_2': 0.8675541005306375, 'weight_3': 0.141138146194047, 'weight_4': 0.4606298192058368, 'weight_5': 0.08034324516004371, 'weight_6': 0.347231542292376, 'weight_7': 0.7616414692146551, 'weight_8': 0.08055457865064403, 'weight_9': 0.2596917014217555}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:41,865] Trial 124 finished with value: 0.683900028937155 and parameters: {'weight_0': 0.49433314082251956, 'weight_1': 0.3834124434268017, 'weight_2': 0.7709656786332032, 'weight_3': 0.1983198737296683, 'weight_4': 0.550800829646785, 'weight_5': 0.08664377641937188, 'weight_6': 0.44154286955767263, 'weight_7': 0.8501655745872688, 'weight_8': 0.1765204930309468, 'weight_9': 0.19139261086287274}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:42,388] Trial 125 finished with value: 0.6839164359490918 and parameters: {'weight_0': 0.5309730409284904, 'weight_1': 0.20073356301349474, 'weight_2': 0.892982899631347, 'weight_3': 0.09565122592625, 'weight_4': 0.499542713211513, 'weight_5': 0.12132997728263051, 'weight_6': 0.36591286931683115, 'weight_7': 0.7156878963348042, 'weight_8': 0.14635830464009314, 'weight_9': 0.1366227031139121}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:42,909] Trial 126 finished with value: 0.6838526157636032 and parameters: {'weight_0': 0.5570222774854937, 'weight_1': 0.2863990003621723, 'weight_2': 0.9167749247793697, 'weight_3': 0.15169938145779738, 'weight_4': 0.43517369997257593, 'weight_5': 0.12232763806403582, 'weight_6': 0.3149017825559912, 'weight_7': 0.6547881673195642, 'weight_8': 0.10361816314950957, 'weight_9': 0.13314978852133857}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:43,434] Trial 127 finished with value: 0.6838843564375241 and parameters: {'weight_0': 0.5356033770720409, 'weight_1': 0.19524340945946042, 'weight_2': 0.8518127960099728, 'weight_3': 0.07233496573862816, 'weight_4': 0.40819438785291606, 'weight_5': 0.1770719402992844, 'weight_6': 0.3718716411993451, 'weight_7': 0.7194905118724887, 'weight_8': 0.20495882074817262, 'weight_9': 0.08410947254568613}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:43,962] Trial 128 finished with value: 0.6838852773804394 and parameters: {'weight_0': 0.5173288842968458, 'weight_1': 0.10726964734690556, 'weight_2': 0.8876593594007162, 'weight_3': 0.19186527683468507, 'weight_4': 0.4995718681454718, 'weight_5': 0.07336174092078299, 'weight_6': 0.30987214430402965, 'weight_7': 0.8737050216576037, 'weight_8': 0.153640481048206, 'weight_9': 0.17778446425383304}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:44,488] Trial 129 finished with value: 0.6833702616894333 and parameters: {'weight_0': 0.4585644223456981, 'weight_1': 0.2135227050755512, 'weight_2': 0.8016305139652984, 'weight_3': 0.12248848507499259, 'weight_4': 0.6051595455489311, 'weight_5': 0.13990816490964214, 'weight_6': 0.2063705796458156, 'weight_7': 0.7959261887327146, 'weight_8': 0.07901560289042983, 'weight_9': 0.5931002887595785}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:45,015] Trial 130 finished with value: 0.6833881988811664 and parameters: {'weight_0': 0.4997111317137973, 'weight_1': 0.056467661623023455, 'weight_2': 0.8324432902458252, 'weight_3': 0.08963599629844182, 'weight_4': 0.5087984373674235, 'weight_5': 0.7081676857906962, 'weight_6': 0.48882620494659973, 'weight_7': 0.833197287241243, 'weight_8': 0.2209805859528685, 'weight_9': 0.11135360755251118}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:45,569] Trial 131 finished with value: 0.6838550620790637 and parameters: {'weight_0': 0.42254390412836557, 'weight_1': 0.255164606479885, 'weight_2': 0.9080967618598881, 'weight_3': 0.16880265846564727, 'weight_4': 0.5838172160177939, 'weight_5': 0.09516105736307841, 'weight_6': 0.3887293800416997, 'weight_7': 0.7373820311862764, 'weight_8': 0.13806842263938074, 'weight_9': 0.16169861928389392}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:46,090] Trial 132 finished with value: 0.6839333069962535 and parameters: {'weight_0': 0.46160463940840546, 'weight_1': 0.275512236043928, 'weight_2': 0.8840006134768227, 'weight_3': 0.09703515405511963, 'weight_4': 0.6411116808053307, 'weight_5': 0.06570510985415165, 'weight_6': 0.4133457761746627, 'weight_7': 0.6360835606503276, 'weight_8': 0.12565893227738917, 'weight_9': 0.14160634574034897}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:46,616] Trial 133 finished with value: 0.6838756712379019 and parameters: {'weight_0': 0.46344766402695936, 'weight_1': 0.2771198155171154, 'weight_2': 0.9643179571033808, 'weight_3': 0.05994477903121788, 'weight_4': 0.6326669467170812, 'weight_5': 0.1193236447338195, 'weight_6': 0.42673738641025005, 'weight_7': 0.6279723553544683, 'weight_8': 0.1125395969523684, 'weight_9': 0.1381414848031054}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:47,137] Trial 134 finished with value: 0.683842487137866 and parameters: {'weight_0': 0.580820600673906, 'weight_1': 0.3063153641698347, 'weight_2': 0.87124982149239, 'weight_3': 0.12273420562417786, 'weight_4': 0.4734590132041455, 'weight_5': 0.07366978423685358, 'weight_6': 0.4600211866092201, 'weight_7': 0.6118400620219332, 'weight_8': 0.17975136078525666, 'weight_9': 0.09937409893655125}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:47,659] Trial 135 finished with value: 0.6838553572148579 and parameters: {'weight_0': 0.5276279991855086, 'weight_1': 0.18099162719694195, 'weight_2': 0.9274701983540726, 'weight_3': 0.14320879730357622, 'weight_4': 0.5219067989141652, 'weight_5': 0.09279744776446816, 'weight_6': 0.3535651965494305, 'weight_7': 0.6991746757938293, 'weight_8': 0.10211150719951305, 'weight_9': 0.20678754559952472}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:48,185] Trial 136 finished with value: 0.6838720965339575 and parameters: {'weight_0': 0.48836352383969717, 'weight_1': 0.3607262118566579, 'weight_2': 0.8446624547707, 'weight_3': 0.08464051281159836, 'weight_4': 0.5549522761018276, 'weight_5': 0.06397021740905401, 'weight_6': 0.4116738698896914, 'weight_7': 0.6439935390424973, 'weight_8': 0.12927814143037317, 'weight_9': 0.1348692406559851}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:48,711] Trial 137 finished with value: 0.6838333561549137 and parameters: {'weight_0': 0.4455324172271981, 'weight_1': 0.23529787682971934, 'weight_2': 0.9507245314627052, 'weight_3': 0.20743848357983596, 'weight_4': 0.6037434270013048, 'weight_5': 0.16625396449672514, 'weight_6': 0.36630069884111605, 'weight_7': 0.8675263857910769, 'weight_8': 0.07495198366072965, 'weight_9': 0.17611765466083357}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:49,229] Trial 138 finished with value: 0.6836165332380433 and parameters: {'weight_0': 0.4696434429905835, 'weight_1': 0.12785360175899105, 'weight_2': 0.8882527850424471, 'weight_3': 0.1098510500004264, 'weight_4': 0.5716297709659545, 'weight_5': 0.14173107079411598, 'weight_6': 0.2796789108015074, 'weight_7': 0.5217537156991029, 'weight_8': 0.1552474810592174, 'weight_9': 0.08292073677423889}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:49,754] Trial 139 finished with value: 0.6839349729275069 and parameters: {'weight_0': 0.36665702268829425, 'weight_1': 0.41594976209324025, 'weight_2': 0.7627640860938929, 'weight_3': 0.2391277079786971, 'weight_4': 0.6565002108076292, 'weight_5': 0.1172485857807274, 'weight_6': 0.5879814593294879, 'weight_7': 0.576698706695537, 'weight_8': 0.09420259810590213, 'weight_9': 0.11461501492889502}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:50,276] Trial 140 finished with value: 0.6837495138995965 and parameters: {'weight_0': 0.3715003814179602, 'weight_1': 0.15099157694165158, 'weight_2': 0.7682381223537088, 'weight_3': 0.23921606830498227, 'weight_4': 0.6534817407058758, 'weight_5': 0.11513336620460846, 'weight_6': 0.4937877824409147, 'weight_7': 0.5561568178878604, 'weight_8': 0.09947481984877289, 'weight_9': 0.11886593765782166}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6837\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:50,800] Trial 141 finished with value: 0.683927300841454 and parameters: {'weight_0': 0.324765950271991, 'weight_1': 0.40320640906110006, 'weight_2': 0.7225143369049367, 'weight_3': 0.21660923736416554, 'weight_4': 0.6675072557259752, 'weight_5': 0.0891385653957257, 'weight_6': 0.5736160150066766, 'weight_7': 0.5599645878936732, 'weight_8': 0.0733352336041446, 'weight_9': 0.16373598080973703}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:51,325] Trial 142 finished with value: 0.6839473281964837 and parameters: {'weight_0': 0.41022141599960377, 'weight_1': 0.31540416615634137, 'weight_2': 0.7025640460440583, 'weight_3': 0.16096455425057293, 'weight_4': 0.6712221467057586, 'weight_5': 0.08730076915482929, 'weight_6': 0.5844283188123611, 'weight_7': 0.558580351500029, 'weight_8': 0.12390794709404335, 'weight_9': 0.19269861897305754}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:51,846] Trial 143 finished with value: 0.6839058101268213 and parameters: {'weight_0': 0.3665889514510582, 'weight_1': 0.4224978839029402, 'weight_2': 0.7133035876059801, 'weight_3': 0.21445192950733907, 'weight_4': 0.6665405776279134, 'weight_5': 0.08700393211644786, 'weight_6': 0.584639175245498, 'weight_7': 0.5681492729382145, 'weight_8': 0.09383106468188593, 'weight_9': 0.22367820752645964}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:52,362] Trial 144 finished with value: 0.6839204200982745 and parameters: {'weight_0': 0.41625005265504167, 'weight_1': 0.30700270854415285, 'weight_2': 0.7314113411731883, 'weight_3': 0.2555332993297671, 'weight_4': 0.6329526032141257, 'weight_5': 0.06471465641072116, 'weight_6': 0.5871123204830392, 'weight_7': 0.538585147841522, 'weight_8': 0.07469245729226301, 'weight_9': 0.19573350212440122}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:52,880] Trial 145 finished with value: 0.6838897002487145 and parameters: {'weight_0': 0.4120319434612932, 'weight_1': 0.36008042240552435, 'weight_2': 0.7314152558970757, 'weight_3': 0.26640664577819895, 'weight_4': 0.6188486292170577, 'weight_5': 0.07292184515944124, 'weight_6': 0.5883254697843888, 'weight_7': 0.49563531399696525, 'weight_8': 0.12112570567245393, 'weight_9': 0.19742869046423855}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:53,401] Trial 146 finished with value: 0.6839141659873531 and parameters: {'weight_0': 0.4373164099070222, 'weight_1': 0.3156626253167113, 'weight_2': 0.682294873950139, 'weight_3': 0.18364500777209383, 'weight_4': 0.6432678409263782, 'weight_5': 0.09396273562796721, 'weight_6': 0.554409103751784, 'weight_7': 0.5519727429639311, 'weight_8': 0.11955102422580996, 'weight_9': 0.24830690514854223}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:53,924] Trial 147 finished with value: 0.6838719310337942 and parameters: {'weight_0': 0.4000062503812611, 'weight_1': 0.2760702954467606, 'weight_2': 0.7481988396411733, 'weight_3': 0.24479424755658954, 'weight_4': 0.5942676338219818, 'weight_5': 0.06978596848986515, 'weight_6': 0.5731305725474853, 'weight_7': 0.5427993169842851, 'weight_8': 0.16746558157298896, 'weight_9': 0.1761157424323567}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:54,445] Trial 148 finished with value: 0.6838991091337674 and parameters: {'weight_0': 0.450743081010764, 'weight_1': 0.3896229056472054, 'weight_2': 0.7192837409296411, 'weight_3': 0.1651373532005449, 'weight_4': 0.6205868130734697, 'weight_5': 0.141288102152752, 'weight_6': 0.43022572474839443, 'weight_7': 0.5893441829876934, 'weight_8': 0.07252205716102847, 'weight_9': 0.16111438949158727}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:54,966] Trial 149 finished with value: 0.6833401198832979 and parameters: {'weight_0': 0.4163611706108242, 'weight_1': 0.3225477858367689, 'weight_2': 0.7967413751035639, 'weight_3': 0.29694764428510395, 'weight_4': 0.6713253732070175, 'weight_5': 0.10522740888702457, 'weight_6': 0.4673062763947905, 'weight_7': 0.49594634195111564, 'weight_8': 0.09798137154958657, 'weight_9': 0.47017588273612076}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6833\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:55,526] Trial 150 finished with value: 0.6839039714037763 and parameters: {'weight_0': 0.37787683762463603, 'weight_1': 0.4171515785283529, 'weight_2': 0.8164903083477251, 'weight_3': 0.15275155173048993, 'weight_4': 0.6968973090916315, 'weight_5': 0.08981213619863213, 'weight_6': 0.5309719577495077, 'weight_7': 0.6041754170609648, 'weight_8': 0.13262506930293744, 'weight_9': 0.19112341893676182}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:56,051] Trial 151 finished with value: 0.6839027899237057 and parameters: {'weight_0': 0.3288445730638081, 'weight_1': 0.3003080968934159, 'weight_2': 0.7751467280166838, 'weight_3': 0.12985968546271548, 'weight_4': 0.63891163179464, 'weight_5': 0.05706203309673688, 'weight_6': 0.3932172079480242, 'weight_7': 0.6135468198142437, 'weight_8': 0.08052793382339055, 'weight_9': 0.16484830463641714}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:56,606] Trial 152 finished with value: 0.6837668594859814 and parameters: {'weight_0': 0.48684035384205887, 'weight_1': 0.3733014685399126, 'weight_2': 0.7017386214176211, 'weight_3': 0.22048230587059103, 'weight_4': 0.6641887347864142, 'weight_5': 0.05046498270613434, 'weight_6': 0.1118946664459543, 'weight_7': 0.5748736528120576, 'weight_8': 0.07382913880938127, 'weight_9': 0.22951253878291317}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:57,147] Trial 153 finished with value: 0.6838852505667004 and parameters: {'weight_0': 0.34672178849782403, 'weight_1': 0.26979706202653375, 'weight_2': 0.7508070085067274, 'weight_3': 0.25773462040165457, 'weight_4': 0.6099126073687604, 'weight_5': 0.0705431905510716, 'weight_6': 0.5891864709846695, 'weight_7': 0.5295107546855051, 'weight_8': 0.11271471950716097, 'weight_9': 0.11338138422654342}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:57,685] Trial 154 finished with value: 0.683585588711405 and parameters: {'weight_0': 0.3602587469209677, 'weight_1': 0.35043149793373984, 'weight_2': 0.8605042200905552, 'weight_3': 0.27929518709795637, 'weight_4': 0.7346301781765089, 'weight_5': 0.11137354523492816, 'weight_6': 0.3937390166662494, 'weight_7': 0.5385135020842071, 'weight_8': 0.09269257802582573, 'weight_9': 0.19872570228596353}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6836\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:58,220] Trial 155 finished with value: 0.6838196822019653 and parameters: {'weight_0': 0.43135246283699546, 'weight_1': 0.2929018767758371, 'weight_2': 0.8314437328535489, 'weight_3': 0.1805668076917487, 'weight_4': 0.678696230181391, 'weight_5': 0.08510755789291896, 'weight_6': 0.44242758952630723, 'weight_7': 0.4994627166011843, 'weight_8': 0.12550046102085352, 'weight_9': 0.14975474798131472}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:58,751] Trial 156 finished with value: 0.6837683433657373 and parameters: {'weight_0': 0.4745867177626323, 'weight_1': 0.3320439068113923, 'weight_2': 0.7316259523835716, 'weight_3': 0.0675266601149489, 'weight_4': 0.6315167695445242, 'weight_5': 0.06724982476123362, 'weight_6': 0.5436418624197517, 'weight_7': 0.8188494916343778, 'weight_8': 0.07267191784621463, 'weight_9': 0.13104671248446745}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:59,288] Trial 157 finished with value: 0.6833709854478 and parameters: {'weight_0': 0.9776351749934213, 'weight_1': 0.468855285159787, 'weight_2': 0.9200095699301095, 'weight_3': 0.11919688921725775, 'weight_4': 0.5855015064768484, 'weight_5': 0.12608728809988945, 'weight_6': 0.32798571055082065, 'weight_7': 0.4712498072452433, 'weight_8': 0.14953038555428355, 'weight_9': 0.7368965096293766}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6834\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:34:59,825] Trial 158 finished with value: 0.6839479825642568 and parameters: {'weight_0': 0.5120101961685559, 'weight_1': 0.2227543335341956, 'weight_2': 0.806543521916366, 'weight_3': 0.14953725975340065, 'weight_4': 0.6931553616979608, 'weight_5': 0.09570902886354452, 'weight_6': 0.6554573467944882, 'weight_7': 0.5754838555149829, 'weight_8': 0.10487449336902224, 'weight_9': 0.2090663438548647}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:00,360] Trial 159 finished with value: 0.6838920351449334 and parameters: {'weight_0': 0.5071493712426957, 'weight_1': 0.2434805991043051, 'weight_2': 0.8078176697656577, 'weight_3': 0.14352471418984197, 'weight_4': 0.7065008843804615, 'weight_5': 0.17865973436048777, 'weight_6': 0.6567935266690932, 'weight_7': 0.5737052197413516, 'weight_8': 0.10885563267823399, 'weight_9': 0.22239945547197265}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:00,982] Trial 160 finished with value: 0.6838099700333302 and parameters: {'weight_0': 0.45401191891483805, 'weight_1': 0.21648201577431314, 'weight_2': 0.8221026901382404, 'weight_3': 0.16875285219222252, 'weight_4': 0.6928181014469798, 'weight_5': 0.10049234834841592, 'weight_6': 0.5665891419952614, 'weight_7': 0.6397490352819479, 'weight_8': 0.19104415509700667, 'weight_9': 0.2578302484108736}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6838\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:01,838] Trial 161 finished with value: 0.6830122987379104 and parameters: {'weight_0': 0.40831259551537463, 'weight_1': 0.2578794916278201, 'weight_2': 0.7624024720936459, 'weight_3': 0.09525541165241158, 'weight_4': 0.6608969152440569, 'weight_5': 0.050572372990803985, 'weight_6': 0.41145237553834746, 'weight_7': 0.5884258545367442, 'weight_8': 0.09097402561864915, 'weight_9': 0.8492661946366973}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6830\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:02,795] Trial 162 finished with value: 0.6838607256766006 and parameters: {'weight_0': 0.5095031178601982, 'weight_1': 0.2848609642787161, 'weight_2': 0.8725652920507294, 'weight_3': 0.051654056906881754, 'weight_4': 0.6376383734268507, 'weight_5': 0.08434482132757706, 'weight_6': 0.6336155988536288, 'weight_7': 0.8436162891760873, 'weight_8': 0.13285422319996384, 'weight_9': 0.18069563679731826}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:03,456] Trial 163 finished with value: 0.6839173694813604 and parameters: {'weight_0': 0.5462465502960567, 'weight_1': 0.30793067021664083, 'weight_2': 0.7851289735466922, 'weight_3': 0.19499524949145988, 'weight_4': 0.6524352262486162, 'weight_5': 0.11142921597885178, 'weight_6': 0.5063172985561379, 'weight_7': 0.565377203767701, 'weight_8': 0.1093411693091289, 'weight_9': 0.2062844565306206}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:03,972] Trial 164 finished with value: 0.6838524662320639 and parameters: {'weight_0': 0.4431886534946184, 'weight_1': 0.3353922730214776, 'weight_2': 0.8474893903881708, 'weight_3': 0.13510739804539523, 'weight_4': 0.6788979449796805, 'weight_5': 0.06570294077293796, 'weight_6': 0.4585479134963825, 'weight_7': 0.8088404407172329, 'weight_8': 0.05012301290165428, 'weight_9': 0.4239984889681886}. Best is trial 98 with value: 0.6839484134953353.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:04,489] Trial 165 finished with value: 0.6839517741807243 and parameters: {'weight_0': 0.47519886629205105, 'weight_1': 0.26476344085848325, 'weight_2': 0.6759842747986748, 'weight_3': 0.10842452845176165, 'weight_4': 0.6129833918060168, 'weight_5': 0.05106575798532842, 'weight_6': 0.4244699527311736, 'weight_7': 0.6704132686192331, 'weight_8': 0.07303943371879913, 'weight_9': 0.15964944442165793}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:05,013] Trial 166 finished with value: 0.6839264614250624 and parameters: {'weight_0': 0.4740544624357519, 'weight_1': 0.2641811195569726, 'weight_2': 0.6979930079124465, 'weight_3': 0.15191347305943087, 'weight_4': 0.6051824162800139, 'weight_5': 0.13628492856711946, 'weight_6': 0.4811127338413639, 'weight_7': 0.6741794679632122, 'weight_8': 0.06980067634411204, 'weight_9': 0.16689533374911233}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:05,563] Trial 167 finished with value: 0.6839443985099941 and parameters: {'weight_0': 0.47253388302190436, 'weight_1': 0.2308269704109381, 'weight_2': 0.6685274407693403, 'weight_3': 0.1590997042662773, 'weight_4': 0.5606679523167316, 'weight_5': 0.13813896934134673, 'weight_6': 0.4261078517069779, 'weight_7': 0.6630842188633185, 'weight_8': 0.16300778113926928, 'weight_9': 0.16216867225048615}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:06,099] Trial 168 finished with value: 0.6839410721006817 and parameters: {'weight_0': 0.5691790873456108, 'weight_1': 0.21857700425241194, 'weight_2': 0.6289547823143488, 'weight_3': 0.16081238363051875, 'weight_4': 0.5858600086569534, 'weight_5': 0.15111139377448887, 'weight_6': 0.4842043718662101, 'weight_7': 0.6728402966698374, 'weight_8': 0.16846165431824872, 'weight_9': 0.15868929379513153}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:06,613] Trial 169 finished with value: 0.6839375693720072 and parameters: {'weight_0': 0.5528708599599292, 'weight_1': 0.23188619881255002, 'weight_2': 0.632443207997214, 'weight_3': 0.17326852198118486, 'weight_4': 0.5433281378944368, 'weight_5': 0.17308335313443518, 'weight_6': 0.4271081433437183, 'weight_7': 0.6657139095348843, 'weight_8': 0.17474340101981367, 'weight_9': 0.11528972234330254}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:07,135] Trial 170 finished with value: 0.6839499891783017 and parameters: {'weight_0': 0.5504681407207075, 'weight_1': 0.22359415029163535, 'weight_2': 0.6297347276122753, 'weight_3': 0.17079390617643186, 'weight_4': 0.5568240541675388, 'weight_5': 0.16615653585530418, 'weight_6': 0.42774374738905635, 'weight_7': 0.6581946914850877, 'weight_8': 0.17102672146326023, 'weight_9': 0.1161454365225197}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:07,658] Trial 171 finished with value: 0.6839470484347825 and parameters: {'weight_0': 0.5719050924189609, 'weight_1': 0.22014772092063076, 'weight_2': 0.6238079843323442, 'weight_3': 0.1707526656382143, 'weight_4': 0.5555426239505726, 'weight_5': 0.17407059100041833, 'weight_6': 0.43430860752485995, 'weight_7': 0.6636709362266182, 'weight_8': 0.2132594956812138, 'weight_9': 0.10860579079759258}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:08,175] Trial 172 finished with value: 0.6839394281337958 and parameters: {'weight_0': 0.5717892232480298, 'weight_1': 0.23433781277595384, 'weight_2': 0.6137607736022791, 'weight_3': 0.17419938120537212, 'weight_4': 0.533084621617606, 'weight_5': 0.15752516256566576, 'weight_6': 0.4559014293770243, 'weight_7': 0.665151532671906, 'weight_8': 0.23976563840867215, 'weight_9': 0.08149686446992872}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:08,691] Trial 173 finished with value: 0.6839289162592146 and parameters: {'weight_0': 0.5761271481403841, 'weight_1': 0.22527047921432652, 'weight_2': 0.6266464322279768, 'weight_3': 0.18726477502113037, 'weight_4': 0.5272547922840843, 'weight_5': 0.1806458541265134, 'weight_6': 0.4415320051708808, 'weight_7': 0.666114094585518, 'weight_8': 0.21516986119976927, 'weight_9': 0.09138996898255503}. Best is trial 165 with value: 0.6839517741807243.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:09,212] Trial 174 finished with value: 0.6839652968203187 and parameters: {'weight_0': 0.5647423600501575, 'weight_1': 0.18574302200203255, 'weight_2': 0.6079132782954071, 'weight_3': 0.16273475348921654, 'weight_4': 0.548182810633567, 'weight_5': 0.15581515913209887, 'weight_6': 0.4258384216041776, 'weight_7': 0.6597379371900287, 'weight_8': 0.1748092642292441, 'weight_9': 0.11033130411131525}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:09,731] Trial 175 finished with value: 0.6839282143140419 and parameters: {'weight_0': 0.5492033086521583, 'weight_1': 0.1909564119785883, 'weight_2': 0.630506704246047, 'weight_3': 0.16982423279574352, 'weight_4': 0.5435269508998894, 'weight_5': 0.21208498817751792, 'weight_6': 0.45451523165461655, 'weight_7': 0.6949831361231923, 'weight_8': 0.2406877938752318, 'weight_9': 0.11926209368573719}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:10,248] Trial 176 finished with value: 0.6834532684091704 and parameters: {'weight_0': 0.05619883085604788, 'weight_1': 0.17944130500873157, 'weight_2': 0.5970654985202146, 'weight_3': 0.15807164747175279, 'weight_4': 0.5470780066518693, 'weight_5': 0.15592426648894686, 'weight_6': 0.42261445135655695, 'weight_7': 0.6504255321763098, 'weight_8': 0.18941533203072974, 'weight_9': 0.08774330379764912}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6835\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:10,766] Trial 177 finished with value: 0.683951383778771 and parameters: {'weight_0': 0.5695083132994744, 'weight_1': 0.21241095207629326, 'weight_2': 0.5817566831602681, 'weight_3': 0.19917097142567755, 'weight_4': 0.5673095336913777, 'weight_5': 0.18127539117253672, 'weight_6': 0.47569775539736314, 'weight_7': 0.6213185189848985, 'weight_8': 0.17108584351883332, 'weight_9': 0.10960887581403922}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:11,290] Trial 178 finished with value: 0.6839496334021723 and parameters: {'weight_0': 0.5628942473885932, 'weight_1': 0.21731285776339498, 'weight_2': 0.5774059251182848, 'weight_3': 0.20299885848139798, 'weight_4': 0.5632323384501494, 'weight_5': 0.22492982843449782, 'weight_6': 0.48782908396802604, 'weight_7': 0.620179389401453, 'weight_8': 0.1706948779787324, 'weight_9': 0.07756078464404784}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:11,810] Trial 179 finished with value: 0.6839139556958901 and parameters: {'weight_0': 0.5752165561610649, 'weight_1': 0.21422834001067867, 'weight_2': 0.5756818382132592, 'weight_3': 0.2041620973429154, 'weight_4': 0.5275773376477166, 'weight_5': 0.22567146246982772, 'weight_6': 0.4898966935042611, 'weight_7': 0.6241385226671193, 'weight_8': 0.17725326631440907, 'weight_9': 0.07524400921360448}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:12,332] Trial 180 finished with value: 0.68393136373783 and parameters: {'weight_0': 0.5619673301695034, 'weight_1': 0.16628161855859103, 'weight_2': 0.6646270330994284, 'weight_3': 0.22833079242673338, 'weight_4': 0.568479219460427, 'weight_5': 0.18827637256442026, 'weight_6': 0.5239274207322627, 'weight_7': 0.6511736245356654, 'weight_8': 0.27874614863370395, 'weight_9': 0.10305443713828842}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:12,854] Trial 181 finished with value: 0.6839486575892633 and parameters: {'weight_0': 0.5571913025649821, 'weight_1': 0.2072990480413813, 'weight_2': 0.6078408325412415, 'weight_3': 0.18974903415118866, 'weight_4': 0.5579358283858104, 'weight_5': 0.16735575412616033, 'weight_6': 0.4704480658920587, 'weight_7': 0.6935899528501683, 'weight_8': 0.20270276524399833, 'weight_9': 0.08023419037992821}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:13,380] Trial 182 finished with value: 0.6839539952689484 and parameters: {'weight_0': 0.5921582712969583, 'weight_1': 0.2197691922267845, 'weight_2': 0.6097286412486167, 'weight_3': 0.21032722312192031, 'weight_4': 0.5595551177248401, 'weight_5': 0.16026233460066516, 'weight_6': 0.4654401456618272, 'weight_7': 0.6923247083098898, 'weight_8': 0.20439001685973324, 'weight_9': 0.07938029007202123}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:13,905] Trial 183 finished with value: 0.6839338050439243 and parameters: {'weight_0': 0.5941013899992743, 'weight_1': 0.20932620303522578, 'weight_2': 0.6067607168973935, 'weight_3': 0.18454085165181747, 'weight_4': 0.5596689880121763, 'weight_5': 0.17241571728077365, 'weight_6': 0.504993094501886, 'weight_7': 0.6850440555917041, 'weight_8': 0.21574839606399182, 'weight_9': 0.0754410433587783}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:14,431] Trial 184 finished with value: 0.6839542246944692 and parameters: {'weight_0': 0.5607557868336497, 'weight_1': 0.1905198248136184, 'weight_2': 0.5785878398017805, 'weight_3': 0.20306665663998186, 'weight_4': 0.5369047491524458, 'weight_5': 0.1566705063991871, 'weight_6': 0.4660464202638019, 'weight_7': 0.6650318623671243, 'weight_8': 0.23526730775647142, 'weight_9': 0.08790235601377468}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:14,957] Trial 185 finished with value: 0.6839478927645929 and parameters: {'weight_0': 0.5993740900319718, 'weight_1': 0.1908642678927191, 'weight_2': 0.5772789456249788, 'weight_3': 0.2124901347230277, 'weight_4': 0.5170212943112831, 'weight_5': 0.16111751909053953, 'weight_6': 0.4586968497828537, 'weight_7': 0.6619453266941788, 'weight_8': 0.198190850394559, 'weight_9': 0.07516339192890528}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:15,518] Trial 186 finished with value: 0.6839448683037254 and parameters: {'weight_0': 0.615963144447822, 'weight_1': 0.15036541063973435, 'weight_2': 0.5702315815595079, 'weight_3': 0.20827722976196847, 'weight_4': 0.5235930007428177, 'weight_5': 0.20418785910822734, 'weight_6': 0.4774638283647872, 'weight_7': 0.6979205677620574, 'weight_8': 0.23820652475169937, 'weight_9': 0.08039253272872565}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:16,040] Trial 187 finished with value: 0.6839469812868493 and parameters: {'weight_0': 0.6395036954941204, 'weight_1': 0.144442249204332, 'weight_2': 0.5718377066888999, 'weight_3': 0.2076804800675093, 'weight_4': 0.5219626070571521, 'weight_5': 0.15791697027807625, 'weight_6': 0.46946893847107335, 'weight_7': 0.7060274355324829, 'weight_8': 0.23018568366277833, 'weight_9': 0.08889448179929886}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:16,568] Trial 188 finished with value: 0.683935525505766 and parameters: {'weight_0': 0.6384132538687046, 'weight_1': 0.12551548988721112, 'weight_2': 0.5708167691001405, 'weight_3': 0.20573696501787067, 'weight_4': 0.47234621517536657, 'weight_5': 0.1984812436844716, 'weight_6': 0.47086141314316177, 'weight_7': 0.7004732683731681, 'weight_8': 0.2470756292966778, 'weight_9': 0.07526860998706575}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:17,095] Trial 189 finished with value: 0.6839435525479669 and parameters: {'weight_0': 0.6056229846886587, 'weight_1': 0.1535699225921245, 'weight_2': 0.5496432948975216, 'weight_3': 0.21534299879233218, 'weight_4': 0.5123952818973858, 'weight_5': 0.20731013002189436, 'weight_6': 0.480045711753664, 'weight_7': 0.6810427730435842, 'weight_8': 0.2736303926440043, 'weight_9': 0.08254663158884253}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:17,615] Trial 190 finished with value: 0.6839505379050625 and parameters: {'weight_0': 0.6053774108937917, 'weight_1': 0.14472274592830156, 'weight_2': 0.5535670768547547, 'weight_3': 0.22218996612638664, 'weight_4': 0.5655496322001743, 'weight_5': 0.2203381238339101, 'weight_6': 0.4815184358429159, 'weight_7': 0.6889270501445655, 'weight_8': 0.263161928772127, 'weight_9': 0.09386445877446438}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:18,141] Trial 191 finished with value: 0.6839422128595771 and parameters: {'weight_0': 0.6084828034766281, 'weight_1': 0.14522336613881148, 'weight_2': 0.550721776309725, 'weight_3': 0.21131837879487575, 'weight_4': 0.5122123991408822, 'weight_5': 0.19960278791119018, 'weight_6': 0.4807061128376915, 'weight_7': 0.6819356590528928, 'weight_8': 0.2670560821768666, 'weight_9': 0.09465357734402424}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:18,665] Trial 192 finished with value: 0.6839458956405042 and parameters: {'weight_0': 0.6146738173450166, 'weight_1': 0.13858600885608394, 'weight_2': 0.5478408419768237, 'weight_3': 0.22182255915465804, 'weight_4': 0.5102775579155766, 'weight_5': 0.22128694186181894, 'weight_6': 0.47538685191262886, 'weight_7': 0.6983505907430321, 'weight_8': 0.2738529319551065, 'weight_9': 0.09356774808504817}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:19,189] Trial 193 finished with value: 0.6839406466435874 and parameters: {'weight_0': 0.6243283940327938, 'weight_1': 0.15070022121938004, 'weight_2': 0.5916681047775203, 'weight_3': 0.2281622499831124, 'weight_4': 0.5167540191299642, 'weight_5': 0.22107514090322133, 'weight_6': 0.5081743331484303, 'weight_7': 0.7101930010473317, 'weight_8': 0.27173860382958454, 'weight_9': 0.06984876232603301}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:19,714] Trial 194 finished with value: 0.6839617555197092 and parameters: {'weight_0': 0.5991945600026889, 'weight_1': 0.18317724846143418, 'weight_2': 0.5603475510588939, 'weight_3': 0.19939120590872034, 'weight_4': 0.5604857933356954, 'weight_5': 0.21512101713535767, 'weight_6': 0.4660993287094303, 'weight_7': 0.6215879051168173, 'weight_8': 0.2201531386412889, 'weight_9': 0.09283864123510784}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:20,239] Trial 195 finished with value: 0.683942425918838 and parameters: {'weight_0': 0.5874357953883703, 'weight_1': 0.188910706249159, 'weight_2': 0.5763629224290869, 'weight_3': 0.19713943181343455, 'weight_4': 0.5700344422581753, 'weight_5': 0.2368732974068635, 'weight_6': 0.46364821878547996, 'weight_7': 0.6360247365426972, 'weight_8': 0.22883586455876576, 'weight_9': 0.09722960351736144}. Best is trial 174 with value: 0.6839652968203187.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:20,761] Trial 196 finished with value: 0.6839674150457852 and parameters: {'weight_0': 0.6347479123801768, 'weight_1': 0.12283394287190824, 'weight_2': 0.5371696628136282, 'weight_3': 0.2403662449657739, 'weight_4': 0.5624650307037482, 'weight_5': 0.186199020167713, 'weight_6': 0.49874502610291505, 'weight_7': 0.6182294883675459, 'weight_8': 0.305035305042876, 'weight_9': 0.06684118332154804}. Best is trial 196 with value: 0.6839674150457852.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:21,286] Trial 197 finished with value: 0.6839169848382398 and parameters: {'weight_0': 0.6437257609605301, 'weight_1': 0.1719796401766709, 'weight_2': 0.5254442224883855, 'weight_3': 0.24594573546455378, 'weight_4': 0.4850127566032814, 'weight_5': 0.223426611424198, 'weight_6': 0.5275594102313975, 'weight_7': 0.6091263831492911, 'weight_8': 0.30310052484382444, 'weight_9': 0.06681946666028073}. Best is trial 196 with value: 0.6839674150457852.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:21,808] Trial 198 finished with value: 0.6839206878728821 and parameters: {'weight_0': 0.6145263181129613, 'weight_1': 0.07569400737966374, 'weight_2': 0.5642358823177026, 'weight_3': 0.23524702278198117, 'weight_4': 0.5555539146801507, 'weight_5': 0.26876893945763025, 'weight_6': 0.49798138955572896, 'weight_7': 0.6187340444880657, 'weight_8': 0.20519430415531648, 'weight_9': 0.09797163417975797}. Best is trial 196 with value: 0.6839674150457852.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6839\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-03-02 08:35:22,333] Trial 199 finished with value: 0.6839759247976 and parameters: {'weight_0': 0.5924993998310252, 'weight_1': 0.12210387099824138, 'weight_2': 0.5928159982364533, 'weight_3': 0.20120197420935387, 'weight_4': 0.5742317868774378, 'weight_5': 0.18681277283750494, 'weight_6': 0.46857843170983854, 'weight_7': 0.6991806712805966, 'weight_8': 0.33637817516336266, 'weight_9': 0.06716751263868462}. Best is trial 199 with value: 0.6839759247976.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overall Stratified C-Index Score for Ensemble Model: 0.6840\n",
      "Best Weights: {'weight_0': 0.5924993998310252, 'weight_1': 0.12210387099824138, 'weight_2': 0.5928159982364533, 'weight_3': 0.20120197420935387, 'weight_4': 0.5742317868774378, 'weight_5': 0.18681277283750494, 'weight_6': 0.46857843170983854, 'weight_7': 0.6991806712805966, 'weight_8': 0.33637817516336266, 'weight_9': 0.06716751263868462}\n",
      "Best AUC: 0.6839759247976\n"
     ]
    }
   ],
   "source": [
    "import optuna\n",
    "# \n",
    "def objective(trial):\n",
    "    #  (0.01.0 )\n",
    "    weights = [trial.suggest_float(f'weight_{i}', 0.05, 1.0) for i in range(len(ranked_oof_preds))]\n",
    "\n",
    "    # 1\n",
    "    weights = np.array(weights)\n",
    "    weights /= np.sum(weights)\n",
    "\n",
    "    #  ()\n",
    "    ensemble_oof_preds = np.dot(weights, ranked_oof_preds)\n",
    "\n",
    "    curent_score = md.targets.validate_model(ensemble_oof_preds, 'Ensemble Model')\n",
    "\n",
    "    return curent_score  # \n",
    "\n",
    "# Optuna\n",
    "study = optuna.create_study(direction='maximize')  # AUC\n",
    "study.optimize(objective, n_trials=200)\n",
    "\n",
    "# \n",
    "print(\"Best Weights:\", study.best_params)\n",
    "print(\"Best AUC:\", study.best_value)\n",
    "\n",
    "CFG.weights = [1 for _ in range(len(ranked_oof_preds))]\n",
    "np.array(CFG.weights)\n",
    "\n",
    "for i in range(len(CFG.weights)):\n",
    "    CFG.weights[i] = study.best_params[f'weight_{i}']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "f854fdf5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:22.427528Z",
     "iopub.status.busy": "2025-03-02T08:35:22.427061Z",
     "iopub.status.idle": "2025-03-02T08:35:22.433076Z",
     "shell.execute_reply": "2025-03-02T08:35:22.431915Z"
    },
    "papermill": {
     "duration": 0.04879,
     "end_time": "2025-03-02T08:35:22.435237",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.386447",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# ensemble_oof_preds = np.sum([w * p for w, p in zip(CFG.weights, ranked_oof_preds)], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "32d2b58c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:22.520583Z",
     "iopub.status.busy": "2025-03-02T08:35:22.520094Z",
     "iopub.status.idle": "2025-03-02T08:35:22.525648Z",
     "shell.execute_reply": "2025-03-02T08:35:22.524354Z"
    },
    "papermill": {
     "duration": 0.051653,
     "end_time": "2025-03-02T08:35:22.528046",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.476393",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# y_true = train_data[['ID', 'efs', 'efs_time', 'race_group']].copy()\n",
    "# y_pred = train_data[['ID']].copy()\n",
    "        \n",
    "# y_pred['prediction'] = ensemble_oof_preds\n",
    "            \n",
    "# c_index_score = score(y_true.copy(), y_pred.copy(), 'ID')\n",
    "# print(f'\\nOverall C-Index for Ensemble model: {c_index_score:.3f}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dda169a6",
   "metadata": {
    "papermill": {
     "duration": 0.04035,
     "end_time": "2025-03-02T08:35:22.609229",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.568879",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<div style=\"background-color: rgb(247, 230, 202); border: 4px solid rgb(162, 87, 79); border-radius: 40px; padding: 20px; font-family: 'Roboto'; color: rgb(162, 87, 79); text-align: left; font-size: 140%;\">\n",
    "    <b>Ensemble predictions for the test data.</b>\n",
    "</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "ab5913a0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:22.693131Z",
     "iopub.status.busy": "2025-03-02T08:35:22.691684Z",
     "iopub.status.idle": "2025-03-02T08:35:22.698916Z",
     "shell.execute_reply": "2025-03-02T08:35:22.697832Z"
    },
    "papermill": {
     "duration": 0.051505,
     "end_time": "2025-03-02T08:35:22.701386",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.649881",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "preds = [\n",
    "    ctb1_preds, \n",
    "    lgb1_preds, \n",
    "    ctb2_preds, \n",
    "    lgb2_preds, \n",
    "    ctb3_preds, \n",
    "    lgb3_preds,\n",
    "    cox1_preds,\n",
    "    cox2_preds,\n",
    "    # ctb5_preds, \n",
    "    # lgb5_preds,\n",
    "    ctb6_preds, \n",
    "    lgb6_preds,\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "c7cbfc2d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:22.784814Z",
     "iopub.status.busy": "2025-03-02T08:35:22.784314Z",
     "iopub.status.idle": "2025-03-02T08:35:22.793322Z",
     "shell.execute_reply": "2025-03-02T08:35:22.792190Z"
    },
    "papermill": {
     "duration": 0.053175,
     "end_time": "2025-03-02T08:35:22.795608",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.742433",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ranked_preds = np.array([rankdata(p) for p in preds])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "074de6ba",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:22.881109Z",
     "iopub.status.busy": "2025-03-02T08:35:22.880602Z",
     "iopub.status.idle": "2025-03-02T08:35:22.887698Z",
     "shell.execute_reply": "2025-03-02T08:35:22.886280Z"
    },
    "papermill": {
     "duration": 0.0544,
     "end_time": "2025-03-02T08:35:22.890560",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.836160",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ensemble_preds = np.sum([w * p for w, p in zip(CFG.weights, ranked_preds)], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "fea5d09e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:22.975658Z",
     "iopub.status.busy": "2025-03-02T08:35:22.975209Z",
     "iopub.status.idle": "2025-03-02T08:35:23.000578Z",
     "shell.execute_reply": "2025-03-02T08:35:22.998854Z"
    },
    "papermill": {
     "duration": 0.071924,
     "end_time": "2025-03-02T08:35:23.004272",
     "exception": false,
     "start_time": "2025-03-02T08:35:22.932348",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "subm_data = pd.read_csv(CFG.subm_path)\n",
    "subm_data['prediction'] = ensemble_preds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "eca5af1f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-02T08:35:23.090901Z",
     "iopub.status.busy": "2025-03-02T08:35:23.090347Z",
     "iopub.status.idle": "2025-03-02T08:35:23.114303Z",
     "shell.execute_reply": "2025-03-02T08:35:23.113020Z"
    },
    "papermill": {
     "duration": 0.070175,
     "end_time": "2025-03-02T08:35:23.117513",
     "exception": false,
     "start_time": "2025-03-02T08:35:23.047338",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>prediction</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>28800</td>\n",
       "      <td>7.681941</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>28801</td>\n",
       "      <td>11.522912</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28802</td>\n",
       "      <td>3.840971</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      ID  prediction\n",
       "0  28800    7.681941\n",
       "1  28801   11.522912\n",
       "2  28802    3.840971"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "subm_data.to_csv('submission.csv', index=False)\n",
    "display(subm_data.head())"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 10381525,
     "sourceId": 70942,
     "sourceType": "competition"
    },
    {
     "sourceId": 211253469,
     "sourceType": "kernelVersion"
    },
    {
     "sourceId": 211322530,
     "sourceType": "kernelVersion"
    }
   ],
   "dockerImageVersionId": 30804,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 22746.604152,
   "end_time": "2025-03-02T08:35:26.387298",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-03-02T02:16:19.783146",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
